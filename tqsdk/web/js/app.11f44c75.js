(function(t){function e(e){for(var r,a,o=e[0],c=e[1],h=e[2],l=0,d=[];l<o.length;l++)a=o[l],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&d.push(n[a][0]),n[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(d.length)d.shift()();return s.push.apply(s,h||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],r=!0,o=1;o<i.length;o++){var c=i[o];0!==n[c]&&(r=!1)}r&&(s.splice(e--,1),t=a(a.s=i[0]))}return t}var r={},n={app:0},s=[];function a(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=r,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(i,r,function(e){return t[e]}.bind(null,r));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var h=0;h<o.length;h++)e(o[h]);var u=c;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"07f6":function(t,e,i){},"19da":function(t,e,i){"use strict";var r=i("dcf3"),n=i.n(r);n.a},"1a2d3":function(t,e,i){"use strict";var r=i("f6c5"),n=i.n(r);n.a},2975:function(t,e,i){"use strict";var r=i("8fde"),n=i.n(r);n.a},"326a":function(t,e,i){"use strict";var r=i("6491"),n=i.n(r);n.a},4678:function(t,e,i){var r={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(t){var e=s(t);return i(e)}function s(t){if(!i.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}n.keys=function(){return Object.keys(r)},n.resolve=s,t.exports=n,n.id="4678"},5096:function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("4de4"),i("a9e3"),i("f00c"),i("8ba4"),i("b680"),i("e260"),i("e6cf"),i("cca6"),i("a79d");var r=i("2b0e"),n=i("c1df"),s=i.n(n),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("tianqin")],1)},o=[],c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tq-home"},[i("div",{staticClass:"layout-area header-container"},[i("tq-header-view",{attrs:{height:t.headerHeight,width:t.$root.windowWidth}})],1),i("div",{staticClass:"layout-area top-container",style:{height:t.topHeight+"px"}},[i("tq-top-view",{attrs:{height:t.topHeight,width:t.$root.windowWidth}})],1),i("div",{staticClass:"layout-area bottom-container",style:{height:t.bottomHeight+"px",top:t.bottomYOffset+4+"px",backgroundColor:"#FEFEFE",boxShadow:t.showBottomShadow?"0px -3px 4px -1px #AFAFAF":""}},[i("div",{staticClass:"bottom-area-handle",on:{mousedown:t.handleMousedown}}),i("tq-bottom-view",{attrs:{height:t.bottomHeight,width:t.$root.windowWidth}})],1)])},h=[],u=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tq-header-view"},[r("tq-layout-area",{attrs:{height:t.height,otherStyle:{backgroundColor:"#FEFEFE"}}},[r("a",{attrs:{href:"https://www.shinnytech.com/tianqin/",target:"_blank"}},[r("img",{staticClass:"logo",style:{padding:"4px",width:t.height+"px",height:t.height+"px"},attrs:{alt:"Tianqin",src:i("cf05")}})])]),r("tq-layout-area",{attrs:{height:t.height,left:t.height,width:240,otherStyle:{paddingTop:"8px"}}},[t._v(" "+t._s(t.$store.state.file_name)+" ")]),r("tq-layout-area",{attrs:{height:t.height,left:t.height+240,width:360,otherStyle:{paddingTop:"8px"}}},["run"===t.$store.state.mode?r("div",[t._v("账户："+t._s(t.$store.state.broker_id)+","+t._s(t.$store.state.account_id)+" ")]):t._e(),"backtest"===t.$store.state.mode?r("div",[t._v("回测区间： "+t._s(t.formatDt(t.$store.state.start_dt))+" -- "+t._s(t.formatDt(t.$store.state.end_dt))+" ")]):t._e()]),r("tq-layout-area",{attrs:{height:t.height,width:160,horizontalAlign:"right",otherStyle:{paddingTop:"8px"}}},[r("Badge",{attrs:{color:t.$store.state.py_file_status?"green":"red",text:"py文件"}}),r("Badge",{attrs:{color:t.$store.state.md_url_status?"green":"red",text:"行情"}}),r("Badge",{attrs:{color:t.$store.state.td_url_status?"green":"red",text:"交易"}})],1)],1)},l=[],d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tq-layout-absolute",style:t.computedStyle},[t._t("default")],2)},_=[],f={name:"tq-layout-absolute",data:function(){return{}},props:{horizontalAlign:{type:String,default:"left"},verticalAlign:{type:String,default:"top"},top:{type:Number,default:0},left:{type:Number,default:0},bottom:{type:Number,default:0},right:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0},otherStyle:{type:Object,default:function(){}}},computed:{computedStyle:function(){var t={width:this.width+"px",height:this.height+"px"};return t[this.horizontalAlign]=this[this.horizontalAlign]+"px",t[this.verticalAlign]=this[this.verticalAlign]+"px",Object.assign(t,this.otherStyle)}}},m=f,p=(i("b9e2"),i("2877")),y=Object(p["a"])(m,d,_,!1,null,null,null),g=y.exports,v={name:"tq-header-view",components:{TqLayoutArea:g},props:{height:Number},methods:{formatDt:function(t){return s()(t/1e6).format("YYYY-MM-DD HH:mm:ss")}}},b=v,w=(i("8e24"),Object(p["a"])(b,u,l,!1,null,null,null)),k=w.exports,x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tq-top-view"},[i("tq-layout-area",{staticClass:"left-view",attrs:{height:t.height,width:t.chartWidth}},[i("tq-layout-area",{attrs:{height:26,width:300}},[i("button-group-durations",{attrs:{duration:t.duration},on:{onChangeDuration:t.onChangeDuration}})],1),i("tq-layout-area",{attrs:{top:26}},[i("tq-chart-components",{attrs:{instrumentId:t.instrumentId,duration:t.duration,height:t.height-26,width:t.chartWidth,theme:t.theme}})],1)],1),i("tq-layout-area",{staticClass:"right-view",attrs:{height:t.height,width:t.rightWidth,horizontalAlign:"right"}},["run"===t.$store.state.mode?i("tq-layout-area",{attrs:{height:t.rightClosed?t.height-35:160,width:t.rightWidth}},["run"===t.$store.state.mode?i("quote-info",{attrs:{symbol:t.instrumentId,height:t.rightClosed?t.height-35:160,width:t.rightWidth}}):t._e()],1):t._e(),i("tq-layout-area",{attrs:{top:"run"===t.$store.state.mode?160:0,height:t.rightClosed?0:18,width:t.rightWidth,otherStyle:{backgroundColor:"lightgrey",color:"#333333",fontSize:"12px",fontWeight:"700",overflow:"hidden"}}},[t._v(" 订阅合约列表 ")]),i("tq-layout-area",{attrs:{verticalAlign:"bottom",bottom:35,height:t.rightClosed?0:t.height-("run"===t.$store.state.mode?160:0)-18-35,width:t.rightWidth,otherStyle:{overflowY:"scroll"}}},[i("subscribed-list",{on:{onChange:t.onChangeSelectedSubscribed}})],1),i("tq-layout-area",{attrs:{verticalAlign:"bottom",height:35,width:t.rightWidth}},[i("about-us",{attrs:{width:t.rightWidth}})],1),"run"===t.$store.state.mode?i("div",{staticClass:"right-resize-tool",on:{click:t.toggleRightClosed}},[t.rightClosed?i("Icon",{attrs:{type:"ios-arrow-back"}}):i("Icon",{attrs:{type:"ios-arrow-forward"}})],1):t._e()],1)],1)},O=[],S=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tq-button-group-durations"},[i("RadioGroup",{attrs:{type:"button",size:"small"},model:{value:t.selectedPeriod,callback:function(e){t.selectedPeriod=e},expression:"selectedPeriod"}},t._l(t.periods,(function(t){return i("Radio",{key:t,attrs:{label:t}})})),1)],1)},M=[],D=(i("4160"),i("c975"),i("b64b"),i("07ac"),i("159b"),{"1m":6e10,"5m":3e11,"15m":9e11,"30m":18e11,"1h":36e11,"1d":864e11}),P={data:function(){return{periods:Object.keys(D),selectedPeriod:"",selectedDuration:null}},props:{duration:Number},watch:{duration:function(){if(this.duration!==this.selectedDuration){var t=Object.values(D).indexOf(this.duration);t>-1?(this.selectedPeriod=D[t],this.selectedDuration=this.duration):(this.selectedPeriod="",this.selectedDuration=null)}},selectedPeriod:function(){document.querySelectorAll(".tq-button-group-durations input[type=radio]").forEach((function(t){return t.blur()})),this.selectedDuration=D[this.selectedPeriod],this.selectedPeriod&&this.selectedDuration&&(console.log(this.selectedPeriod,this.selectedDuration),this.$emit("onChangeDuration",this.selectedDuration))}}},j=P,T=(i("326a"),Object(p["a"])(j,S,M,!1,null,null,null)),C=T.exports,E=(i("99af"),i("beea")),q="web_chart",I="web_chart_focus",A=null,W=null,Y={name:"tq-chart-components",data:function(){return{id:"TQ-CHART",action:"run"}},props:{instrumentId:{type:String,default:"TQ.m@SHFE.au"},duration:{type:Number,default:6e10},width:Number,height:Number,theme:{type:String,default:"light"}},render:function(t){var e={class:{"theme-light":"light"===this.theme,"theme-dark":"dark"===this.theme},attrs:{id:this.id}};return t("div",e)},watch:{instrumentId:function(t,e){W.removeMarkAll(),this.$nextTick(this.updateTqChart)},duration:function(t,e){W.removeMarkAll(),this.$nextTick(this.updateTqChart)},width:function(t,e){W&&W.resize({width:t,height:this.height})},height:function(t,e){W&&W.resize({width:this.width,height:t})}},created:function(){A=this.$tqsdk.get({name:"klines",symbol:this.instrumentId,duration:this.duration}),W=new E["a"]({id:this.id,instrumentId:this.instrumentId,duration:this.duration,height:this.height,width:this.width,mainSeries:A});var t="free",e=3,i=this;W.on("showRangeChanged",(function(r){if(-1!==r.rightId&&-1!==r.leftId)if("fixed"===t){var n=864e11;i.$tqsdk.set_chart({chart_id:q,symbol:i.instrumentId,duration:i.duration,trading_day_start:n*(1-e),trading_day_count:n*e})}else if("free"===t){var s=r.rightId-r.leftId;i.$tqsdk.set_chart({chart_id:q,symbol:i.instrumentId,duration:i.duration,left_kline_id:Math.max(r.leftId-s,0),view_width:3*s})}}))},mounted:function(){W.init();var t=this;this.$tqsdk.on("rtn_data",(function(){if(t.updatePositionLine(),t.updateTrades(),t.updateTqSdkChartData(),t.updatePositionRect(),"run"===t.action&&"backtest"===t.$tqsdk.get_by_path(["action","mode"])){var e=t.$store.state.account_id;if(e){var i=t.$tqsdk.get({name:"trades",user_id:e});for(var r in i){var n=i[r];W&&W.symbol&&W.duration&&(t.$tqsdk.set_chart({chart_id:I,symbol:W.symbol,duration:W.duration,view_width:W.bar.barNumbers,focus_datetime:n.trade_date_time,focus_position:Math.floor(W.bar.barNumbers/2)}),t.action="backtest");break}}}var s=t.$tqsdk.get_by_path(["charts",I]);if(s&&!s.more_data&&s.left_id&&s.right_id){var a=[s.left_id,s.right_id],o=a[0],c=a[1];W.setRange(o,c),W.addHighlightBar("movetoid",o+Math.round(W.bar.barNumbers/2-2)),t.$tqsdk.set_chart({chart_id:I,symbol:"",duration:W.duration,view_width:0})}else{var h=t.$tqsdk.get_by_path(["charts",q,"more_data"]);!h&&t.$tqsdk.is_changed(A)&&W.draw()}})),this.$eventHub.$on("moveChartToDt",(function(t){this.$tqsdk.set_chart({chart_id:I,symbol:W.symbol,duration:W.duration,view_width:W.bar.barNumbers,focus_datetime:t,focus_position:Math.floor(W.bar.barNumbers/2)})}))},methods:{updateTqChart:function(){if(this.$tqsdk.set_chart({chart_id:q,symbol:this.instrumentId,duration:this.duration,view_width:1e3}),A=this.$tqsdk.get({name:"klines",symbol:this.instrumentId,duration:this.duration}),W){var t=this.$tqsdk.get_quote(this.instrumentId);W.setMainSeries(this.instrumentId,this.duration,A),W.price_decs=t.price_decs,this.$nextTick((function(){this.updateTqSdkChartData(),this.updateTrades(!0),this.updatePositionRect(!0)}))}},updateTqSdkChartData:function(){var t=this.$tqsdk.get_by_path(["draw_chart_datas",W.symbol,W.duration]);if(t)for(var e in t)W.addSeries(e,t[e])},updatePositionLine:function(t){var e=this.$store.state.account_id;if(e){var i=this.$tqsdk.get({name:"position",user_id:e,symbol:W.symbol});i&&i.volume_long>0?W.addMark({id:"pos_long",type:"line",boardId:"main",yAlign:"right",xPos1:0,xPos2:W.innerWidth,y1:i.open_price_long,y2:i.open_price_long,stroke:"red",text:"多仓".concat(i.volume_long,"手@").concat(i.open_price_long)}):W.removeMark("pos_long"),i&&i.volume_short>0?W.addMark({id:"pos_short",type:"line",boardId:"main",yAlign:"right",xPos1:0,xPos2:W.innerWidth,y1:i.open_price_short,y2:i.open_price_short,stroke:"green",text:"空仓".concat(i.volume_short,"手@").concat(i.open_price_short)}):W.removeMark("pos_short")}},updateTrades:function(t){var e=this.$store.state.account_id;if(e){var i=this.$tqsdk.get({name:"trades",user_id:e});for(var r in i){var n=i[r];t?n.volume>0&&n.symbol===W.symbol&&W.addTradeArrow(r,n):n._epoch===this.$tqsdk.dm._epoch&&n.volume>0&&n.symbol===W.symbol&&W.addTradeArrow(r,n)}}},updatePositionRect:function(t){var e=this.$tqsdk.get_by_path(["snapshots"]);for(var i in e){var r=e[i];t?r.positions&&r.positions.hasOwnProperty(W.symbol)&&W.addPositionRecord(i,r.positions[W.symbol]):r._epoch===this.$tqsdk.dm._epoch&&r.positions&&r.positions.hasOwnProperty(W.symbol)&&W.addPositionRecord(i,r.positions[W.symbol])}}}},L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"subscribed-list"},[t._l(t.subscribedSymbols,(function(e){return[t._l(t.subscribed[e],(function(r){return[i("Button",{attrs:{size:"small",long:""},on:{click:function(i){return t.onClick(e,r)}}},[t._v(" "+t._s(e)+" "+t._s(t.ParseDuartionToString(r))+" ")])]}))]}))],2)},R=[];i("caad"),i("2532"),i("a434"),i("ac1f"),i("1276"),i("bf2d");function N(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"number"===typeof t?t.toFixed(e):t}function U(t){switch(t){case"BUY":return"买";case"SELL":return"卖";default:return t}}function G(t){switch(t){case"OPEN":return"开";case"CLOSE":return"平";case"CLOSETODAY":return"平今";default:return t}}function H(t){var e="";if(t&&t>=1e9){var i=s.a.duration(t/1e9,"seconds");i.years()>0&&(e+=i.years()+"Y"),i.months()>0&&(e+=i.months()+"M"),i.days()>0&&(e+=i.days()+"D"),i.hours()>0&&(e+=i.hours()+"h"),i.minutes()>0&&(e+=i.minutes()+"m"),i.seconds()>0&&(e+=i.seconds()+"s")}return e}var F=[],B={},z={data:function(){return{subscribedSymbols:F,subscribed:B}},props:{},watch:{subscribedSymbols:function(t,e){console.log(t,e)}},mounted:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$tqsdk.getByPath(["subscribed"]);if(console.log("subscribed",e),e&&e._epoch===t.$tqsdk.dm._epoch){for(var i in e){var r=e[i];if(console.log(i,r),Array.isArray(r.symbol))for(var n in r.symbol)console.log(r.symbol[n]),t.addSubscribed(r.symbol[n],r.dur_nano);else console.log(r.symbol),t.addSubscribed(r.symbol,r.dur_nano)}t.updateSubscribedSymbols()}}))},methods:{addSubscribed:function(t,e){B[t]||(B[t]=[]),e||(e=""),B[t].includes(e)||B[t].push(e)},updateSubscribedSymbols:function(){for(var t in B)-1===F.indexOf(t)&&F.push(t)},onClick:function(t,e){this.$emit("onChange",t,e)},ParseDuartionToString:H}},$=z,K=Object(p["a"])($,L,R,!1,null,null,null),V=K.exports,Q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"quote-info-container"},[i("Row",{attrs:{"class-name":"quote-items-title"}},[i("Col",{attrs:{span:t.largeSize?12:24}},[i("div",[t._v(t._s(t.quote.ins_name))])]),i("Col",{attrs:{span:t.largeSize?12:24}},[i("div",[t._v(t._s(t.quote.ins_id))])])],1),i("Row",[i("Col",{attrs:{span:t.largeSize?6:12}},[i("div",[t._v("卖一")])]),i("Col",{attrs:{span:t.largeSize?9:12}},[i("div",[t._v(t._s(t.formatter(t.quote.ask_price1)))])]),i("Col",{attrs:{span:t.largeSize?9:"0"}},[t._v(" "+t._s(t.quote.ask_volume1)+" ")])],1),i("div",{staticClass:"outer"},[i("div",{staticClass:"inner",style:{width:100*t.innerWidth+"%"}})]),i("Row",[i("Col",{attrs:{span:t.largeSize?6:12}},[t._v(" 买一 ")]),i("Col",{attrs:{span:t.largeSize?9:12}},[t._v(" "+t._s(t.formatter(t.quote.bid_price1)))]),i("Col",{attrs:{span:t.largeSize?9:"0"}},[t._v(" "+t._s(t.quote.bid_volume1)+" ")])],1),i("Row",{attrs:{"class-name":"quote-items "+(t.largeSize?"large-size":"")}},[i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 最新价 ")]),i("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.last_price))+" ")]),i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 昨结算 ")]),i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.pre_settlement))+" ")]),i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 涨跌 ")]),i("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.change))+" ")]),i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 今开 ")]),i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.quote.open)+" ")]),i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 涨跌幅 ")]),i("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t._f("toFixed")(t.quote.change_percent))+"% ")]),i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 最高 ")]),i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.highest))+" ")]),i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 总手 ")]),i("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.quote.volume)+" ")]),i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 最低 ")]),i("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.lowest))+" ")]),i("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 涨停 ")]),i("Col",{staticClass:"R",attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.upper_limit))+" ")]),i("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 收盘 ")]),i("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.close))+" ")]),i("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 跌停 ")]),i("Col",{staticClass:"G",attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.lower_limit))+" ")]),i("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 结算 ")]),i("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.settlement))+" ")]),i("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 持仓量 ")]),i("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.quote.open_interest))]),i("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 日增")]),i("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.quote.open_interest-t.quote.pre_open_interest))])],1)],1)},Z=[],J={ins_name:"-",ins_id:"-",price_decs:2,last_price:"-",ask_price1:"-",ask_volume1:"-",bid_price1:"-",bid_volume1:"-",pre_settlement:"-",change:"-",change_percent:"-",open:"-",close:"-",highest:"-",volume:"-",lowest:"-",upper_limit:"-",lower_limit:"-",settlement:"-",open_interest:"-",pre_open_interest:"-"},X={data:function(){return{quote:Object.assign({},J)}},props:{symbol:String,height:Number,width:Number},watch:{symbol:function(t,e){console.log("subscribe_quote",t,e),this.$tqsdk.subscribeQuote(this.symbol);var i=this.$tqsdk.getQuote(this.symbol);tt(this.quote,i)}},computed:{classOfColor:function(){return this.quote["change"]>0?"R":this.quote["change"]<0?"G":""},innerWidth:function(){return this.quote.bid_volume1/(this.quote.bid_volume1+this.quote.ask_volume1)},largeSize:function(){return this.width>100}},created:function(){var t=this;this.$tqsdk.subscribe_quote(this.symbol),this.$tqsdk.on("rtn_data",(function(){var e=t.$tqsdk.getQuote(t.symbol);console.log(e),tt(t.quote,e)}))},methods:{formatter:function(t){return N(t,this.quote.price_decs)}}};function tt(t,e){Object.keys(J).forEach((function(i,r,n){t[i]!==e[i]&&(t[i]=e[i])}))}var et=X,it=(i("19da"),Object(p["a"])(et,Q,Z,!1,null,null,null)),rt=it.exports,nt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"about-us"},[r("a",{attrs:{href:"https://doc.shinnytech.com/tqsdk/latest/",target:"_blank"}},[r("img",{staticClass:"logo",attrs:{alt:"Tianqin",src:i("cf05")}}),t._v(" 天勤量化"),t.width>100?r("span",[t._v("开发文档")]):t._e()]),r("a",{attrs:{href:"https://www.shinnytech.com/qa/",target:"_blank"}},[r("Icon",{attrs:{type:"ios-chatbubbles"}}),t._v(" 天勤"),t.width>100?r("span",[t._v("量化")]):t._e(),t._v("论坛 ")],1)])},st=[],at={props:{width:Number}},ot=at,ct=(i("2975"),Object(p["a"])(ot,nt,st,!1,null,null,null)),ht=ct.exports,ut=function(){return document.addEventListener?function(t,e,i){t&&e&&i&&t.addEventListener(e,i,!1)}:function(t,e,i){t&&e&&i&&t.attachEvent("on"+e,i)}}(),lt=function(){return document.removeEventListener?function(t,e,i){t&&e&&t.removeEventListener(e,i,!1)}:function(t,e,i){t&&e&&t.detachEvent("on"+e,i)}}(),dt={name:"tq-top-view",components:{TqLayoutArea:g,TqChartComponents:Y,ButtonGroupDurations:C,QuoteInfo:rt,SubscribedList:V,AboutUs:ht},props:{width:Number,height:Number},data:function(){var t=200,e=80;return{rightClosed:!1,rightOpenedWidth:t,rightClosedWidth:e,instrumentId:"",duration:6e10,theme:"light"}},computed:{chartWidth:function(){var t=this.$root.windowWidth-(this.rightClosed?this.rightClosedWidth:this.rightOpenedWidth);return Math.max(t,400)},rightWidth:function(){return(this.rightClosed?this.rightClosedWidth:this.rightOpenedWidth)-4}},methods:{toggleRightClosed:function(){this.rightClosed=!this.rightClosed},onChangeDuration:function(t){console.log("onChangeDuration",t),this.duration=t},onChangeSelectedSubscribed:function(t,e){console.log(t,e),this.instrumentId=t,this.duration=e||6e10}},created:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){t.subscribed=t.$tqsdk.get_by_path(["subscribed"]),t.subscribed&&t.subscribed[0]&&""===t.instrumentId&&(t.subscribedIndex=0,t.instrumentId=Array.isArray(t.subscribed[0].symbol)?t.subscribed[0].symbol[0]:t.subscribed[0].symbol,t.duration=t.subscribed[0].dur_nano||6e10)}))}},_t=dt,ft=(i("f451"),Object(p["a"])(_t,x,O,!1,null,null,null)),mt=ft.exports,pt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tq-bottom-view"},["backtest"===t.$store.state.mode?[i("tq-layout-area",{attrs:{width:t.width/2,height:t.height-27}},[i("Tabs",{attrs:{animated:!1}},[i("TabPane",{attrs:{label:"回测指标"}},[i("backtest-info",{attrs:{width:t.width,height:t.height-27}})],1),i("TabPane",{attrs:{label:"成交记录"}},[i("trades-table",{attrs:{width:t.width,height:t.height-27}})],1)],1)],1),i("tq-layout-area",{attrs:{horizontalAlign:"right",width:t.width/2,height:t.height-27}},[i("backtest-chart")],1)]:"run"===t.$store.state.mode?[i("tq-layout-area",{attrs:{height:26,width:t.width}},[i("account-info",{attrs:{height:26}})],1),i("tq-layout-area",{attrs:{height:t.height-26,top:26,width:t.width}},[i("Tabs",[i("TabPane",{attrs:{label:"持仓"}},[i("positions-table",{attrs:{width:t.width,height:t.height-53}})],1),i("TabPane",{attrs:{label:"成交记录"}},[i("trades-table",{attrs:{width:t.width,height:t.height-53}})],1),i("TabPane",{attrs:{label:"委托单记录"}},[i("orders-table",{attrs:{width:t.width,height:t.height-53}})],1)],1)],1)]:t._e()],2)},yt=[],gt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"reports trades-table",style:{height:t.height+"px"}},[i("table",[i("thead",[i("tr",t._l(t.columns,(function(e){return i("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])})),0)]),i("tbody")])])},vt=[],bt=(i("4e82"),{data:function(){return{tbodyRoot:null,columns:[{name:"成交合约",key:"instrument_id",width:"100",cb:function(t){return t.exchange_id+"."+t.instrument_id}},{name:"方向",key:"direction",width:"60",cb:function(t){return U(t.direction)}},{name:"开平",key:"offset",width:"60",cb:function(t){return G(t.offset)}},{name:"成交价格",width:"60",key:"price"},{name:"手数",width:"60",key:"volume"},{name:"成交时间",key:"trade_date_time",width:"140",cb:function(t){return s()(t.trade_date_time/1e6).format("YYYY-MM-DD HH:mm:ss")}},{name:"报单编号",key:"trade_id"}]}},props:{height:Number},mounted:function(){this.tbodyNode=document.querySelector(".trades-table table tbody");var t=this,e=function(){var e=t.$store.state.account_id;if(e){var i=[],r=t.$tqsdk.get({name:"trades",user_id:e});if(r){for(var n in r)r[n]._epoch===t.$tqsdk.dm._epoch&&i.push(r[n]);i.sort((function(t,e){return t.trade_date_time-e.trade_date_time}));for(var s=function(e){var r=t.append_trade(i[e]);r.onclick=function(n){var s=t.tbodyNode.querySelectorAll("tr");s.forEach((function(t){return t.className=""})),r.className="selected",t.$eventHub.$emit("moveChartToDt",i[e].trade_date_time)}},a=0;a<i.length;a++)s(a)}}};e(),this.$tqsdk.on("rtn_data",e)},methods:{append_trade:function(t){var e=document.createElement("tr");for(var i in this.columns){var r=this.columns[i],n=this.get_td_text(r.cb?r.cb(t):t[r.key],r.key);e.appendChild(n)}return this.tbodyNode.insertBefore(e,this.tbodyNode.firstChild),e},get_td_text:function(t){var e=document.createElement("td");return e.textContent=t,e}}}),wt=bt,kt=Object(p["a"])(wt,gt,vt,!1,null,null,null),xt=kt.exports,Ot=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"reports orders-table",style:{height:t.height+"px"}},[i("table",[i("thead",[i("tr",[t._l(t.columns,(function(e){return i("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])})),t._l(t.columnsAppend,(function(e){return i("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])}))],2)]),i("tbody")])])},St=[],Mt={data:function(){return{tbodyRoot:null,columns:[{name:"成交合约",width:"100",key:"instrument_id",cb:function(t){return t.exchange_id+"."+t.instrument_id}},{name:"方向",width:"60",key:"direction",cb:function(t){return U(t.direction)}},{name:"开平",width:"60",key:"offset",cb:function(t){return G(t.offset)}},{name:"报单价格",width:"60",key:"limit_price"},{name:"总手数",width:"60",key:"volume_orign"},{name:"报单时间",width:"140",key:"insert_date_time",cb:function(t){return s()(t.insert_date_time/1e6).format("YYYY-MM-DD HH:mm:ss")}}],columnsAppend:[{name:"未成交手数",key:"volume_left",width:"80",cb:function(t){return t.volume_left}},{name:"冻结保证金",width:"80",key:"frozen_margin"},{name:"状态",width:"60",key:"status",cb:function(t){return"FINISHED"===t.status?"已完成":"未完成"}},{name:"提示信息",key:"last_msg"}],ordersTr:{}}},props:{height:Number},mounted:function(){this.tbodyNode=document.querySelector(".orders-table table tbody");var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$store.state.account_id;if(e){var i=t.$tqsdk.get({name:"orders",user_id:e});if(i){var r=function(e){if(t.ordersTr[e])t.update_order(i[e],t.ordersTr[e]);else{var r=t.append_order(i[e]);r.onclick=function(n){var s=t.tbodyNode.querySelectorAll("tr");s.forEach((function(t){return t.className=""})),r.className="selected",t.$eventHub.$emit("moveChartToDt",i[e].insert_date_time)},t.ordersTr[e]=r}};for(var n in i)r(n)}}}))},methods:{append_order:function(t){var e=document.createElement("tr");for(var i in this.columns){var r=this.columns[i],n=this.get_td_text(r.cb?r.cb(t):t[r.key],r.key);e.appendChild(n)}for(var s in this.columnsAppend){var a=this.columnsAppend[s],o=this.get_td_text(a.cb?a.cb(t):t[a.key],a.key);e.appendChild(o)}return this.tbodyNode.insertBefore(e,this.tbodyNode.firstChild),e},update_order:function(t,e){for(var i in this.columnsAppend){var r=this.columns[i],n=e.querySelector("."+r.key),s=r.cb?r.cb(t):t[r.key];s!==n.textContent&&this.update_td_text(s,n)}},get_td_text:function(t,e){var i=document.createElement("td");return i.className=e,i.textContent=t,i},update_td_text:function(t,e){e.textContent=t}}},Dt=Mt,Pt=Object(p["a"])(Dt,Ot,St,!1,null,null,null),jt=Pt.exports,Tt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"reports positions-table",style:{height:t.height+"px"}},[i("table",[i("thead",[i("tr",[t._l(t.columns,(function(e){return i("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])})),t._l(t.columnsAppend,(function(e){return i("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])}))],2)]),i("tbody")])])},Ct=[],Et={data:function(){return{tbodyRoot:null,columns:[{name:"持仓合约",width:"100",key:"instrument_id",cb:function(t){return t.exchange_id+"."+t.instrument_id}}],columnsAppend:[{name:"多仓",key:"volume_long",width:"60"},{name:"多头开仓均价",width:"80",key:"open_price_long"},{name:"多头浮动盈亏",width:"80",key:"position_profit_long"},{name:"多头占用保证金",width:"80",key:"margin_long",cb:function(t){return t.margin_long.toFixed?t.margin_long.toFixed(2):t.margin_long}},{name:"空仓",key:"volume_short",width:"60"},{name:"空头开仓均价",width:"80",key:"open_price_short"},{name:"空头浮动盈亏",width:"80",key:"position_profit_short"},{name:"空头占用保证金",width:"80",key:"margin_short",cb:function(t){return t.margin_short.toFixed?t.margin_short.toFixed(2):t.margin_short}}],ordersTr:{}}},props:{height:Number},mounted:function(){this.tbodyNode=document.querySelector(".positions-table table tbody");var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$store.state.account_id;if(e){var i=t.$tqsdk.get({name:"positions",user_id:e});if(i)for(var r in i)i[r]._epoch===t.$tqsdk.dm._epoch&&(t.ordersTr[r]?t.update_position(i[r],t.ordersTr[r]):t.ordersTr[r]=t.append_position(i[r]))}}))},methods:{append_position:function(t){var e=document.createElement("tr");for(var i in this.columns){var r=this.columns[i],n=this.get_td_text(r.cb?r.cb(t):t[r.key],r.key);e.appendChild(n)}for(var s in this.columnsAppend){var a=this.columnsAppend[s],o=this.get_td_text(a.cb?a.cb(t):t[a.key],a.key);e.appendChild(o)}return this.tbodyNode.insertBefore(e,this.tbodyNode.firstChild),e},update_position:function(t,e){for(var i in this.columnsAppend){var r=this.columnsAppend[i],n=e.querySelector("."+r.key),s=r.cb?r.cb(t):t[r.key];s!==n.textContent&&this.update_td_text(s,n)}},get_td_text:function(t,e){var i=document.createElement("td");return i.className=e,i.textContent=t,i},update_td_text:function(t,e){e.textContent=t}}},qt=Et,It=Object(p["a"])(qt,Tt,Ct,!1,null,null,null),At=It.exports,Wt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"account-info",style:{height:t.height+"px"}},[i("div",[t._v(" 账户权益: "+t._s(t.balance)+" ")]),i("div",[t._v(" 浮动盈亏: "+t._s(t.float_profit)+" ")]),i("div",[t._v(" 保证金占用: "+t._s(t.margin)+" ")]),i("div",[t._v(" 日内手续费: "+t._s(t.commission)+" ")]),i("div",[t._v(" 可用资金: "+t._s(t.available)+" ")])])},Yt=[],Lt={data:function(){return{available:"-",balance:"-",commission:"-",float_profit:"-",margin:"-"}},props:{height:Number},mounted:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$store.state.account_id;if(e){var i=t.$tqsdk.get({name:"account",user_id:e,currency:"CNY"});i._epoch===t.$tqsdk.dm._epoch&&(t.available=i.available,t.balance=i.balance,t.commission=i.commission,t.float_profit=i.float_profit,t.margin=i.margin)}}))}},Rt=Lt,Nt=(i("a240"),Object(p["a"])(Rt,Wt,Yt,!1,null,null,null)),Ut=Nt.exports,Gt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"backtest-info",style:{height:t.height+"px"}},[i("Row",[i("Col",{attrs:{span:6}},[t._v("起始资金")]),i("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.init_balance,2)))]),i("Col",{attrs:{span:6}},[t._v("总收益")]),i("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.balance-t.init_balance,2)))]),i("Col",{attrs:{span:6}},[t._v("结束资金")]),i("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.balance,2)))]),i("Col",{attrs:{span:6}},[t._v("总收益率")]),i("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.ror,2))+"%")]),i("Col",{attrs:{span:6}},[t._v("最大回撤")]),i("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.max_drawdown,2)))]),i("Col",{attrs:{span:6}},[t._v("年化收益率")]),i("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.annual_yield,2))+"%")]),i("Col",{attrs:{span:6}},[t._v("总手续费")]),i("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.commission,2)))]),i("Col",{attrs:{span:6}},[t._v("年化夏普率")]),i("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.sharpe_ratio,2))+"%")]),i("Col",{attrs:{span:12}},[t._v(t._s(t.getMsg(t.ror)))])],1)],1)},Ht=[],Ft={data:function(){return{init_balance:"-",balance:"-",ror:"-",annual_yield:"-",max_drawdown:"-",sharpe_ratio:"-",commission:"-"}},props:{height:Number,width:Number},methods:{getMsg:function(t){return t<=-100?"幸好是模拟账户，不然你就亏完啦":t<=-50?"触底反弹,与其执迷修改参数，不如改变策略思路去天勤官网策略库进修":t<=-20?"越挫越勇，不如去天勤量化官网策略库进修":t<=0?"不要灰心，少侠重新来过":t<=20?"策略看来小有所成":t<=50?"策略看来的得心应手":t<=100?"策略看来春风得意，堪比当代索罗斯":"策略看来独孤求败，小心过拟合噢"}},mounted:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$store.state.account_id;if(console.log(e,"d account_id"),e){var i=t.$tqsdk.get({name:"account",user_id:e,currency:"CNY"});if(i&&i._tqsdk_stat){t.init_balance=i._tqsdk_stat.init_balance,t.balance=i._tqsdk_stat.balance,t.max_drawdown=i._tqsdk_stat.max_drawdown,t.annual_yield=i._tqsdk_stat.annual_yield,t.ror=i._tqsdk_stat.ror,t.sharpe_ratio=i._tqsdk_stat.sharpe_ratio;var r=t.$tqsdk.get({name:"trades",user_id:e}),n=0;for(var s in r)n+=r[s].commission;t.commission=n}}}))}},Bt=Ft,zt=(i("5ab6"),Object(p["a"])(Bt,Gt,Ht,!1,null,null,null)),$t=zt.exports,Kt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"backtest-report"},[i("e-chart",{ref:"echart",attrs:{height:"240px",width:t.width+"px","path-option":t.defaultOption}})],1)},Vt=[],Qt=(i("25eb"),i("a6fb")),Zt=i.n(Qt),Jt=i("313e"),Xt=i.n(Jt);(function(){var t=function(t,e,i){i=i||window;var r=!1,n=function(){r||(r=!0,requestAnimationFrame((function(){i.dispatchEvent(new CustomEvent(e)),r=!1})))};i.addEventListener(t,n)};t("resize","optimizedResize")})();var te={name:"v-echart",render:function(t){var e={staticClass:"v-chart",style:this.canvasStyle,ref:"canvas",on:this.$listeners};return t("div",e)},props:{width:{type:String,default:"auto"},height:{type:String,default:"400px"},pathOption:[Object,Array],widthChangeDelay:{type:Number,default:450}},data:function(){return{chartInstance:null,_defaultOption:{animation:!1,tooltip:{show:!0},title:{show:!0,textStyle:{fontSize:"16px",color:"rgba(0, 0, 0 , .87)",fontFamily:"sans-serif"}},grid:{containLabel:!0},xAxis:{show:!0,type:"category",axisLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}},axisTick:{show:!0,alignWithLabel:!0,lineStyle:{show:!0,color:"rgba(0, 0, 0 , .24)"}},axisLabel:{show:!1},splitLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}}},yAxis:{show:!0,type:"value",max:"dataMax",min:"dataMin",axisLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}},axisLabel:{show:!1,color:"rgba(0, 0, 0 , .24)"},splitLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}},axisTick:{show:!0,lineStyle:{show:!0,color:"rgba(0, 0, 0 , .54)"}}},series:[{type:"line"}]}}},computed:{canvasStyle:function(){return{width:this.width,height:this.height}}},methods:{init:function(){var t=this;this.pathOption&&this.pathOption.forEach((function(e){Zt.a.set(t.$data._defaultOption,e[0],e[1])})),this.chartInstance=Xt.a.init(this.$refs.canvas),this.chartInstance.setOption(this.$data._defaultOption),window.addEventListener("optimizedResize",(function(e){setTimeout((function(e){t.chartInstance.resize()}),t.widthChangeDelay)}))},showLoadPercent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&t<100?(t=Math.max(t,0),this.chartInstance.showLoading("default",{text:"数据已加载 "+t+"%",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0})):this.chartInstance.hideLoading()},update:function(t){this.chartInstance.setOption(t)},resize:function(){this.chartInstance.resize()},clean:function(){window.removeEventListener("resize",this.chartInstance.resize),this.chartInstance.clear()}},mounted:function(){this.init()},beforeDestroy:function(){this.clean()}},ee={components:{EChart:te},data:function(){return{daily_yield:[],defaultOption:[["grid.top","16px"],["grid.left","10px"],["grid.bottom","0px"],["grid.right","16px"],["series[0]",{type:"line",encode:{x:"datetime",y:["balance"]},smooth:!1,showAllSymbol:!0,areaStyle:{}}],["yAxis.show",!0],["yAxis.type","value"],["yAxis.axisLabel",{show:!0,formatter:function(t,e){return t.toFixed(2)},color:"#333333"}],["yAxis.splitLine",{show:!0}],["xAxis.show",!0],["xAxis.type","time"],["xAxis.axisLabel",{show:!0,color:"#333333"}],["xAxis.splitLine",{show:!0}],["xAxis.boundaryGap",!1],["tooltip",{trigger:"axis",triggerOn:"mousemove|click"}]]}},props:{height:Number,width:Number},methods:{},mounted:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$tqsdk.get_by_path(["snapshots"]),i=[];for(var r in e)r>t.$store.state.end_dt||i.push([Number.parseInt(r/1e6),e[r].accounts.CNY.balance]);t.$refs.echart.update({dataset:{source:i}})}))}},ie=ee,re=(i("b7de"),Object(p["a"])(ie,Kt,Vt,!1,null,null,null)),ne=re.exports,se={name:"tq-bottom-view",components:{TqLayoutArea:g,TradesTable:xt,OrdersTable:jt,PositionsTable:At,AccountInfo:Ut,BacktestInfo:$t,BacktestChart:ne},props:{height:Number,width:Number},data:function(){return{}},methods:{},created:function(){}},ae=se,oe=(i("1a2d3"),Object(p["a"])(ae,pt,yt,!1,null,null,null)),ce=oe.exports,he=38,ue=4,le=56,de={name:"tq-home",components:{TqHeaderView:k,TqTopView:mt,TqBottomView:ce},data:function(){var t=400,e=he+t+ue;return{isMoving:!1,headerHeight:he,topHeight:t,topHeightMin:260,bottomYOffset:e,bottomYOffsetMin:2*he,bottomYOffsetMax:this.$root.windowHeight-le,bottomHeight:this.$root.windowHeight-e-ue,showBottomShadow:!1}},methods:{onResize:function(){this.bottomYOffsetMax=this.$root.windowHeight-le,this.computeLayouts()},handleMousedown:function(t){this.isMoving=!0,ut(document,"mousemove",this.handleMove),ut(document,"mouseup",this.handleUp)},handleMove:function(t){var e=t.pageY;e>=this.bottomYOffsetMax||e<=this.bottomYOffsetMin||(this.bottomYOffset=e,this.computeLayouts())},handleUp:function(){this.isMoving=!1,lt(document,"mousemove",this.handleMove),lt(document,"mouseup",this.handleUp)},computeLayouts:function(){var t=this.$root.windowHeight-this.bottomYOffset;t<=le&&(t=le,this.bottomYOffset=this.$root.windowHeight-t),this.showBottomShadow=this.bottomYOffset<this.topHeightMin+he,this.bottomHeight=t-ue;var e=this.$root.windowHeight-he-t-ue;this.topHeight=Math.max(e,this.topHeightMin)}},created:function(){this.$eventHub.$on("window_resize",this.onResize),this.computeLayouts()}},_e=de,fe=(i("a124"),Object(p["a"])(_e,c,h,!1,null,null,null)),me=fe.exports,pe={name:"tq-app",components:{Tianqin:me}},ye=pe,ge=(i("5c0b"),Object(p["a"])(ye,a,o,!1,null,null,null)),ve=ge.exports,be=i("b090"),we=i("8629"),ke=i("f843"),xe=i("8144"),Oe=i("2d48"),Se=i("6def"),Me=i("e79d"),De=i("90b2"),Pe=i("c5c1"),je=i("dcbf"),Te=i("e3f5"),Ce=i("5250"),Ee=i("76ea"),qe=i("b3e6"),Ie=i("8679"),Ae=i("fe66"),We=i("6252"),Ye=i("9259"),Le=i("aa30"),Re=i("e0b9");i("f8ce");r["a"].prototype.$Loading=Re["a"],r["a"].prototype.$Message=Le["a"],r["a"].prototype.$Modal=Ye["a"],r["a"].prototype.$Notice=We["a"],r["a"].prototype.$Spin=Ae["a"],r["a"].component("Layout",Ie["a"]),r["a"].component("Row",qe["a"]),r["a"].component("Col",Ee["a"]),r["a"].component("Icon",Ce["a"]),r["a"].component("Button",Te["a"]),r["a"].component("ButtonGroup",je["a"]),r["a"].component("Dropdown",Pe["a"]),r["a"].component("DropdownMenu",De["a"]),r["a"].component("DropdownItem",Me["a"]),r["a"].component("Badge",Se["a"]),r["a"].component("Radio",Oe["a"]),r["a"].component("RadioGroup",xe["a"]),r["a"].component("Tabs",ke["a"]),r["a"].component("TabPane",we["a"]);var Ne=i("2f62");r["a"].use(Ne["a"]);var Ue=new Ne["a"].Store({state:{mode:"",broker_id:"",account_id:"",py_file_status:"",md_url_status:"",td_url_status:"",file_path:"",file_name:""},mutations:{set_action:function(t,e){Object.assign(t,e)},set_py_file_status:function(t,e){t.py_file_status=e}},actions:{}}),Ge=Ue;r["a"].config.productionTip=!1,r["a"].$eventHub=new r["a"],r["a"].prototype.$eventHub=r["a"].$eventHub;var He={name:"tianqin-web",windowHeight:window.innerHeight,windowWidth:window.innerWidth},Fe=new r["a"]({data:He,store:Ge,render:function(t){return t(ve)},methods:{handlerResize:function(){He.windowHeight=window.innerHeight,He.windowWidth=window.innerWidth,this.$eventHub.$emit("window_resize",{width:He.windowWidth,height:He.windowHeight})}},created:function(){var t;function e(){t||(t=setTimeout((function(){t=null,Fe.handlerResize()}),200))}window.addEventListener("resize",e,!1)},errorCaptured:function(t,e,i){return console.error("App.errorCaptured",t,e,i),!1},destroyed:function(){}});r["a"].filter("toFixed",(function(t,e){var i=Number(t);return e=Number.isInteger(e)?e:2,Number.isFinite(i)?i.toFixed(e):t})),GetTqsdkUrl().then((function(t){var e=t["ins_url"],i=t["md_url"],n=t["ws_url"];if("https://openmd.shinnytech.com/t/md/symbols/latest.json"===e){var a=s()().format("YYYY-MM-DD HH:mm:ss.SSSSSS");e="https://openmd.shinnytech.com/t/md/symbols/".concat(a,".json")}r["a"].$tqsdk=new be["a"]({symbolsServerUrl:e,wsQuoteUrl:i,wsTradeUrl:n}),r["a"].prototype.$tqsdk=r["a"].$tqsdk,r["a"].$tqsdk.on("rtn_data",(function(){var t=r["a"].$tqsdk.get_by_path(["_tqsdk_backtest"]);t&&t.current_dt&&(Ge.state.start_dt=t.start_dt,Ge.state.end_dt=t.end_dt);var e=r["a"].$tqsdk.get_by_path(["action"]);""===Ge.state.mode&&e&&Ge.commit("set_action",e)})),r["a"].$tqsdk.defaultTradeWs.on("close",(function(){Ge.commit("set_py_file_status",!1)})),r["a"].$tqsdk.defaultTradeWs.on("open",(function(){Ge.commit("set_py_file_status",!0)})),Fe.$mount("#app")}))},"5ab6":function(t,e,i){"use strict";var r=i("d85d"),n=i.n(r);n.a},"5c0b":function(t,e,i){"use strict";var r=i("9c0c"),n=i.n(r);n.a},"5c44":function(t,e,i){},6491:function(t,e,i){},"657e":function(t,e,i){},"889f":function(t,e,i){},"8e24":function(t,e,i){"use strict";var r=i("889f"),n=i.n(r);n.a},"8fde":function(t,e,i){},"9c0c":function(t,e,i){},a124:function(t,e,i){"use strict";var r=i("657e"),n=i.n(r);n.a},a240:function(t,e,i){"use strict";var r=i("07f6"),n=i.n(r);n.a},a829:function(t,e,i){},b090:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("cace"),core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("ff42"),core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_symbol_iterator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("6654"),core_js_modules_es_symbol_iterator__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_symbol_iterator__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("8415"),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("9843"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("791d"),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("68d8"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("56bf"),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("e7a5"),core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("aa27"),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("bafe"),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("0835"),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_number_is_finite__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("f468"),core_js_modules_es_number_is_finite__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_number_is_finite__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es_object_entries__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("1f3f"),core_js_modules_es_object_entries__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es_object_entries__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_es_object_get_own_property_descriptor__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("33f5"),core_js_modules_es_object_get_own_property_descriptor__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_es_object_get_own_property_descriptor__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_es_object_get_prototype_of__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("974c"),core_js_modules_es_object_get_prototype_of__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_es_object_get_prototype_of__WEBPACK_IMPORTED_MODULE_15__),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("3f13"),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_16__),core_js_modules_es_object_set_prototype_of__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("4008"),core_js_modules_es_object_set_prototype_of__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(core_js_modules_es_object_set_prototype_of__WEBPACK_IMPORTED_MODULE_17__),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("3f38"),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_18__),core_js_modules_es_reflect_get__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("7583"),core_js_modules_es_reflect_get__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(core_js_modules_es_reflect_get__WEBPACK_IMPORTED_MODULE_19__),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("3ffb"),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_20__),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("5720"),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_21__),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("7e4c"),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_22___default=__webpack_require__.n(core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_22__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("6af8"),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_23___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_23__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("f12a"),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_24__),core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("b3b0"),core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_25___default=__webpack_require__.n(core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_25__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("f455"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_26___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_26__),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("b520"),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_27___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_27__),core_js_modules_web_immediate__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("faf8"),core_js_modules_web_immediate__WEBPACK_IMPORTED_MODULE_28___default=__webpack_require__.n(core_js_modules_web_immediate__WEBPACK_IMPORTED_MODULE_28__),_Users_yanqiong_Documents_Github_shinny_futures_web_node_modules_babel_runtime_corejs3_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__("bf2d"),axios__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__("4b02"),axios__WEBPACK_IMPORTED_MODULE_30___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_30__),version="1.1.0";function _typeof(t){return _typeof="function"===typeof Symbol&&"symbol"===Object(_Users_yanqiong_Documents_Github_shinny_futures_web_node_modules_babel_runtime_corejs3_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_29__["a"])(Symbol.iterator)?function(t){return Object(_Users_yanqiong_Documents_Github_shinny_futures_web_node_modules_babel_runtime_corejs3_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_29__["a"])(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":Object(_Users_yanqiong_Documents_Github_shinny_futures_web_node_modules_babel_runtime_corejs3_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_29__["a"])(t)},_typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _inherits(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _possibleConstructorReturn(t,e){return!e||"object"!==Object(_Users_yanqiong_Documents_Github_shinny_futures_web_node_modules_babel_runtime_corejs3_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_29__["a"])(e)&&"function"!==typeof e?_assertThisInitialized(t):e}function _superPropBase(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=_getPrototypeOf(t),null===t)break;return t}function _get(t,e,i){return _get="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=_superPropBase(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(i):n.value}},_get(t,e,i||t)}function createCommonjsModule(t,e){return e={exports:{}},t(e,e.exports),e.exports}var eventemitter3=createCommonjsModule((function(t){var e=Object.prototype.hasOwnProperty,i="~";function r(){}function n(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(t,e,r,s,a){if("function"!==typeof r)throw new TypeError("The listener must be a function");var o=new n(r,s||t,a),c=i?i+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],o]:t._events[c].push(o):(t._events[c]=o,t._eventsCount++),t}function a(t,e){0===--t._eventsCount?t._events=new r:delete t._events[e]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1)),o.prototype.eventNames=function(){var t,r,n=[];if(0===this._eventsCount)return n;for(r in t=this._events)e.call(t,r)&&n.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},o.prototype.listeners=function(t){var e=i?i+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,a=new Array(s);n<s;n++)a[n]=r[n].fn;return a},o.prototype.listenerCount=function(t){var e=i?i+t:t,r=this._events[e];return r?r.fn?1:r.length:0},o.prototype.emit=function(t,e,r,n,s,a){var o=i?i+t:t;if(!this._events[o])return!1;var c,h,u=this._events[o],l=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,n),!0;case 5:return u.fn.call(u.context,e,r,n,s),!0;case 6:return u.fn.call(u.context,e,r,n,s,a),!0}for(h=1,c=new Array(l-1);h<l;h++)c[h-1]=arguments[h];u.fn.apply(u.context,c)}else{var d,_=u.length;for(h=0;h<_;h++)switch(u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),l){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,e);break;case 3:u[h].fn.call(u[h].context,e,r);break;case 4:u[h].fn.call(u[h].context,e,r,n);break;default:if(!c)for(d=1,c=new Array(l-1);d<l;d++)c[d-1]=arguments[d];u[h].fn.apply(u[h].context,c)}}return!0},o.prototype.on=function(t,e,i){return s(this,t,e,i,!1)},o.prototype.once=function(t,e,i){return s(this,t,e,i,!0)},o.prototype.removeListener=function(t,e,r,n){var s=i?i+t:t;if(!this._events[s])return this;if(!e)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||n&&!o.once||r&&o.context!==r||a(this,s);else{for(var c=0,h=[],u=o.length;c<u;c++)(o[c].fn!==e||n&&!o[c].once||r&&o[c].context!==r)&&h.push(o[c]);h.length?this._events[s]=1===h.length?h[0]:h:a(this,s)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o})),IsEmptyObject=function(t){return t&&t.constructor===Object&&0===Object.keys(t).length},RandomStr=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),i="",r=0;r<t;r++)i+=e[62*Math.random()|0];return i};function _genList(t){for(var e=[],i=t.split("|"),r=0;r<i.length;r++)e.push(i[r].trim());return e}function _genItem(t,e){for(var i={},r=0;r<t.length;r++)i[t[r]]=e[r];return i}function _genTableRow(t,e,i,r){var n={state:t,state_detail:e,isRow:!1,row:null};switch(e){case"T":""===r.replace(/-/g,"")?n.state_detail="C":i[t]=_genList(r);break;case"C":""===r.replace(/-/g,"")?n.state_detail="S":(n.isRow=!0,n.row=_genItem(i[t],_genList(r)));break;case"S":""===r.replace(/-/g,"")&&(n.state="",n.state_detail="");break}return n}var ParseSettlementContent=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(""===t)return t;var e=t.split("\n"),i="",r="",n={},s={positionClosed:"平仓明细 Position Closed",transactionRecords:"成交记录 Transaction Record",positions:"持仓汇总 Positions",positionsDetail:"持仓明细 Positions Detail",delivery:"交割明细  Delivery"},a=[],o=[],c={account:{}};Object.entries(s).forEach((function(t){a.push(t[0]),o.push(t[1]),c[t[0]]=[]}));for(var h=0;h<e.length;h++){var u=e[h].trim();if("资金状况  币种：人民币  Account Summary  Currency：CNY"!==u){if(o.includes(u))i=a[o.indexOf(u)],r="T",h++;else if("A-S"===i){if(0===u.length||""===u.replace("-","")){i="";continue}u.match(/([\u4e00-\u9fa5][\u4e00-\u9fa5\s]+[\u4e00-\u9fa5])+/g);for(var l=u.match(/([A-Z][a-zA-Z\.\/\(\)\s]+)[:：]+/g),d=u.match(/(-?[\d]+\.\d\d)/g),_=0;_<l.length;_++)c.account[l[_].split(/[:：]/)[0]]=d[_]}else if(a.includes(i)){if(0===u.length){i="";continue}var f=_genTableRow(i,r,n,u);i=f.state,r=f.state_detail,f.isRow&&c[i].push(f.row)}}else i="A-S",h++}return c},TqWebsocket=function(_EventEmitter){function TqWebsocket(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,TqWebsocket),e=_possibleConstructorReturn(this,_getPrototypeOf(TqWebsocket).call(this)),e.urlList=t instanceof Array?t:[t],e.ws=null,e.queue=[],e.reconnect=!0,e.reconnectTask=null,e.reconnectInterval=i.reconnectInterval?i.reconnectInterval:3e3,e.reconnectMaxTimes=i.reconnectMaxTimes?i.reconnectMaxTimes:5,e.reconnectTimes=0,e.reconnectUrlIndex=0,e.STATUS={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},e.__init(),e}return _inherits(TqWebsocket,_EventEmitter),_createClass(TqWebsocket,[{key:"send",value:function(t){var e=JSON.stringify(t);this.isReady()?this.ws.send(e):this.queue.push(e)}},{key:"isReady",value:function(){return this.ws.readyState===WebSocket.OPEN}},{key:"__init",value:function __init(){this.ws=new WebSocket(this.urlList[this.reconnectUrlIndex]),this.reconnectUrlIndex===this.urlList.length-1&&(this.reconnectTimes+=1);var _this=this;this.ws.onmessage=function(message){var data=eval("("+message.data+")");_this.emit("message",data),setImmediate((function(){_this.ws.send('{"aid":"peek_message"}')}))},this.ws.onclose=function(t){console.log("close",t),_this.emit("close"),_this.queue=[],_this.reconnect&&(_this.reconnectMaxTimes<=_this.reconnectTimes?(clearTimeout(_this.reconnectTask),_this.emit("death",{msg:"超过重连次数"+_this.reconnectMaxTimes})):_this.reconnectTask=setTimeout((function(){3===_this.ws.readyState&&(_this.reconnectUrlIndex=_this.reconnectUrlIndex+1<_this.urlList.length?_this.reconnectUrlIndex+1:0,_this.__init(),_this.emit("reconnect",{msg:"发起重连第 "+_this.reconnectTimes+" 次"}))}),_this.reconnectInterval))},this.ws.onerror=function(t){_this.emit("error",t),_this.ws.close()},this.ws.onopen=function(){_this.emit("open",{msg:"发起重连第 "+_this.reconnectTimes+" 次, 成功"}),_this.reconnectTimes=0,_this.reconnectUrlIndex=0,this.reconnectTask&&clearTimeout(_this.reconnectTask);while(_this.queue.length>0){if(1!==_this.ws.readyState)break;_this.ws.send(_this.queue.shift())}}}},{key:"close",value:function(){this.ws.onclose=function(){},this.ws.close()}}]),TqWebsocket}(eventemitter3),TqTradeWebsocket=function(t){function e(t,i){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _classCallCheck(this,e),r=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t,n)),r.dm=i,r.req_login=null,r.init(),r}return _inherits(e,t),_createClass(e,[{key:"init",value:function(){var t=this;this.on("message",(function(e){if("rtn_data"===e.aid){for(var i=t._separateNotifies(e.data),r=0;r<i.length;r++)t.emit("notify",i[r]);t.dm.mergeData(e.data)}else if("rtn_brokers"===e.aid)t.emit("rtn_brokers",e.brokers);else if("qry_settlement_info"===e.aid){var n=ParseSettlementContent(e.settlement_info);t.dm.mergeData({trade:_defineProperty({},e.user_name,{his_settlements:_defineProperty({},e.trading_day,n)})}),TQSDK.store&&TQSDK.store.setContent(e.user_name,e.trading_day,e.settlement_info)}})),this.on("reconnect",(function(){t.req_login&&t.send(t.req_login)}))}},{key:"_separateNotifies",value:function(t){for(var e=[],i=0;i<t.length;i++)if(t[i].notify){var r=t.splice(i--,1)[0].notify;for(var n in r)e.push(r[n])}return e}},{key:"send",value:function(t){"req_login"===t.aid&&(this.req_login=t),_get(_getPrototypeOf(e.prototype),"send",this).call(this,t)}}]),e}(TqWebsocket),TqQuoteWebsocket=function(t){function e(t,i){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _classCallCheck(this,e),r=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t,n)),r.dm=i,r.subscribe_quote=null,r.charts={},r.init(),r}return _inherits(e,t),_createClass(e,[{key:"init",value:function(){var t=this;this.on("message",(function(e){"rtn_data"===e.aid&&t.dm.mergeData(e.data)})),this.on("reconnect",(function(e){for(var i in console.log(e),t.subscribe_quote&&t.send(t.subscribe_quote),t.charts)t.charts[i].view_width>0&&t.send(t.charts[i])}))}},{key:"send",value:function(t){"subscribe_quote"===t.aid?null!==this.subscribe_quote&&JSON.stringify(t.ins_list)===JSON.stringify(this.subscribe_quote.ins_list)||(this.subscribe_quote=t,_get(_getPrototypeOf(e.prototype),"send",this).call(this,t)):"set_chart"===t.aid&&(0===t.view_width?this.charts[t.chart_id]&&delete this.charts[t.chart_id]:this.charts[t.chart_id]=t,_get(_getPrototypeOf(e.prototype),"send",this).call(this,t))}}]),e}(TqWebsocket),QUOTE=function(){function t(){_classCallCheck(this,t),this.instrument_id="",this.datetime="",this._last_price="-",this.ask_price1="-",this.ask_volume1="-",this.bid_price1="-",this.bid_volume1="-",this.highest="-",this.lowest="-",this.open="-",this.close="-",this.average="-",this.volume="-",this.amount="-",this.open_interest="-",this.lower_limit="-",this.upper_limit="-",this.settlement="-",this.change="-",this.change_percent="-",this.strike_price=NaN,this.pre_open_interest="-",this.pre_close="-",this.pre_volume="-",this._pre_settlement="-",this.margin="-",this.commission="-"}return _createClass(t,[{key:"setChange",value:function(){Number.isFinite(this._last_price)&&Number.isFinite(this._pre_settlement)&&0!==this._pre_settlement&&(this.change=this._last_price-this._pre_settlement,this.change_percent=this.change/this._pre_settlement*100)}},{key:"last_price",set:function(t){this._last_price=t,this.setChange()},get:function(){return this._last_price}},{key:"pre_settlement",set:function(t){this._pre_settlement=t,this.setChange()},get:function(){return this._pre_settlement}}]),t}(),DataManager=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,e),t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)),t._epoch=0,t._data=i,t._diffs=[],t}return _inherits(e,t),_createClass(e,[{key:"mergeData",value:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Array.isArray(t)?t:[t];i&&(this._epoch+=1,this._diffs=n);var s=!0,a=!1,o=void 0;try{for(var c,h=n[Symbol.iterator]();!(s=(c=h.next()).done);s=!0){var u=c.value;null===u||IsEmptyObject(u)||e.MergeObject(this._data,u,this._epoch,r)}}catch(l){a=!0,o=l}finally{try{s||null==h["return"]||h["return"]()}finally{if(a)throw o}}i&&this._data._epoch===this._epoch&&this.emit("data",null)}},{key:"isChanging",value:function(t){if(Array.isArray(t)){for(var e=this._data,i=0;i<t.length;i++){if(e=e[t[i]],e._epoch&&e._epoch===this._epoch)return!0;if(void 0===e)return!1}return!1}return!(!t||!t._epoch)&&t._epoch===this._epoch}},{key:"setDefault",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._data;return e.SetDefault(r,t,i)}},{key:"getByPath",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._data;return e.GetByPath(i,t)}}]),e}(eventemitter3);DataManager.SetDefault=function(t,e,i){for(var r=t,n=0;n<e.length;n++){if("string"!==typeof e[n]&&"number"!==typeof e[n]){console.error("SetDefault, pathArray 中的元素必須是 string or number, but pathArray = ",e);break}var s=e[n];if(s in r||(r[s]=n===e.length-1?i:{}),n===e.length-1)return r[s];r=r[s]}return r},DataManager.GetByPath=function(t,e){for(var i=t,r=0;r<e.length;r++)if(i=i[e[r]],void 0===i||null===i)return i;return i},DataManager.MergeObject=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];for(var n in e){var s=e[n],a=_typeof(s);if(["string","boolean","number"].includes(a))t[n]="NaN"===s?NaN:s;else if(null===s&&r)delete t[n];else if(Array.isArray(s))t[n]=s,s._epoch||Object.defineProperty(s,"_epoch",{configurable:!1,enumerable:!1,writable:!0}),s._epoch=i;else if("object"===a)if(t[n]=t[n]||("data"===n?[]:{}),"quotes"===n)for(var o in s){var c=s[o];null!==c?(t[n][o]||(t[n][o]=new QUOTE),DataManager.MergeObject(t[n][o],c,i,r)):r&&o&&delete t[n][o]}else DataManager.MergeObject(t[n],s,i,r)}t._epoch||Object.defineProperty(t,"_epoch",{configurable:!1,enumerable:!1,writable:!0}),t._epoch=i};var TQSDK=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.symbolsServerUrl,n=void 0===r?"https://openmd.shinnytech.com/t/md/symbols/latest.json":r,s=i.wsQuoteUrl,a=void 0===s?"wss://openmd.shinnytech.com/t/md/front/mobile":s,o=i.wsTradeUrl,c=void 0===o?"wss://openmd.shinnytech.com/trade/shinny":o,h=i.clientSystemInfo,u=void 0===h?"":h,l=i.clientAppId,d=void 0===l?"":l;_classCallCheck(this,e),t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)),t._symbol_services_url=n,t._ws_quote_url=a,t._ws_trade_url=c,t.clientSystemInfo=u,t.clientAppIds=d,t._prefix="TQJS_";var _=_assertThisInitialized(t);return t.dm=new DataManager({klines:{},quotes:{},charts:{},ticks:{}}),t.dm.on("data",(function(){_.emit("rtn_data",null)})),t.brokers=null,t.trade_accounts={},t.isReady=!1,t.quotesWs=new TqQuoteWebsocket(a,t.dm),t.quotesInfo={},t.defaultTradeWs=new TqTradeWebsocket(c,t.dm),t.defaultTradeWs.on("rtn_brokers",(function(t){_.brokers=t,_.emit("rtn_brokers",t)})),axios__WEBPACK_IMPORTED_MODULE_30___default.a.get(t._symbol_services_url,{headers:{Accept:"application/json; charset=utf-8"}}).then((function(t){_.quotesInfo=t.data,_.isReady=!0,_.emit("ready"),_.emit("rtn_data",null)}))["catch"]((function(t){return _.emit("error",t),console.error("Error: "+t.message),t})),t}return _inherits(e,t),_createClass(e,[{key:"addAccount",value:function(t,e,i){if(t&&e&&i){if(!this.trade_accounts[e]){var r=null===this.defaultTradeWs.req_login?this.defaultTradeWs:new TqTradeWebsocket(this._ws_trade_url,this.dm),n=this;r.on("notify",(function(i){n.emit("notify",Object.assign(i,{bid:t,user_id:e}))})),this.trade_accounts[e]={bid:t,userId:e,password:i,ws:r}}return this.trade_accounts[e]}return null}},{key:"removeAccount",value:function(t,e){t&&e&&this.trade_accounts[e]&&(this.trade_accounts[e].ws.close(),delete this.trade_accounts[e],delete this.dm._data.trade[e])}},{key:"updateData",value:function(t){this.dm.mergeData(t,!0,!1)}},{key:"getByPath",value:function(t){return this.dm.getByPath(t)}},{key:"getQuotesByInput",value:function(t){if("string"!==typeof t&&!t.input)return[];var e={input:"string"===typeof t?t.toLowerCase():t.input.toLowerCase(),instrument_id:!t.instrument_id||t.instrument_id,pinyin:!t.pinyin||t.pinyin,include_expired:!!t.include_expired&&t.include_expired,FUTURE:!t.future||!!t.future,FUTURE_INDEX:!!t.future_index&&!!t.future_index,FUTURE_CONT:!!t.future_cont&&!!t.future_cont,OPTION:!!t.option&&!!t.option,COMBINE:!!t.combine&&!!t.combine},i=function(t,e,i){return!(!t[e["class"]]||!t.include_expired&&(t.include_expired||e.expired))&&("instrument_id"===i?e.product_id.toLowerCase()===t.input||t.input.length>2&&e.instrument_id.toLowerCase().indexOf(t.input)>-1:"pinyin"===i&&e.py.split(",").indexOf(t.input)>-1)},r=[];if(e.instrument_id)for(var n in this.quotesInfo)i(e,this.quotesInfo[n],"instrument_id")&&r.push(n);if(e.pinyin)for(var s in this.quotesInfo)i(e,this.quotesInfo[s],"pinyin")&&r.push(s);return r}},{key:"getQuote",value:function(t){if(""===t)return{};var e=this.dm.setDefault(["quotes",t],new QUOTE);if(!e["class"]&&this.quotesInfo[t]){var i=e.last_price?e.last_price:this.quotesInfo[t].last_price;Object.assign(e,this.quotesInfo[t],{last_price:i})}return e}},{key:"setChart",value:function(t){var e={};t.trading_day_start||t.trading_day_count?(e.trading_day_start=t.trading_day_start?t.trading_day_start:0,e.trading_day_count=t.trading_day_count?t.trading_day_count:864e11):(e.view_width=t.view_width?t.view_width:500,t.left_kline_id?e.left_kline_id=t.left_kline_id:t.focus_datetime&&(e.focus_datetime=t.focus_datetime,e.focus_position=t.focus_position?t.focus_position:0)),this.quotesWs.send(Object.assign({aid:"set_chart",chart_id:t.chart_id?t.chart_id:this._prefix+"kline_chart",ins_list:t.ins_list?t.ins_list.join(","):t.symbol,duration:t.duration},e))}},{key:"getUser",value:function(t){var e="string"===typeof t?t:t.user_id;return e?this.dm._data.trade[e]:null}},{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.name,i=void 0===e?"users":e,r=t.user_id,n=void 0===r?"":r,s=t.currency,a=void 0===s?"CNY":s,o=t.symbol,c=void 0===o?"":o,h=t.order_id,u=void 0===h?"":h,l=t.trade_id,d=void 0===l?"":l,_=t.trading_day,f=void 0===_?"":_,m=t.chart_id,p=void 0===m?"":m,y=t.input,g=void 0===y?"":y,v=t.duration,b=void 0===v?0:v;if("users"===i)return Object.keys(this.trade_accounts);if(n){var w=this.get_user(n);if("user"===i)return w;if(["session","accounts","positions","orders","trades","his_settlements"].indexOf(i)>-1)return w&&w[i]?w[i]:null;if(w&&w[i+"s"]){var k="account"===i?a:"position"===i?c:"order"===i?u:"trade"===i?d:"his_settlement"===i?f:"";return w[i+"s"][k]}return null}return"quotes"===i?g?this.get_quotes_by_input(g):[]:"quote"===i?this.getQuote(c):"klines"===i?this.getKlines(c,b):"ticks"===i?this.getTicks(c):"charts"===i?this.dm.getByPath(["charts"]):"chart"===i?this.dm.getByPath(["charts",p]):void 0}},{key:"getKlines",value:function(t,e){if(""===t)return null;var i=this.dm.getByPath(["klines",t,e]);return i&&i.data&&-1!==i.last_id||(this.dm.mergeData({klines:_defineProperty({},t,_defineProperty({},e,{last_id:-1,data:{}}))},!1,!1),i=this.dm.getByPath(["klines",t,e])),i}},{key:"getTicks",value:function(t){if(""===t)return null;var e=this.dm.getByPath(["ticks",t]);return e&&e.data||this.dm.mergeData({ticks:_defineProperty({},t,{last_id:-1,data:{}})},!1,!1),this.dm.getByPath(["ticks",t])}},{key:"isLogined",value:function(t){var e=this.get({name:"session",user_id:t.user_id});return!(!e||!e.trading_day)}},{key:"isChanging",value:function(t,e){return t&&t._epoch?t._epoch===this.dm._epoch:"string"===typeof t&&this.dm.isChanging(t,e)}},{key:"insertOrder",value:function(t){if(!this.is_logined(t))return null;var e=this._prefix+RandomStr(8),i={user_id:t.user_id,orderId:e,exchange_id:t.exchange_id,instrument_id:t.ins_id,direction:t.direction,offset:t.offset,price_type:t.price_type?t.price_type:"LIMIT",limit_price:Number(t.limit_price),volume_condition:"ANY",time_condition:"ANY"===t.price_type?"IOC":"GFD"},r=Object.assign({aid:"insert_order",volume:t.volume},i);this.trade_accounts[t.user_id].ws.send(r);var n=Object.assign({volume_orign:t.volume,status:"ALIVE",volume_left:t.volume},i);return this.dm.mergeData({trade:_defineProperty({},t.user_id,{orders:_defineProperty({},e,n)})},!1,!1),this.get({name:"order",user_id:t.user_id,orderId:e})}},{key:"autoInsertOrder",value:function(t){if(!this.is_logined(t))return null;var e={user_id:t.user_id,price_type:t.price_type?t.price_type:"LIMIT",volume_condition:"ANY",time_condition:"ANY"===t.price_type?"IOC":"GFD",exchange_id:t.exchange_id,instrument_id:t.ins_id,direction:t.direction,limit_price:Number(t.limit_price)};if("SHFE"===t.exchange_id&&"CLOSE"===t.offset){var i=this.dm.getPosition(t.symbol,t.user_id),r=0;"BUY"===t.direction&&i.volume_short_today>0?r=Math.min(i.volume_short_today,t.volume):"SELL"===t.direction&&i.volume_long_today>0&&(r=Math.min(i.volume_long_today,t.volume)),r>0&&this.insert_order(Object.assign({offset:"CLOSETODAY",volume:r},e)),t.volume-r>0&&this.insert_order(Object.assign({offset:"CLOSE",volume:t.volume-r},e))}else this.insert_order(Object.assign({offset:t.offset,volume:t.volume},e))}},{key:"cancelOrder",value:function(t){this.trade_accounts[t.user_id].ws.send({aid:"cancel_order",user_id:t.user_id,order_id:t.order_id?t.order_id:t})}},{key:"login",value:function(t){this.trade_accounts[t.user_id].ws.send({aid:"req_login",bid:t.bid,user_name:t.user_id,password:t.password,client_system_info:this.clientSystemInfo,client_app_id:this.clientAppId})}},{key:"confirmSettlement",value:function(t){this.trade_accounts[t.user_id].ws.send({aid:"confirm_settlement"})}},{key:"transfer",value:function(t){this.trade_accounts[t.user_id].ws.send({aid:"req_transfer",bank_id:t.bank_id,bank_password:t.bank_password,future_account:t.future_account,future_password:t.future_password,currency:"CNY",amount:t.amount})}},{key:"hisSettlement",value:function(t){if(!e.store)return null;var i=this.dm.getByPath(["trade",t.user_id,"his_settlements",t.trading_day]);if(void 0===i){var r=this;i=e.store.getContent(t.user_id,t.trading_day).then((function(e){if(null===e)r.trade_accounts[t.user_id].ws.send({aid:"qry_settlement_info",trading_day:Number(t.trading_day)});else{var i=ParseSettlementContent(e);r.dm.mergeData({trade:_defineProperty({},t.user_id,{his_settlements:_defineProperty({},t.trading_day,i)})},!0,!1)}}))["catch"]((function(t){console.error(t)}))}}},{key:"subscribeQuote",value:function(t){this.quotesWs.send({aid:"subscribe_quote",ins_list:Array.isArray(t)?t.join(","):t})}}]),e}(eventemitter3);TQSDK.prototype.subscribe_quote=TQSDK.prototype.subscribeQuote,TQSDK.prototype.his_settlement=TQSDK.prototype.hisSettlement,TQSDK.prototype.confirm_settlement=TQSDK.prototype.confirmSettlement,TQSDK.prototype.add_account=TQSDK.prototype.addAccount,TQSDK.prototype.remove_account=TQSDK.prototype.removeAccount,TQSDK.prototype.update_data=TQSDK.prototype.updateData,TQSDK.prototype.get_by_path=TQSDK.prototype.getByPath,TQSDK.prototype.get_quotes_by_input=TQSDK.prototype.getQuotesByInput,TQSDK.prototype.get_quote=TQSDK.prototype.getQuote,TQSDK.prototype.set_chart=TQSDK.prototype.setChart,TQSDK.prototype.get_user=TQSDK.prototype.getUser,TQSDK.prototype.is_logined=TQSDK.prototype.isLogined,TQSDK.prototype.is_changed=TQSDK.prototype.isChanging,TQSDK.prototype.insert_order=TQSDK.prototype.insertOrder,TQSDK.prototype.auto_insert_order=TQSDK.prototype.autoInsertOrder,TQSDK.prototype.cancel_order=TQSDK.prototype.cancelOrder,TQSDK.TqWebsocket=TqWebsocket,TQSDK.DataManager=DataManager,TQSDK.version=version,__webpack_exports__["a"]=TQSDK},b7de:function(t,e,i){"use strict";var r=i("5096"),n=i.n(r);n.a},b9e2:function(t,e,i){"use strict";var r=i("a829"),n=i.n(r);n.a},beea:function(t,e,i){"use strict";(function(t){i("a4d3"),i("e01a"),i("d28b"),i("99af"),i("cb29"),i("4160"),i("a630"),i("c975"),i("a15b"),i("fb6a"),i("45fc"),i("4e82"),i("accc"),i("f4b3"),i("0d03"),i("b0c0"),i("a9e3"),i("f00c"),i("8ba4"),i("9129"),i("b680"),i("7039"),i("3410"),i("e21d"),i("b64b"),i("d3b7"),i("acd8"),i("e25e"),i("4d63"),i("ac1f"),i("5377"),i("25f0"),i("8a79"),i("3ca3"),i("466d"),i("4d90"),i("5319"),i("1276"),i("4c53"),i("159b"),i("ddb0"),i("bf19");var r=i("9aa6"),n=i("902f"),s=i("c3c5"),a=i("8b83"),o=i("c65a"),c=i("c03e"),h=i("9f12"),u=i("53fe"),l=i("bf2d"),d=i("19b8"),_="0.0.1";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t||"undefined"!==typeof self&&self;function f(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function m(t,e){return e={exports:{}},t(e,e.exports),e.exports}var p=m((function(t){var e=t.exports={version:"2.6.10"};"number"==typeof __e&&(__e=e)})),y=(p.version,m((function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}))),g=m((function(t){var e="__core-js_shared__",i=y[e]||(y[e]={});(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:p.version,mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})})),v=0,b=Math.random(),w=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++v+b).toString(36))},k=m((function(t){var e=g("wks"),i=y.Symbol,r="function"==typeof i,n=t.exports=function(t){return e[t]||(e[t]=r&&i[t]||(r?i:w)("Symbol."+t))};n.store=e})),x=function(t){return"object"===Object(l["a"])(t)?null!==t:"function"===typeof t},O=function(t){if(!x(t))throw TypeError(t+" is not an object!");return t},S=function(t){try{return!!t()}catch(e){return!0}},M=!S((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),D=y.document,P=x(D)&&x(D.createElement),j=function(t){return P?D.createElement(t):{}},T=!M&&!S((function(){return 7!=Object.defineProperty(j("div"),"a",{get:function(){return 7}}).a})),C=function(t,e){if(!x(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!x(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!x(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!x(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")},E=Object.defineProperty,q=M?Object.defineProperty:function(t,e,i){if(O(t),e=C(e,!0),O(i),T)try{return E(t,e,i)}catch(r){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t},I={f:q},A=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},W=M?function(t,e,i){return I.f(t,e,A(1,i))}:function(t,e,i){return t[e]=i,t},Y=k("unscopables"),L=Array.prototype;void 0==L[Y]&&W(L,Y,{});var R=function(t){L[Y][t]=!0},N=function(t,e){return{value:e,done:!!t}},U={},G={}.toString,H=function(t){return G.call(t).slice(8,-1)},F=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==H(t)?t.split(""):Object(t)},B=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},z=function(t){return F(B(t))},$={}.hasOwnProperty,K=function(t,e){return $.call(t,e)},V=g("native-function-to-string",Function.toString),Q=m((function(t){var e=w("src"),i="toString",r=(""+V).split(i);p.inspectSource=function(t){return V.call(t)},(t.exports=function(t,i,n,s){var a="function"==typeof n;a&&(K(n,"name")||W(n,"name",i)),t[i]!==n&&(a&&(K(n,e)||W(n,e,t[i]?""+t[i]:r.join(String(i)))),t===y?t[i]=n:s?t[i]?t[i]=n:W(t,i,n):(delete t[i],W(t,i,n)))})(Function.prototype,i,(function(){return"function"==typeof this&&this[e]||V.call(this)}))})),Z=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},J=function(t,e,i){if(Z(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,r){return t.call(e,i,r)};case 3:return function(i,r,n){return t.call(e,i,r,n)}}return function(){return t.apply(e,arguments)}},X="prototype",tt=function t(e,i,r){var n,s,a,o,c=e&t.F,h=e&t.G,u=e&t.S,l=e&t.P,d=e&t.B,_=h?y:u?y[i]||(y[i]={}):(y[i]||{})[X],f=h?p:p[i]||(p[i]={}),m=f[X]||(f[X]={});for(n in h&&(r=i),r)s=!c&&_&&void 0!==_[n],a=(s?_:r)[n],o=d&&s?J(a,y):l&&"function"==typeof a?J(Function.call,a):a,_&&Q(_,n,a,e&t.U),f[n]!=a&&W(f,n,o),l&&m[n]!=a&&(m[n]=a)};y.core=p,tt.F=1,tt.G=2,tt.S=4,tt.P=8,tt.B=16,tt.W=32,tt.U=64,tt.R=128;var et=tt,it=Math.ceil,rt=Math.floor,nt=function(t){return isNaN(t=+t)?0:(t>0?rt:it)(t)},st=Math.min,at=function(t){return t>0?st(nt(t),9007199254740991):0},ot=Math.max,ct=Math.min,ht=function(t,e){return t=nt(t),t<0?ot(t+e,0):ct(t,e)},ut=function(t){return function(e,i,r){var n,s=z(e),a=at(s.length),o=ht(r,a);if(t&&i!=i){while(a>o)if(n=s[o++],n!=n)return!0}else for(;a>o;o++)if((t||o in s)&&s[o]===i)return t||o||0;return!t&&-1}},lt=g("keys"),dt=function(t){return lt[t]||(lt[t]=w(t))},_t=ut(!1),ft=dt("IE_PROTO"),mt=function(t,e){var i,r=z(t),n=0,s=[];for(i in r)i!=ft&&K(r,i)&&s.push(i);while(e.length>n)K(r,i=e[n++])&&(~_t(s,i)||s.push(i));return s},pt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),yt=Object.keys||function(t){return mt(t,pt)},gt=M?Object.defineProperties:function(t,e){O(t);var i,r=yt(e),n=r.length,s=0;while(n>s)I.f(t,i=r[s++],e[i]);return t},vt=y.document,bt=vt&&vt.documentElement,wt=dt("IE_PROTO"),kt=function(){},xt="prototype",Ot=function(){var t,e=j("iframe"),i=pt.length,r="<",n=">";e.style.display="none",bt.appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(r+"script"+n+"document.F=Object"+r+"/script"+n),t.close(),Ot=t.F;while(i--)delete Ot[xt][pt[i]];return Ot()},St=Object.create||function(t,e){var i;return null!==t?(kt[xt]=O(t),i=new kt,kt[xt]=null,i[wt]=t):i=Ot(),void 0===e?i:gt(i,e)},Mt=I.f,Dt=k("toStringTag"),Pt=function(t,e,i){t&&!K(t=i?t:t.prototype,Dt)&&Mt(t,Dt,{configurable:!0,value:e})},jt={};W(jt,k("iterator"),(function(){return this}));var Tt=function(t,e,i){t.prototype=St(jt,{next:A(1,i)}),Pt(t,e+" Iterator")},Ct=function(t){return Object(B(t))},Et=dt("IE_PROTO"),qt=Object.prototype,It=Object.getPrototypeOf||function(t){return t=Ct(t),K(t,Et)?t[Et]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?qt:null},At=k("iterator"),Wt=!([].keys&&"next"in[].keys()),Yt="@@iterator",Lt="keys",Rt="values",Nt=function(){return this},Ut=function(t,e,i,r,n,s,a){Tt(i,e,r);var o,c,h,u=function(t){if(!Wt&&t in f)return f[t];switch(t){case Lt:return function(){return new i(this,t)};case Rt:return function(){return new i(this,t)}}return function(){return new i(this,t)}},l=e+" Iterator",d=n==Rt,_=!1,f=t.prototype,m=f[At]||f[Yt]||n&&f[n],p=m||u(n),y=n?d?u("entries"):p:void 0,g="Array"==e&&f.entries||m;if(g&&(h=It(g.call(new t)),h!==Object.prototype&&h.next&&(Pt(h,l,!0),"function"!=typeof h[At]&&W(h,At,Nt))),d&&m&&m.name!==Rt&&(_=!0,p=function(){return m.call(this)}),(Wt||_||!f[At])&&W(f,At,p),U[e]=p,U[l]=Nt,n)if(o={values:d?p:u(Rt),keys:s?p:u(Lt),entries:y},a)for(c in o)c in f||Q(f,c,o[c]);else et(et.P+et.F*(Wt||_),e,o);return o},Gt=Ut(Array,"Array",(function(t,e){this._t=z(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,N(1)):N(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])}),"values");U.Arguments=U.Array,R("keys"),R("values"),R("entries");for(var Ht=k("iterator"),Ft=k("toStringTag"),Bt=U.Array,zt={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},$t=yt(zt),Kt=0;Kt<$t.length;Kt++){var Vt,Qt=$t[Kt],Zt=zt[Qt],Jt=y[Qt],Xt=Jt&&Jt.prototype;if(Xt&&(Xt[Ht]||W(Xt,Ht,Bt),Xt[Ft]||W(Xt,Ft,Qt),U[Qt]=Bt,Zt))for(Vt in Gt)Xt[Vt]||Q(Xt,Vt,Gt[Vt],!0)}function te(t,e){return ee(t)||ie(t,e)||re()}function ee(t){if(Array.isArray(t))return t}function ie(t,e){var i=[],r=!0,n=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(r=(a=o.next()).done);r=!0)if(i.push(a.value),e&&i.length===e)break}catch(c){n=!0,s=c}finally{try{r||null==o["return"]||o["return"]()}finally{if(n)throw s}}return i}function re(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var ne=m((function(t){var e=Object.prototype.hasOwnProperty,i="~";function r(){}function n(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(t,e,r,s,a){if("function"!==typeof r)throw new TypeError("The listener must be a function");var o=new n(r,s||t,a),c=i?i+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],o]:t._events[c].push(o):(t._events[c]=o,t._eventsCount++),t}function a(t,e){0===--t._eventsCount?t._events=new r:delete t._events[e]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1)),o.prototype.eventNames=function(){var t,r,n=[];if(0===this._eventsCount)return n;for(r in t=this._events)e.call(t,r)&&n.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},o.prototype.listeners=function(t){var e=i?i+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,a=new Array(s);n<s;n++)a[n]=r[n].fn;return a},o.prototype.listenerCount=function(t){var e=i?i+t:t,r=this._events[e];return r?r.fn?1:r.length:0},o.prototype.emit=function(t,e,r,n,s,a){var o=i?i+t:t;if(!this._events[o])return!1;var c,h,u=this._events[o],l=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,n),!0;case 5:return u.fn.call(u.context,e,r,n,s),!0;case 6:return u.fn.call(u.context,e,r,n,s,a),!0}for(h=1,c=new Array(l-1);h<l;h++)c[h-1]=arguments[h];u.fn.apply(u.context,c)}else{var d,_=u.length;for(h=0;h<_;h++)switch(u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),l){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,e);break;case 3:u[h].fn.call(u[h].context,e,r);break;case 4:u[h].fn.call(u[h].context,e,r,n);break;default:if(!c)for(d=1,c=new Array(l-1);d<l;d++)c[d-1]=arguments[d];u[h].fn.apply(u[h].context,c)}}return!0},o.prototype.on=function(t,e,i){return s(this,t,e,i,!1)},o.prototype.once=function(t,e,i){return s(this,t,e,i,!0)},o.prototype.removeListener=function(t,e,r,n){var s=i?i+t:t;if(!this._events[s])return this;if(!e)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||n&&!o.once||r&&o.context!==r||a(this,s);else{for(var c=0,h=[],u=o.length;c<u;c++)(o[c].fn!==e||n&&!o[c].once||r&&o[c].context!==r)&&h.push(o[c]);h.length?this._events[s]=1===h.length?h[0]:h:a(this,s)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o})),se=Object(d["l"])(".%L"),ae=Object(d["l"])(":%S"),oe=Object(d["l"])("%H:%M"),ce=Object(d["l"])("%H:%M"),he=Object(d["l"])("%m%d"),ue=Object(d["l"])("%m%d"),le=Object(d["l"])("%y");function de(t){return(Object(d["p"])(t)<t?se:Object(d["n"])(t)<t?ae:Object(d["m"])(t)<t?oe:Object(d["k"])(t)<t?ce:Object(d["o"])(t)<t?he:Object(d["q"])(t)<t?ue:le)(t)}var _e=function(){function t(e){Object(h["a"])(this,t),this.chart=e,this.xScale=Object(d["i"])(),this.xAxis=Object(d["a"])().scale(this.xScale),this._init()}return Object(u["a"])(t,[{key:"_init",value:function(){this.rootG=this.chart.rootG.append("g").attr("class","x axis"),this.resetPosition()}},{key:"resetPosition",value:function(){this.rootG.attr("transform","translate("+Math.floor(this.chart.bar.barWidth/2)+","+(this.chart.innerHeight+1)+")"),this.xScale.rangeRound([0,this.chart.bar.barNumbers*this.chart.bar.barWidth-this.chart.bar.barWidth])}},{key:"draw",value:function(t,e,i){this.xScale.domain([t,e]),this.xAxis.tickFormat((function(t,e){return i[t]&&i[t].datetime?de(i[t].datetime/1e6):""})),this.rootG.call(this.xAxis)}}]),t}();function fe(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=Number(t),r=Number.isInteger(e)?e:2;return Number.isFinite(i)?i.toFixed(r):t}var me=function(){function t(e){Object(h["a"])(this,t),this.tqchart=e,this.svgG=this.tqchart.svg.append("g").attr("class","crosshair-container").attr("visibility","hidden"),this.rootG=this.svgG.append("g").attr("class","crosshair-content").attr("transform","translate("+this.tqchart.margin.left+","+this.tqchart.margin.top+")"),this.rectG=this.rootG.append("rect").attr("class","crosshair-cursor").attr("width",this.tqchart.innerWidth).attr("height",this.tqchart.innerHeight),this.klinePanel=this.svgG.append("g").attr("class","kline panel"),this.klinePanelWidth=100,this.klinePanelHeight=144,this.klinePanelDefaultColor="#333333",this.klinePanel.append("rect").attr("x",.5).attr("y",.5).attr("width",this.klinePanelWidth).attr("height",this.klinePanelHeight).attr("stroke","#DDDDDD"),this.klinePanel.append("text").attr("x",0).attr("y",0),this._initCrosshairline(),this._initAxisannotation()}return Object(u["a"])(t,[{key:"_initCrosshairline",value:function(){this.rootG.append("g").attr("class","crosshair horizontal").append("line").attr("x1",0).attr("y1",0).attr("x2",this.tqchart.innerWidth).attr("y2",0).attr("stroke","#aaaaaa").attr("stroke-dasharray","2"),this.rootG.append("g").attr("class","crosshair vertical").append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",this.tqchart.innerHeight).attr("stroke","#aaaaaa").attr("stroke-dasharray","2")}},{key:"_initAxisannotation",value:function(){this.rootG.append("g").attr("class","axisannotation x").attr("transform","translate(0,"+(this.tqchart.innerHeight+2)+")"),this.rootG.append("g").attr("class","axisannotation y left").attr("transform","translate(-"+(this.tqchart.margin.left-1)+",0)"),this.rootG.append("g").attr("class","axisannotation y right").attr("transform","translate("+(this.tqchart.innerWidth+1)+",0)"),this.rootG.select("g.axisannotation.x").append("rect").style("fill","#eeeeee").attr("opacity","0.8").attr("width","120px").attr("height","14px"),this.rootG.select("g.axisannotation.x").append("text").attr("x",1).attr("y",12),this.rootG.select("g.axisannotation.y.left").append("rect").style("fill","#FAFAFA").attr("opacity","0.9").attr("width",this.tqchart.margin.left-2).attr("height","16px"),this.rootG.select("g.axisannotation.y.left").append("text").attr("x",this.tqchart.margin.left-2).attr("y",13).attr("text-anchor","end"),this.rootG.select("g.axisannotation.y.right").append("rect").style("fill","#FAFAFA").attr("opacity","0.9").attr("width",this.tqchart.margin.right-2).attr("height","16px"),this.rootG.select("g.axisannotation.y.right").append("text").attr("x",2).attr("y",13)}},{key:"resize",value:function(){this.rectG.attr("width",this.tqchart.innerWidth).attr("height",this.tqchart.innerHeight),this.rootG.select("g.crosshair.horizontal line").attr("x2",this.tqchart.innerWidth),this.rootG.select("g.crosshair.vertical line").attr("y2",this.tqchart.innerHeight),this.rootG.select("g.axisannotation.x").attr("transform","translate(0,"+this.tqchart.innerHeight+")"),this.rootG.select("g.axisannotation.y.right").attr("transform","translate("+(this.tqchart.innerWidth+1)+",0)")}},{key:"update",value:function(t,e){var i=Math.floor(t/this.tqchart.bar.barWidth),r=i*this.tqchart.bar.barWidth+this.tqchart.bar.barWidth/2;this.rootG.select("g.crosshair.horizontal line").attr("y1",e+.5).attr("y2",e+.5),this.rootG.select("g.crosshair.vertical line").attr("x1",r).attr("x2",r);var n=this.tqchart.mainSeries;if(n&&n.last_id>-1&&n.data&&this.tqchart.range.leftId>-1){var s=this.tqchart.range.leftId+i,a=n.data[s],o=n.data[s-1];if(!a)return;this._updateKlinePanel(r,a,o),this._updateXAxisannotation(r,a.datetime);var c=this.tqchart.getBoardByYPosition(e);c&&this._updateYAxisannotation(e,c)}}},{key:"_updateKlinePanel",value:function(t,e,i){var r=this,n=[Object(d["l"])("%Y-%m-%d (%w)")(e.datetime/1e6),Object(d["l"])("%H:%M:%S")(e.datetime/1e6),"开盘",fe(e.open,this.tqchart.price_decs),"最高",fe(e.high,this.tqchart.price_decs),"最低",fe(e.low,this.tqchart.price_decs),"收盘",fe(e.close,this.tqchart.price_decs),"成交量",e.volume,"持仓量",e.close_oi],s=null;i&&i.close&&(s=fe(e.close-i.close,this.tqchart.price_decs),n.push("涨跌"),n.push(s),n.push("涨跌幅"),n.push(fe(s/i.close*100,2)+"%"));var a=this.klinePanel.select("text").selectAll("tspan").data(n);a.enter().append("tspan").merge(a).attr("x",(function(t,e){return e>1&&e%2===1?r.klinePanelWidth-1:1})).attr("dy",(function(t,e){return e>1&&e%2===1?"0px":"14px"})).attr("text-anchor",(function(t,e){return e>1&&e%2===1?"end":"start"})).attr("class",(function(t,e){if(15===e||17===e){if(s>0)return"up";if(s<0)return"down"}return""})).text((function(t){return t})).exit().remove();var o=2;t<this.klinePanelWidth-this.tqchart.margin.left&&(o=this.tqchart.outerWidth-2-this.klinePanelWidth),this.klinePanel.attr("transform","translate("+o+",0)")}},{key:"_updateXAxisannotation",value:function(t,e){this.rootG.select("g.axisannotation.x rect").attr("x",t-40),this.rootG.select("g.axisannotation.x text").text(Object(d["l"])("%Y-%m-%d %H:%M:%S")(e/1e6)).attr("x",t-38)}},{key:"_updateYAxisannotation",value:function(t,e){for(var i=0,r=["left","right"];i<r.length;i++){var n=r[i],s=e[n+"YAxis"],a=["g","axisannotation","y",n].join(".");if(s){var o=fe(s.yScale.invert(t-e.top),"main"===e.boardId&&"right"===n&&this.tqchart.price_decs?this.tqchart.price_decs:0);if(!Number.isNaN(o)){this.rootG.select(a).attr("visibility","visible"),this.rootG.select(a+" rect").attr("y",t-10),this.rootG.select(a+" text").text(o).attr("y",t+2);continue}}this.rootG.select("g.axisannotation.y.left").attr("visibility","hidden")}}},{key:"show",value:function(){this.svgG.attr("visibility","visible")}},{key:"hide",value:function(){this.svgG.attr("visibility","hidden"),this.rootG.selectAll("g.axisannotation.y").attr("visibility","hidden")}},{key:"drag",value:function(t){t?this.rectG.attr("class","crosshair-cursor drag"):this.rectG.attr("class","crosshair-cursor")}}]),t}(),pe=function(){function t(e,i){Object(h["a"])(this,t),this.board=e,this.align=i,this.yScale=Object(d["i"])().range([this.board.height,0]),this.yAxis="left"===i?Object(d["b"])():Object(d["c"])(),this.yAxis.scale(this.yScale),this._init()}return Object(u["a"])(t,[{key:"_init",value:function(){this.rootG=this.board.rootG.append("g").attr("class","y axis "+this.align),this.resetPosition()}},{key:"resetPosition",value:function(){this.yScale.range([this.board.height,0]),"right"===this.align&&this.rootG.attr("transform","translate("+this.board.width+",0)")}},{key:"getTicks",value:function(){var t=[],e=this;return this.rootG.selectAll(".tick").each((function(i){t.push(Math.round(e.yScale(i)))})),t}},{key:"draw",value:function(t){this.yScale.domain(t),this.yAxis.ticks("main"===this.board.boardId?6:3),this.rootG.call(this.yAxis)}}]),t}(),ye=function(){function t(e,i){Object(h["a"])(this,t);var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vertical",n=arguments.length>3?arguments[3]:void 0;this.tqchart=e,this.parentSvg=i,this.board=n,this.rootG=this.parentSvg.append("g").attr("class","background"),this.direction=r,"horizontal"===this.direction&&this.rootG.append("line").attr("class","border").attr("x1",-this.tqchart.margin.left).attr("y1",-.5).attr("x2",this.tqchart.innerWidth+this.tqchart.margin.right).attr("y2",-.5)}return Object(u["a"])(t,[{key:"clear",value:function(){this.rootG.selectAll("line").remove()}},{key:"draw",value:function(){if("vertical"===this.direction){var t=this.tqchart.xAxis.getTicks();this._drawVerticalLines(t)}else if("horizontal"===this.direction){var e=this.board.rightYAxis.getTicks();this._drawHorizontalLines(e)}}},{key:"resize",value:function(){"vertical"===this.direction?this.rootG.selectAll("line").attr("y2",this.tqchart.innerHeight):"horizontal"===this.direction&&this.rootG.selectAll("line").attr("x2",this.tqchart.innerWidth)}},{key:"_drawVerticalLines",value:function(t){var e=this.tqchart.innerHeight,i=this.rootG.selectAll("line.bgline").data(t);i.enter().append("line").attr("class","bgline").attr("y1",0).attr("y2",e).merge(i).attr("x1",(function(t){return t})).attr("x2",(function(t){return t})),i.exit().remove()}},{key:"_drawHorizontalLines",value:function(t){var e=this.tqchart.innerWidth,i=this.rootG.selectAll("line.bgline").data(t);i.enter().append("line").attr("class","bgline").attr("x1",0).attr("x2",e).merge(i).attr("y1",(function(t){return t+.5})).attr("y2",(function(t){return t+.5})),i.exit().remove()}}]),t}(),ge=2,ve=function(){function t(e,i,r,n,s){Object(h["a"])(this,t),this.tqchart=e,this.boardId=i,this.top=r,this.height=n,this.width=this.tqchart.innerWidth,this.rootG=this.tqchart.rootG.append("g").attr("class",this.boardId).attr("transform","translate(0,"+this.top+")"),this.background=new ye(this.tqchart,this.rootG,"horizontal",this),this.plotG=this.rootG.append("g").attr("class",this.boardId+" plots"),this.maskG=this.rootG.append("mask").attr("id","mask-"+this.boardId).append("rect").attr("x","0").attr("y","0").attr("width",this.width).attr("height",this.height).style("fill","#FFFFFF").attr("stroke","none"),this.markG=this.rootG.append("g").attr("mask","url(#mask-"+this.boardId+")").attr("class",this.boardId+" marks"),this.leftYAxis=new pe(this,"left"),this.rightYAxis=new pe(this,"right")}return Object(u["a"])(t,[{key:"resetPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.top,i=void 0===e?this.top:e,r=t.height,n=void 0===r?this.height:r;this.top=i,this.rootG.attr("transform","translate(0,"+this.top+")"),this.height=n,this.width=this.tqchart.innerWidth,this.maskG.attr("width",this.width).attr("height",this.height),this.background.resize(),this.leftYAxis&&this.leftYAxis.resetPosition(),this.rightYAxis.resetPosition()}},{key:"setDomain",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right";this[e+"Domain"]=t}},{key:"draw",value:function(t,e,i){this.leftYAxis.draw(this.leftDomain),this.rightYAxis.draw(this.rightDomain),this.background.draw()}},{key:"remove",value:function(){this.rootG.remove()}}],[{key:"GetMutilPlotsHeight",value:function(t,e){for(var i=e-ge*(t-1),r=1/t,n=Math.ceil(i*r*.7),s=i-n*(t-1),a=[{top:0,height:s}],o=1;o<t;o++)a[o]={height:n,top:a[o-1].top+a[o-1].height+ge};return a}}]),t}(),be=k("match"),we=function(t){var e;return x(t)&&(void 0!==(e=t[be])?!!e:"RegExp"==H(t))},ke=k("species"),xe=function(t,e){var i,r=O(t).constructor;return void 0===r||void 0==(i=O(r)[ke])?e:Z(i)},Oe=function(t){return function(e,i){var r,n,s=String(B(e)),a=nt(i),o=s.length;return a<0||a>=o?t?"":void 0:(r=s.charCodeAt(a),r<55296||r>56319||a+1===o||(n=s.charCodeAt(a+1))<56320||n>57343?t?s.charAt(a):r:t?s.slice(a,a+2):n-56320+(r-55296<<10)+65536)}},Se=Oe(!0),Me=function(t,e,i){return e+(i?Se(t,e).length:1)},De=k("toStringTag"),Pe="Arguments"==H(function(){return arguments}()),je=function(t,e){try{return t[e]}catch(i){}},Te=function(t){var e,i,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=je(e=Object(t),De))?i:Pe?H(e):"Object"==(r=H(e))&&"function"==typeof e.callee?"Arguments":r},Ce=RegExp.prototype.exec,Ee=function(t,e){var i=t.exec;if("function"===typeof i){var r=i.call(t,e);if("object"!==Object(l["a"])(r))throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==Te(t))throw new TypeError("RegExp#exec called on incompatible receiver");return Ce.call(t,e)},qe=function(){var t=O(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e},Ie=RegExp.prototype.exec,Ae=String.prototype.replace,We=Ie,Ye="lastIndex",Le=function(){var t=/a/,e=/b*/g;return Ie.call(t,"a"),Ie.call(e,"a"),0!==t[Ye]||0!==e[Ye]}(),Re=void 0!==/()??/.exec("")[1],Ne=Le||Re;Ne&&(We=function(t){var e,i,r,n,s=this;return Re&&(i=new RegExp("^"+s.source+"$(?!\\s)",qe.call(s))),Le&&(e=s[Ye]),r=Ie.call(s,t),Le&&r&&(s[Ye]=s.global?r.index+r[0].length:e),Re&&r&&r.length>1&&Ae.call(r[0],i,(function(){for(n=1;n<arguments.length-2;n++)void 0===arguments[n]&&(r[n]=void 0)})),r});var Ue=We;et({target:"RegExp",proto:!0,forced:Ue!==/./.exec},{exec:Ue});var Ge=k("species"),He=!S((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),Fe=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var i="ab".split(t);return 2===i.length&&"a"===i[0]&&"b"===i[1]}(),Be=function(t,e,i){var r=k(t),n=!S((function(){var e={};return e[r]=function(){return 7},7!=""[t](e)})),s=n?!S((function(){var e=!1,i=/a/;return i.exec=function(){return e=!0,null},"split"===t&&(i.constructor={},i.constructor[Ge]=function(){return i}),i[r](""),!e})):void 0;if(!n||!s||"replace"===t&&!He||"split"===t&&!Fe){var a=/./[r],o=i(B,r,""[t],(function(t,e,i,r,s){return e.exec===Ue?n&&!s?{done:!0,value:a.call(e,i,r)}:{done:!0,value:t.call(i,e,r)}:{done:!1}})),c=o[0],h=o[1];Q(String.prototype,t,c),W(RegExp.prototype,r,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)})}},ze=Math.min,$e=[].push,Ke="split",Ve="length",Qe="lastIndex",Ze=4294967295,Je=!S((function(){RegExp(Ze,"y")}));Be("split",2,(function(t,e,i,r){var n;return n="c"=="abbc"[Ke](/(b)*/)[1]||4!="test"[Ke](/(?:)/,-1)[Ve]||2!="ab"[Ke](/(?:ab)*/)[Ve]||4!="."[Ke](/(.?)(.?)/)[Ve]||"."[Ke](/()()/)[Ve]>1||""[Ke](/.?/)[Ve]?function(t,e){var r=String(this);if(void 0===t&&0===e)return[];if(!we(t))return i.call(r,t,e);var n,s,a,o=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,u=void 0===e?Ze:e>>>0,l=new RegExp(t.source,c+"g");while(n=Ue.call(l,r)){if(s=l[Qe],s>h&&(o.push(r.slice(h,n.index)),n[Ve]>1&&n.index<r[Ve]&&$e.apply(o,n.slice(1)),a=n[0][Ve],h=s,o[Ve]>=u))break;l[Qe]===n.index&&l[Qe]++}return h===r[Ve]?!a&&l.test("")||o.push(""):o.push(r.slice(h)),o[Ve]>u?o.slice(0,u):o}:"0"[Ke](void 0,0)[Ve]?function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)}:i,[function(i,r){var s=t(this),a=void 0==i?void 0:i[e];return void 0!==a?a.call(i,s,r):n.call(String(s),i,r)},function(t,e){var s=r(n,t,this,e,n!==i);if(s.done)return s.value;var a=O(t),o=String(this),c=xe(a,RegExp),h=a.unicode,u=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Je?"y":"g"),l=new c(Je?a:"^(?:"+a.source+")",u),d=void 0===e?Ze:e>>>0;if(0===d)return[];if(0===o.length)return null===Ee(l,o)?[o]:[];var _=0,f=0,m=[];while(f<o.length){l.lastIndex=Je?f:0;var p,y=Ee(l,Je?o:o.slice(f));if(null===y||(p=ze(at(l.lastIndex+(Je?0:f)),o.length))===_)f=Me(o,f,h);else{if(m.push(o.slice(_,f)),m.length===d)return m;for(var g=1;g<=y.length-1;g++)if(m.push(y[g]),m.length===d)return m;f=_=p}}return m.push(o.slice(_)),m}]}));var Xe=Math.max,ti=Math.min,ei=Math.floor,ii=/\$([$&`']|\d\d?|<[^>]*>)/g,ri=/\$([$&`']|\d\d?)/g,ni=function(t){return void 0===t?t:String(t)};Be("replace",2,(function(t,e,i,r){return[function(r,n){var s=t(this),a=void 0==r?void 0:r[e];return void 0!==a?a.call(r,s,n):i.call(String(s),r,n)},function(t,e){var s=r(i,t,this,e);if(s.done)return s.value;var a=O(t),o=String(this),c="function"===typeof e;c||(e=String(e));var h=a.global;if(h){var u=a.unicode;a.lastIndex=0}var l=[];while(1){var d=Ee(a,o);if(null===d)break;if(l.push(d),!h)break;var _=String(d[0]);""===_&&(a.lastIndex=Me(o,at(a.lastIndex),u))}for(var f="",m=0,p=0;p<l.length;p++){d=l[p];for(var y=String(d[0]),g=Xe(ti(nt(d.index),o.length),0),v=[],b=1;b<d.length;b++)v.push(ni(d[b]));var w=d.groups;if(c){var k=[y].concat(v,g,o);void 0!==w&&k.push(w);var x=String(e.apply(void 0,k))}else x=n(y,o,g,v,w,e);g>=m&&(f+=o.slice(m,g)+x,m=g+y.length)}return f+o.slice(m)}];function n(t,e,r,n,s,a){var o=r+t.length,c=n.length,h=ri;return void 0!==s&&(s=Ct(s),h=ii),i.call(a,h,(function(i,a){var h;switch(a.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(o);case"<":h=s[a.slice(1,-1)];break;default:var u=+a;if(0===u)return i;if(u>c){var l=ei(u/10);return 0===l?i:l<=c?void 0===n[l-1]?a.charAt(1):n[l-1]+a.charAt(1):i}h=n[u-1]}return void 0===h?"":h}))}})),M&&"g"!=/./g.flags&&I.f(RegExp.prototype,"flags",{configurable:!0,get:qe});var si="toString",ai=/./[si],oi=function(t){Q(RegExp.prototype,si,t,!0)};S((function(){return"/a/b"!=ai.call({source:"a",flags:"b"})}))?oi((function(){var t=O(this);return"/".concat(t.source,"/","flags"in t?t.flags:!M&&t instanceof RegExp?qe.call(t):void 0)})):ai.name!=si&&oi((function(){return ai.call(this)}));var ci=m((function(t,e){(function(e,i){t.exports=i()})(0,(function(){var e,i;function r(){return e.apply(null,arguments)}function n(t){e=t}function s(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function a(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function o(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(t.hasOwnProperty(e))return!1;return!0}function c(t){return void 0===t}function h(t){return"number"===typeof t||"[object Number]"===Object.prototype.toString.call(t)}function u(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function d(t,e){var i,r=[];for(i=0;i<t.length;++i)r.push(e(t[i],i));return r}function _(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function m(t,e){for(var i in e)_(e,i)&&(t[i]=e[i]);return _(e,"toString")&&(t.toString=e.toString),_(e,"valueOf")&&(t.valueOf=e.valueOf),t}function p(t,e,i,r){return Ki(t,e,i,r,!0).utc()}function y(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function g(t){return null==t._pf&&(t._pf=y()),t._pf}function v(t){if(null==t._isValid){var e=g(t),r=i.call(e.parsedDateParts,(function(t){return null!=t})),n=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r);if(t._strict&&(n=n&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return n;t._isValid=n}return t._isValid}function b(t){var e=p(NaN);return null!=t?m(g(e),t):g(e).userInvalidated=!0,e}i=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),i=e.length>>>0,r=0;r<i;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};var w=r.momentProperties=[];function k(t,e){var i,r,n;if(c(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),c(e._i)||(t._i=e._i),c(e._f)||(t._f=e._f),c(e._l)||(t._l=e._l),c(e._strict)||(t._strict=e._strict),c(e._tzm)||(t._tzm=e._tzm),c(e._isUTC)||(t._isUTC=e._isUTC),c(e._offset)||(t._offset=e._offset),c(e._pf)||(t._pf=g(e)),c(e._locale)||(t._locale=e._locale),w.length>0)for(i=0;i<w.length;i++)r=w[i],n=e[r],c(n)||(t[r]=n);return t}var x=!1;function O(t){k(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===x&&(x=!0,r.updateOffset(this),x=!1)}function S(t){return t instanceof O||null!=t&&null!=t._isAMomentObject}function M(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function D(t){var e=+t,i=0;return 0!==e&&isFinite(e)&&(i=M(e)),i}function P(t,e,i){var r,n=Math.min(t.length,e.length),s=Math.abs(t.length-e.length),a=0;for(r=0;r<n;r++)(i&&t[r]!==e[r]||!i&&D(t[r])!==D(e[r]))&&a++;return a+s}function j(t){!1===r.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function T(t,e){var i=!0;return m((function(){if(null!=r.deprecationHandler&&r.deprecationHandler(null,t),i){for(var n,s=[],a=0;a<arguments.length;a++){if(n="","object"===Object(l["a"])(arguments[a])){for(var o in n+="\n["+a+"] ",arguments[0])n+=o+": "+arguments[0][o]+", ";n=n.slice(0,-2)}else n=arguments[a];s.push(n)}j(t+"\nArguments: "+Array.prototype.slice.call(s).join("")+"\n"+(new Error).stack),i=!1}return e.apply(this,arguments)}),e)}var C,E={};function q(t,e){null!=r.deprecationHandler&&r.deprecationHandler(t,e),E[t]||(j(e),E[t]=!0)}function I(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function A(t){var e,i;for(i in t)e=t[i],I(e)?this[i]=e:this["_"+i]=e;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function W(t,e){var i,r=m({},t);for(i in e)_(e,i)&&(a(t[i])&&a(e[i])?(r[i]={},m(r[i],t[i]),m(r[i],e[i])):null!=e[i]?r[i]=e[i]:delete r[i]);for(i in t)_(t,i)&&!_(e,i)&&a(t[i])&&(r[i]=m({},r[i]));return r}function Y(t){null!=t&&this.set(t)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null,C=Object.keys?Object.keys:function(t){var e,i=[];for(e in t)_(t,e)&&i.push(e);return i};var L={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function R(t,e,i){var r=this._calendar[t]||this._calendar["sameElse"];return I(r)?r.call(e,i):r}var N={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function U(t){var e=this._longDateFormat[t],i=this._longDateFormat[t.toUpperCase()];return e||!i?e:(this._longDateFormat[t]=i.replace(/MMMM|MM|DD|dddd/g,(function(t){return t.slice(1)})),this._longDateFormat[t])}var G="Invalid date";function H(){return this._invalidDate}var F="%d",B=/\d{1,2}/;function z(t){return this._ordinal.replace("%d",t)}var $={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function K(t,e,i,r){var n=this._relativeTime[i];return I(n)?n(t,e,i,r):n.replace(/%d/i,t)}function V(t,e){var i=this._relativeTime[t>0?"future":"past"];return I(i)?i(e):i.replace(/%s/i,e)}var Q={};function Z(t,e){var i=t.toLowerCase();Q[i]=Q[i+"s"]=Q[e]=t}function J(t){return"string"===typeof t?Q[t]||Q[t.toLowerCase()]:void 0}function X(t){var e,i,r={};for(i in t)_(t,i)&&(e=J(i),e&&(r[e]=t[i]));return r}var tt={};function et(t,e){tt[t]=e}function it(t){var e=[];for(var i in t)e.push({unit:i,priority:tt[i]});return e.sort((function(t,e){return t.priority-e.priority})),e}function rt(t,e,i){var r=""+Math.abs(t),n=e-r.length,s=t>=0;return(s?i?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+r}var nt=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,st=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,at={},ot={};function ct(t,e,i,r){var n=r;"string"===typeof r&&(n=function(){return this[r]()}),t&&(ot[t]=n),e&&(ot[e[0]]=function(){return rt(n.apply(this,arguments),e[1],e[2])}),i&&(ot[i]=function(){return this.localeData().ordinal(n.apply(this,arguments),t)})}function ht(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function ut(t){var e,i,r=t.match(nt);for(e=0,i=r.length;e<i;e++)ot[r[e]]?r[e]=ot[r[e]]:r[e]=ht(r[e]);return function(e){var n,s="";for(n=0;n<i;n++)s+=I(r[n])?r[n].call(e,t):r[n];return s}}function lt(t,e){return t.isValid()?(e=dt(e,t.localeData()),at[e]=at[e]||ut(e),at[e](t)):t.localeData().invalidDate()}function dt(t,e){var i=5;function r(t){return e.longDateFormat(t)||t}st.lastIndex=0;while(i>=0&&st.test(t))t=t.replace(st,r),st.lastIndex=0,i-=1;return t}var _t=/\d/,ft=/\d\d/,mt=/\d{3}/,pt=/\d{4}/,yt=/[+-]?\d{6}/,gt=/\d\d?/,vt=/\d\d\d\d?/,bt=/\d\d\d\d\d\d?/,wt=/\d{1,3}/,kt=/\d{1,4}/,xt=/[+-]?\d{1,6}/,Ot=/\d+/,St=/[+-]?\d+/,Mt=/Z|[+-]\d\d:?\d\d/gi,Dt=/Z|[+-]\d\d(?::?\d\d)?/gi,Pt=/[+-]?\d+(\.\d{1,3})?/,jt=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Tt={};function Ct(t,e,i){Tt[t]=I(e)?e:function(t,r){return t&&i?i:e}}function Et(t,e){return _(Tt,t)?Tt[t](e._strict,e._locale):new RegExp(qt(t))}function qt(t){return It(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(t,e,i,r,n){return e||i||r||n})))}function It(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var At={};function Wt(t,e){var i,r=e;for("string"===typeof t&&(t=[t]),h(e)&&(r=function(t,i){i[e]=D(t)}),i=0;i<t.length;i++)At[t[i]]=r}function Yt(t,e){Wt(t,(function(t,i,r,n){r._w=r._w||{},e(t,r._w,r,n)}))}function Lt(t,e,i){null!=e&&_(At,t)&&At[t](e,i._a,i,t)}var Rt=0,Nt=1,Ut=2,Gt=3,Ht=4,Ft=5,Bt=6,zt=7,$t=8;function Kt(t){return Vt(t)?366:365}function Vt(t){return t%4===0&&t%100!==0||t%400===0}ct("Y",0,0,(function(){var t=this.year();return t<=9999?""+t:"+"+t})),ct(0,["YY",2],0,(function(){return this.year()%100})),ct(0,["YYYY",4],0,"year"),ct(0,["YYYYY",5],0,"year"),ct(0,["YYYYYY",6,!0],0,"year"),Z("year","y"),et("year",1),Ct("Y",St),Ct("YY",gt,ft),Ct("YYYY",kt,pt),Ct("YYYYY",xt,yt),Ct("YYYYYY",xt,yt),Wt(["YYYYY","YYYYYY"],Rt),Wt("YYYY",(function(t,e){e[Rt]=2===t.length?r.parseTwoDigitYear(t):D(t)})),Wt("YY",(function(t,e){e[Rt]=r.parseTwoDigitYear(t)})),Wt("Y",(function(t,e){e[Rt]=parseInt(t,10)})),r.parseTwoDigitYear=function(t){return D(t)+(D(t)>68?1900:2e3)};var Qt,Zt=Xt("FullYear",!0);function Jt(){return Vt(this.year())}function Xt(t,e){return function(i){return null!=i?(ee(this,t,i),r.updateOffset(this,e),this):te(this,t)}}function te(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function ee(t,e,i){t.isValid()&&!isNaN(i)&&("FullYear"===e&&Vt(t.year())&&1===t.month()&&29===t.date()?t._d["set"+(t._isUTC?"UTC":"")+e](i,t.month(),se(i,t.month())):t._d["set"+(t._isUTC?"UTC":"")+e](i))}function ie(t){return t=J(t),I(this[t])?this[t]():this}function re(t,e){if("object"===Object(l["a"])(t)){t=X(t);for(var i=it(t),r=0;r<i.length;r++)this[i[r].unit](t[i[r].unit])}else if(t=J(t),I(this[t]))return this[t](e);return this}function ne(t,e){return(t%e+e)%e}function se(t,e){if(isNaN(t)||isNaN(e))return NaN;var i=ne(e,12);return t+=(e-i)/12,1===i?Vt(t)?29:28:31-i%7%2}Qt=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},ct("M",["MM",2],"Mo",(function(){return this.month()+1})),ct("MMM",0,0,(function(t){return this.localeData().monthsShort(this,t)})),ct("MMMM",0,0,(function(t){return this.localeData().months(this,t)})),Z("month","M"),et("month",8),Ct("M",gt),Ct("MM",gt,ft),Ct("MMM",(function(t,e){return e.monthsShortRegex(t)})),Ct("MMMM",(function(t,e){return e.monthsRegex(t)})),Wt(["M","MM"],(function(t,e){e[Nt]=D(t)-1})),Wt(["MMM","MMMM"],(function(t,e,i,r){var n=i._locale.monthsParse(t,r,i._strict);null!=n?e[Nt]=n:g(i).invalidMonth=t}));var ae=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,oe="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function ce(t,e){return t?s(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||ae).test(e)?"format":"standalone"][t.month()]:s(this._months)?this._months:this._months["standalone"]}var he="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function ue(t,e){return t?s(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[ae.test(e)?"format":"standalone"][t.month()]:s(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}function le(t,e,i){var r,n,s,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)s=p([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(s,"").toLocaleLowerCase();return i?"MMM"===e?(n=Qt.call(this._shortMonthsParse,a),-1!==n?n:null):(n=Qt.call(this._longMonthsParse,a),-1!==n?n:null):"MMM"===e?(n=Qt.call(this._shortMonthsParse,a),-1!==n?n:(n=Qt.call(this._longMonthsParse,a),-1!==n?n:null)):(n=Qt.call(this._longMonthsParse,a),-1!==n?n:(n=Qt.call(this._shortMonthsParse,a),-1!==n?n:null))}function de(t,e,i){var r,n,s;if(this._monthsParseExact)return le.call(this,t,e,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(n=p([2e3,r]),i&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),i||this._monthsParse[r]||(s="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i")),i&&"MMMM"===e&&this._longMonthsParse[r].test(t))return r;if(i&&"MMM"===e&&this._shortMonthsParse[r].test(t))return r;if(!i&&this._monthsParse[r].test(t))return r}}function _e(t,e){var i;if(!t.isValid())return t;if("string"===typeof e)if(/^\d+$/.test(e))e=D(e);else if(e=t.localeData().monthsParse(e),!h(e))return t;return i=Math.min(t.date(),se(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,i),t}function fe(t){return null!=t?(_e(this,t),r.updateOffset(this,!0),this):te(this,"Month")}function me(){return se(this.year(),this.month())}var pe=jt;function ye(t){return this._monthsParseExact?(_(this,"_monthsRegex")||be.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(_(this,"_monthsShortRegex")||(this._monthsShortRegex=pe),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}var ge=jt;function ve(t){return this._monthsParseExact?(_(this,"_monthsRegex")||be.call(this),t?this._monthsStrictRegex:this._monthsRegex):(_(this,"_monthsRegex")||(this._monthsRegex=ge),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function be(){function t(t,e){return e.length-t.length}var e,i,r=[],n=[],s=[];for(e=0;e<12;e++)i=p([2e3,e]),r.push(this.monthsShort(i,"")),n.push(this.months(i,"")),s.push(this.months(i,"")),s.push(this.monthsShort(i,""));for(r.sort(t),n.sort(t),s.sort(t),e=0;e<12;e++)r[e]=It(r[e]),n[e]=It(n[e]);for(e=0;e<24;e++)s[e]=It(s[e]);this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function we(t,e,i,r,n,s,a){var o;return t<100&&t>=0?(o=new Date(t+400,e,i,r,n,s,a),isFinite(o.getFullYear())&&o.setFullYear(t)):o=new Date(t,e,i,r,n,s,a),o}function ke(t){var e;if(t<100&&t>=0){var i=Array.prototype.slice.call(arguments);i[0]=t+400,e=new Date(Date.UTC.apply(null,i)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)}else e=new Date(Date.UTC.apply(null,arguments));return e}function xe(t,e,i){var r=7+e-i,n=(7+ke(t,0,r).getUTCDay()-e)%7;return-n+r-1}function Oe(t,e,i,r,n){var s,a,o=(7+i-r)%7,c=xe(t,r,n),h=1+7*(e-1)+o+c;return h<=0?(s=t-1,a=Kt(s)+h):h>Kt(t)?(s=t+1,a=h-Kt(t)):(s=t,a=h),{year:s,dayOfYear:a}}function Se(t,e,i){var r,n,s=xe(t.year(),e,i),a=Math.floor((t.dayOfYear()-s-1)/7)+1;return a<1?(n=t.year()-1,r=a+Me(n,e,i)):a>Me(t.year(),e,i)?(r=a-Me(t.year(),e,i),n=t.year()+1):(n=t.year(),r=a),{week:r,year:n}}function Me(t,e,i){var r=xe(t,e,i),n=xe(t+1,e,i);return(Kt(t)-r+n)/7}function De(t){return Se(t,this._week.dow,this._week.doy).week}ct("w",["ww",2],"wo","week"),ct("W",["WW",2],"Wo","isoWeek"),Z("week","w"),Z("isoWeek","W"),et("week",5),et("isoWeek",5),Ct("w",gt),Ct("ww",gt,ft),Ct("W",gt),Ct("WW",gt,ft),Yt(["w","ww","W","WW"],(function(t,e,i,r){e[r.substr(0,1)]=D(t)}));var Pe={dow:0,doy:6};function je(){return this._week.dow}function Te(){return this._week.doy}function Ce(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")}function Ee(t){var e=Se(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")}function qe(t,e){return"string"!==typeof t?t:isNaN(t)?(t=e.weekdaysParse(t),"number"===typeof t?t:null):parseInt(t,10)}function Ie(t,e){return"string"===typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Ae(t,e){return t.slice(e,7).concat(t.slice(0,e))}ct("d",0,"do","day"),ct("dd",0,0,(function(t){return this.localeData().weekdaysMin(this,t)})),ct("ddd",0,0,(function(t){return this.localeData().weekdaysShort(this,t)})),ct("dddd",0,0,(function(t){return this.localeData().weekdays(this,t)})),ct("e",0,0,"weekday"),ct("E",0,0,"isoWeekday"),Z("day","d"),Z("weekday","e"),Z("isoWeekday","E"),et("day",11),et("weekday",11),et("isoWeekday",11),Ct("d",gt),Ct("e",gt),Ct("E",gt),Ct("dd",(function(t,e){return e.weekdaysMinRegex(t)})),Ct("ddd",(function(t,e){return e.weekdaysShortRegex(t)})),Ct("dddd",(function(t,e){return e.weekdaysRegex(t)})),Yt(["dd","ddd","dddd"],(function(t,e,i,r){var n=i._locale.weekdaysParse(t,r,i._strict);null!=n?e.d=n:g(i).invalidWeekday=t})),Yt(["d","e","E"],(function(t,e,i,r){e[r]=D(t)}));var We="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function Ye(t,e){var i=s(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?Ae(i,this._week.dow):t?i[t.day()]:i}var Le="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function Re(t){return!0===t?Ae(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}var Ne="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Ue(t){return!0===t?Ae(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Ge(t,e,i){var r,n,s,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)s=p([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(s,"").toLocaleLowerCase();return i?"dddd"===e?(n=Qt.call(this._weekdaysParse,a),-1!==n?n:null):"ddd"===e?(n=Qt.call(this._shortWeekdaysParse,a),-1!==n?n:null):(n=Qt.call(this._minWeekdaysParse,a),-1!==n?n:null):"dddd"===e?(n=Qt.call(this._weekdaysParse,a),-1!==n?n:(n=Qt.call(this._shortWeekdaysParse,a),-1!==n?n:(n=Qt.call(this._minWeekdaysParse,a),-1!==n?n:null))):"ddd"===e?(n=Qt.call(this._shortWeekdaysParse,a),-1!==n?n:(n=Qt.call(this._weekdaysParse,a),-1!==n?n:(n=Qt.call(this._minWeekdaysParse,a),-1!==n?n:null))):(n=Qt.call(this._minWeekdaysParse,a),-1!==n?n:(n=Qt.call(this._weekdaysParse,a),-1!==n?n:(n=Qt.call(this._shortWeekdaysParse,a),-1!==n?n:null)))}function He(t,e,i){var r,n,s;if(this._weekdaysParseExact)return Ge.call(this,t,e,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(n=p([2e3,1]).day(r),i&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(s="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[r]=new RegExp(s.replace(".",""),"i")),i&&"dddd"===e&&this._fullWeekdaysParse[r].test(t))return r;if(i&&"ddd"===e&&this._shortWeekdaysParse[r].test(t))return r;if(i&&"dd"===e&&this._minWeekdaysParse[r].test(t))return r;if(!i&&this._weekdaysParse[r].test(t))return r}}function Fe(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=qe(t,this.localeData()),this.add(t-e,"d")):e}function Be(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")}function ze(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=Ie(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7}var $e=jt;function Ke(t){return this._weekdaysParseExact?(_(this,"_weekdaysRegex")||Xe.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(_(this,"_weekdaysRegex")||(this._weekdaysRegex=$e),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}var Ve=jt;function Qe(t){return this._weekdaysParseExact?(_(this,"_weekdaysRegex")||Xe.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(_(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ve),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}var Ze=jt;function Je(t){return this._weekdaysParseExact?(_(this,"_weekdaysRegex")||Xe.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(_(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ze),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Xe(){function t(t,e){return e.length-t.length}var e,i,r,n,s,a=[],o=[],c=[],h=[];for(e=0;e<7;e++)i=p([2e3,1]).day(e),r=this.weekdaysMin(i,""),n=this.weekdaysShort(i,""),s=this.weekdays(i,""),a.push(r),o.push(n),c.push(s),h.push(r),h.push(n),h.push(s);for(a.sort(t),o.sort(t),c.sort(t),h.sort(t),e=0;e<7;e++)o[e]=It(o[e]),c[e]=It(c[e]),h[e]=It(h[e]);this._weekdaysRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function ti(){return this.hours()%12||12}function ei(){return this.hours()||24}function ii(t,e){ct(t,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)}))}function ri(t,e){return e._meridiemParse}function ni(t){return"p"===(t+"").toLowerCase().charAt(0)}ct("H",["HH",2],0,"hour"),ct("h",["hh",2],0,ti),ct("k",["kk",2],0,ei),ct("hmm",0,0,(function(){return""+ti.apply(this)+rt(this.minutes(),2)})),ct("hmmss",0,0,(function(){return""+ti.apply(this)+rt(this.minutes(),2)+rt(this.seconds(),2)})),ct("Hmm",0,0,(function(){return""+this.hours()+rt(this.minutes(),2)})),ct("Hmmss",0,0,(function(){return""+this.hours()+rt(this.minutes(),2)+rt(this.seconds(),2)})),ii("a",!0),ii("A",!1),Z("hour","h"),et("hour",13),Ct("a",ri),Ct("A",ri),Ct("H",gt),Ct("h",gt),Ct("k",gt),Ct("HH",gt,ft),Ct("hh",gt,ft),Ct("kk",gt,ft),Ct("hmm",vt),Ct("hmmss",bt),Ct("Hmm",vt),Ct("Hmmss",bt),Wt(["H","HH"],Gt),Wt(["k","kk"],(function(t,e,i){var r=D(t);e[Gt]=24===r?0:r})),Wt(["a","A"],(function(t,e,i){i._isPm=i._locale.isPM(t),i._meridiem=t})),Wt(["h","hh"],(function(t,e,i){e[Gt]=D(t),g(i).bigHour=!0})),Wt("hmm",(function(t,e,i){var r=t.length-2;e[Gt]=D(t.substr(0,r)),e[Ht]=D(t.substr(r)),g(i).bigHour=!0})),Wt("hmmss",(function(t,e,i){var r=t.length-4,n=t.length-2;e[Gt]=D(t.substr(0,r)),e[Ht]=D(t.substr(r,2)),e[Ft]=D(t.substr(n)),g(i).bigHour=!0})),Wt("Hmm",(function(t,e,i){var r=t.length-2;e[Gt]=D(t.substr(0,r)),e[Ht]=D(t.substr(r))})),Wt("Hmmss",(function(t,e,i){var r=t.length-4,n=t.length-2;e[Gt]=D(t.substr(0,r)),e[Ht]=D(t.substr(r,2)),e[Ft]=D(t.substr(n))}));var si=/[ap]\.?m?\.?/i;function ai(t,e,i){return t>11?i?"pm":"PM":i?"am":"AM"}var oi,ci=Xt("Hours",!0),hi={calendar:L,longDateFormat:N,invalidDate:G,ordinal:F,dayOfMonthOrdinalParse:B,relativeTime:$,months:oe,monthsShort:he,week:Pe,weekdays:We,weekdaysMin:Ne,weekdaysShort:Le,meridiemParse:si},ui={},li={};function di(t){return t?t.toLowerCase().replace("_","-"):t}function _i(t){var e,i,r,n,s=0;while(s<t.length){n=di(t[s]).split("-"),e=n.length,i=di(t[s+1]),i=i?i.split("-"):null;while(e>0){if(r=fi(n.slice(0,e).join("-")),r)return r;if(i&&i.length>=e&&P(n,i,!0)>=e-1)break;e--}s++}return oi}function fi(e){var i=null;if(!ui[e]&&t&&t.exports)try{i=oi._abbr;var r=f;r("./locale/"+e),mi(i)}catch(n){}return ui[e]}function mi(t,e){var i;return t&&(i=c(e)?gi(t):pi(t,e),i?oi=i:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),oi._abbr}function pi(t,e){if(null!==e){var i,r=hi;if(e.abbr=t,null!=ui[t])q("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=ui[t]._config;else if(null!=e.parentLocale)if(null!=ui[e.parentLocale])r=ui[e.parentLocale]._config;else{if(i=fi(e.parentLocale),null==i)return li[e.parentLocale]||(li[e.parentLocale]=[]),li[e.parentLocale].push({name:t,config:e}),null;r=i._config}return ui[t]=new Y(W(r,e)),li[t]&&li[t].forEach((function(t){pi(t.name,t.config)})),mi(t),ui[t]}return delete ui[t],null}function yi(t,e){if(null!=e){var i,r,n=hi;r=fi(t),null!=r&&(n=r._config),e=W(n,e),i=new Y(e),i.parentLocale=ui[t],ui[t]=i,mi(t)}else null!=ui[t]&&(null!=ui[t].parentLocale?ui[t]=ui[t].parentLocale:null!=ui[t]&&delete ui[t]);return ui[t]}function gi(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return oi;if(!s(t)){if(e=fi(t),e)return e;t=[t]}return _i(t)}function vi(){return C(ui)}function bi(t){var e,i=t._a;return i&&-2===g(t).overflow&&(e=i[Nt]<0||i[Nt]>11?Nt:i[Ut]<1||i[Ut]>se(i[Rt],i[Nt])?Ut:i[Gt]<0||i[Gt]>24||24===i[Gt]&&(0!==i[Ht]||0!==i[Ft]||0!==i[Bt])?Gt:i[Ht]<0||i[Ht]>59?Ht:i[Ft]<0||i[Ft]>59?Ft:i[Bt]<0||i[Bt]>999?Bt:-1,g(t)._overflowDayOfYear&&(e<Rt||e>Ut)&&(e=Ut),g(t)._overflowWeeks&&-1===e&&(e=zt),g(t)._overflowWeekday&&-1===e&&(e=$t),g(t).overflow=e),t}function wi(t,e,i){return null!=t?t:null!=e?e:i}function ki(t){var e=new Date(r.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function xi(t){var e,i,r,n,s,a=[];if(!t._d){for(r=ki(t),t._w&&null==t._a[Ut]&&null==t._a[Nt]&&Oi(t),null!=t._dayOfYear&&(s=wi(t._a[Rt],r[Rt]),(t._dayOfYear>Kt(s)||0===t._dayOfYear)&&(g(t)._overflowDayOfYear=!0),i=ke(s,0,t._dayOfYear),t._a[Nt]=i.getUTCMonth(),t._a[Ut]=i.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=a[e]=r[e];for(;e<7;e++)t._a[e]=a[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[Gt]&&0===t._a[Ht]&&0===t._a[Ft]&&0===t._a[Bt]&&(t._nextDay=!0,t._a[Gt]=0),t._d=(t._useUTC?ke:we).apply(null,a),n=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Gt]=24),t._w&&"undefined"!==typeof t._w.d&&t._w.d!==n&&(g(t).weekdayMismatch=!0)}}function Oi(t){var e,i,r,n,s,a,o,c;if(e=t._w,null!=e.GG||null!=e.W||null!=e.E)s=1,a=4,i=wi(e.GG,t._a[Rt],Se(Vi(),1,4).year),r=wi(e.W,1),n=wi(e.E,1),(n<1||n>7)&&(c=!0);else{s=t._locale._week.dow,a=t._locale._week.doy;var h=Se(Vi(),s,a);i=wi(e.gg,t._a[Rt],h.year),r=wi(e.w,h.week),null!=e.d?(n=e.d,(n<0||n>6)&&(c=!0)):null!=e.e?(n=e.e+s,(e.e<0||e.e>6)&&(c=!0)):n=s}r<1||r>Me(i,s,a)?g(t)._overflowWeeks=!0:null!=c?g(t)._overflowWeekday=!0:(o=Oe(i,r,n,s,a),t._a[Rt]=o.year,t._dayOfYear=o.dayOfYear)}var Si=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Mi=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Di=/Z|[+-]\d\d(?::?\d\d)?/,Pi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],ji=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Ti=/^\/?Date\((\-?\d+)/i;function Ci(t){var e,i,r,n,s,a,o=t._i,c=Si.exec(o)||Mi.exec(o);if(c){for(g(t).iso=!0,e=0,i=Pi.length;e<i;e++)if(Pi[e][1].exec(c[1])){n=Pi[e][0],r=!1!==Pi[e][2];break}if(null==n)return void(t._isValid=!1);if(c[3]){for(e=0,i=ji.length;e<i;e++)if(ji[e][1].exec(c[3])){s=(c[2]||" ")+ji[e][0];break}if(null==s)return void(t._isValid=!1)}if(!r&&null!=s)return void(t._isValid=!1);if(c[4]){if(!Di.exec(c[4]))return void(t._isValid=!1);a="Z"}t._f=n+(s||"")+(a||""),Ui(t)}else t._isValid=!1}var Ei=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function qi(t,e,i,r,n,s){var a=[Ii(t),he.indexOf(e),parseInt(i,10),parseInt(r,10),parseInt(n,10)];return s&&a.push(parseInt(s,10)),a}function Ii(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Ai(t){return t.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Wi(t,e,i){if(t){var r=Le.indexOf(t),n=new Date(e[0],e[1],e[2]).getDay();if(r!==n)return g(i).weekdayMismatch=!0,i._isValid=!1,!1}return!0}var Yi={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Li(t,e,i){if(t)return Yi[t];if(e)return 0;var r=parseInt(i,10),n=r%100,s=(r-n)/100;return 60*s+n}function Ri(t){var e=Ei.exec(Ai(t._i));if(e){var i=qi(e[4],e[3],e[2],e[5],e[6],e[7]);if(!Wi(e[1],i,t))return;t._a=i,t._tzm=Li(e[8],e[9],e[10]),t._d=ke.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),g(t).rfc2822=!0}else t._isValid=!1}function Ni(t){var e=Ti.exec(t._i);null===e?(Ci(t),!1===t._isValid&&(delete t._isValid,Ri(t),!1===t._isValid&&(delete t._isValid,r.createFromInputFallback(t)))):t._d=new Date(+e[1])}function Ui(t){if(t._f!==r.ISO_8601)if(t._f!==r.RFC_2822){t._a=[],g(t).empty=!0;var e,i,n,s,a,o=""+t._i,c=o.length,h=0;for(n=dt(t._f,t._locale).match(nt)||[],e=0;e<n.length;e++)s=n[e],i=(o.match(Et(s,t))||[])[0],i&&(a=o.substr(0,o.indexOf(i)),a.length>0&&g(t).unusedInput.push(a),o=o.slice(o.indexOf(i)+i.length),h+=i.length),ot[s]?(i?g(t).empty=!1:g(t).unusedTokens.push(s),Lt(s,i,t)):t._strict&&!i&&g(t).unusedTokens.push(s);g(t).charsLeftOver=c-h,o.length>0&&g(t).unusedInput.push(o),t._a[Gt]<=12&&!0===g(t).bigHour&&t._a[Gt]>0&&(g(t).bigHour=void 0),g(t).parsedDateParts=t._a.slice(0),g(t).meridiem=t._meridiem,t._a[Gt]=Gi(t._locale,t._a[Gt],t._meridiem),xi(t),bi(t)}else Ri(t);else Ci(t)}function Gi(t,e,i){var r;return null==i?e:null!=t.meridiemHour?t.meridiemHour(e,i):null!=t.isPM?(r=t.isPM(i),r&&e<12&&(e+=12),r||12!==e||(e=0),e):e}function Hi(t){var e,i,r,n,s;if(0===t._f.length)return g(t).invalidFormat=!0,void(t._d=new Date(NaN));for(n=0;n<t._f.length;n++)s=0,e=k({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[n],Ui(e),v(e)&&(s+=g(e).charsLeftOver,s+=10*g(e).unusedTokens.length,g(e).score=s,(null==r||s<r)&&(r=s,i=e));m(t,i||e)}function Fi(t){if(!t._d){var e=X(t._i);t._a=d([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],(function(t){return t&&parseInt(t,10)})),xi(t)}}function Bi(t){var e=new O(bi(zi(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function zi(t){var e=t._i,i=t._f;return t._locale=t._locale||gi(t._l),null===e||void 0===i&&""===e?b({nullInput:!0}):("string"===typeof e&&(t._i=e=t._locale.preparse(e)),S(e)?new O(bi(e)):(u(e)?t._d=e:s(i)?Hi(t):i?Ui(t):$i(t),v(t)||(t._d=null),t))}function $i(t){var e=t._i;c(e)?t._d=new Date(r.now()):u(e)?t._d=new Date(e.valueOf()):"string"===typeof e?Ni(t):s(e)?(t._a=d(e.slice(0),(function(t){return parseInt(t,10)})),xi(t)):a(e)?Fi(t):h(e)?t._d=new Date(e):r.createFromInputFallback(t)}function Ki(t,e,i,r,n){var c={};return!0!==i&&!1!==i||(r=i,i=void 0),(a(t)&&o(t)||s(t)&&0===t.length)&&(t=void 0),c._isAMomentObject=!0,c._useUTC=c._isUTC=n,c._l=i,c._i=t,c._f=e,c._strict=r,Bi(c)}function Vi(t,e,i,r){return Ki(t,e,i,r,!1)}r.createFromInputFallback=T("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))})),r.ISO_8601=function(){},r.RFC_2822=function(){};var Qi=T("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=Vi.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:b()})),Zi=T("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=Vi.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:b()}));function Ji(t,e){var i,r;if(1===e.length&&s(e[0])&&(e=e[0]),!e.length)return Vi();for(i=e[0],r=1;r<e.length;++r)e[r].isValid()&&!e[r][t](i)||(i=e[r]);return i}function Xi(){var t=[].slice.call(arguments,0);return Ji("isBefore",t)}function tr(){var t=[].slice.call(arguments,0);return Ji("isAfter",t)}var er=function(){return Date.now?Date.now():+new Date},ir=["year","quarter","month","week","day","hour","minute","second","millisecond"];function rr(t){for(var e in t)if(-1===Qt.call(ir,e)||null!=t[e]&&isNaN(t[e]))return!1;for(var i=!1,r=0;r<ir.length;++r)if(t[ir[r]]){if(i)return!1;parseFloat(t[ir[r]])!==D(t[ir[r]])&&(i=!0)}return!0}function nr(){return this._isValid}function sr(){return Dr(NaN)}function ar(t){var e=X(t),i=e.year||0,r=e.quarter||0,n=e.month||0,s=e.week||e.isoWeek||0,a=e.day||0,o=e.hour||0,c=e.minute||0,h=e.second||0,u=e.millisecond||0;this._isValid=rr(e),this._milliseconds=+u+1e3*h+6e4*c+1e3*o*60*60,this._days=+a+7*s,this._months=+n+3*r+12*i,this._data={},this._locale=gi(),this._bubble()}function or(t){return t instanceof ar}function cr(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function hr(t,e){ct(t,0,0,(function(){var t=this.utcOffset(),i="+";return t<0&&(t=-t,i="-"),i+rt(~~(t/60),2)+e+rt(~~t%60,2)}))}hr("Z",":"),hr("ZZ",""),Ct("Z",Dt),Ct("ZZ",Dt),Wt(["Z","ZZ"],(function(t,e,i){i._useUTC=!0,i._tzm=lr(Dt,t)}));var ur=/([\+\-]|\d\d)/gi;function lr(t,e){var i=(e||"").match(t);if(null===i)return null;var r=i[i.length-1]||[],n=(r+"").match(ur)||["-",0,0],s=60*n[1]+D(n[2]);return 0===s?0:"+"===n[0]?s:-s}function dr(t,e){var i,n;return e._isUTC?(i=e.clone(),n=(S(t)||u(t)?t.valueOf():Vi(t).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+n),r.updateOffset(i,!1),i):Vi(t).local()}function _r(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function fr(t,e,i){var n,s=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"===typeof t){if(t=lr(Dt,t),null===t)return this}else Math.abs(t)<16&&!i&&(t*=60);return!this._isUTC&&e&&(n=_r(this)),this._offset=t,this._isUTC=!0,null!=n&&this.add(n,"m"),s!==t&&(!e||this._changeInProgress?Er(this,Dr(t-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?s:_r(this)}function mr(t,e){return null!=t?("string"!==typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function pr(t){return this.utcOffset(0,t)}function yr(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(_r(this),"m")),this}function gr(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var t=lr(Mt,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this}function vr(t){return!!this.isValid()&&(t=t?Vi(t).utcOffset():0,(this.utcOffset()-t)%60===0)}function br(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function wr(){if(!c(this._isDSTShifted))return this._isDSTShifted;var t={};if(k(t,this),t=zi(t),t._a){var e=t._isUTC?p(t._a):Vi(t._a);this._isDSTShifted=this.isValid()&&P(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function kr(){return!!this.isValid()&&!this._isUTC}function xr(){return!!this.isValid()&&this._isUTC}function Or(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}r.updateOffset=function(){};var Sr=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Mr=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Dr(t,e){var i,r,n,s=t,a=null;return or(t)?s={ms:t._milliseconds,d:t._days,M:t._months}:h(t)?(s={},e?s[e]=t:s.milliseconds=t):(a=Sr.exec(t))?(i="-"===a[1]?-1:1,s={y:0,d:D(a[Ut])*i,h:D(a[Gt])*i,m:D(a[Ht])*i,s:D(a[Ft])*i,ms:D(cr(1e3*a[Bt]))*i}):(a=Mr.exec(t))?(i="-"===a[1]?-1:1,s={y:Pr(a[2],i),M:Pr(a[3],i),w:Pr(a[4],i),d:Pr(a[5],i),h:Pr(a[6],i),m:Pr(a[7],i),s:Pr(a[8],i)}):null==s?s={}:"object"===Object(l["a"])(s)&&("from"in s||"to"in s)&&(n=Tr(Vi(s.from),Vi(s.to)),s={},s.ms=n.milliseconds,s.M=n.months),r=new ar(s),or(t)&&_(t,"_locale")&&(r._locale=t._locale),r}function Pr(t,e){var i=t&&parseFloat(t.replace(",","."));return(isNaN(i)?0:i)*e}function jr(t,e){var i={};return i.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(i.months,"M").isAfter(e)&&--i.months,i.milliseconds=+e-+t.clone().add(i.months,"M"),i}function Tr(t,e){var i;return t.isValid()&&e.isValid()?(e=dr(e,t),t.isBefore(e)?i=jr(t,e):(i=jr(e,t),i.milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function Cr(t,e){return function(i,r){var n,s;return null===r||isNaN(+r)||(q(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=i,i=r,r=s),i="string"===typeof i?+i:i,n=Dr(i,r),Er(this,n,t),this}}function Er(t,e,i,n){var s=e._milliseconds,a=cr(e._days),o=cr(e._months);t.isValid()&&(n=null==n||n,o&&_e(t,te(t,"Month")+o*i),a&&ee(t,"Date",te(t,"Date")+a*i),s&&t._d.setTime(t._d.valueOf()+s*i),n&&r.updateOffset(t,a||o))}Dr.fn=ar.prototype,Dr.invalid=sr;var qr=Cr(1,"add"),Ir=Cr(-1,"subtract");function Ar(t,e){var i=t.diff(e,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"}function Wr(t,e){var i=t||Vi(),n=dr(i,this).startOf("day"),s=r.calendarFormat(this,n)||"sameElse",a=e&&(I(e[s])?e[s].call(this,i):e[s]);return this.format(a||this.localeData().calendar(s,this,Vi(i)))}function Yr(){return new O(this)}function Lr(t,e){var i=S(t)?t:Vi(t);return!(!this.isValid()||!i.isValid())&&(e=J(e)||"millisecond","millisecond"===e?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(e).valueOf())}function Rr(t,e){var i=S(t)?t:Vi(t);return!(!this.isValid()||!i.isValid())&&(e=J(e)||"millisecond","millisecond"===e?this.valueOf()<i.valueOf():this.clone().endOf(e).valueOf()<i.valueOf())}function Nr(t,e,i,r){var n=S(t)?t:Vi(t),s=S(e)?e:Vi(e);return!!(this.isValid()&&n.isValid()&&s.isValid())&&(r=r||"()",("("===r[0]?this.isAfter(n,i):!this.isBefore(n,i))&&(")"===r[1]?this.isBefore(s,i):!this.isAfter(s,i)))}function Ur(t,e){var i,r=S(t)?t:Vi(t);return!(!this.isValid()||!r.isValid())&&(e=J(e)||"millisecond","millisecond"===e?this.valueOf()===r.valueOf():(i=r.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf()))}function Gr(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function Hr(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function Fr(t,e,i){var r,n,s;if(!this.isValid())return NaN;if(r=dr(t,this),!r.isValid())return NaN;switch(n=6e4*(r.utcOffset()-this.utcOffset()),e=J(e),e){case"year":s=Br(this,r)/12;break;case"month":s=Br(this,r);break;case"quarter":s=Br(this,r)/3;break;case"second":s=(this-r)/1e3;break;case"minute":s=(this-r)/6e4;break;case"hour":s=(this-r)/36e5;break;case"day":s=(this-r-n)/864e5;break;case"week":s=(this-r-n)/6048e5;break;default:s=this-r}return i?s:M(s)}function Br(t,e){var i,r,n=12*(e.year()-t.year())+(e.month()-t.month()),s=t.clone().add(n,"months");return e-s<0?(i=t.clone().add(n-1,"months"),r=(e-s)/(s-i)):(i=t.clone().add(n+1,"months"),r=(e-s)/(i-s)),-(n+r)||0}function zr(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function $r(t){if(!this.isValid())return null;var e=!0!==t,i=e?this.clone().utc():this;return i.year()<0||i.year()>9999?lt(i,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):I(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",lt(i,"Z")):lt(i,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Kr(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var i="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]';return this.format(i+r+n+s)}function Vr(t){t||(t=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var e=lt(this,t);return this.localeData().postformat(e)}function Qr(t,e){return this.isValid()&&(S(t)&&t.isValid()||Vi(t).isValid())?Dr({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Zr(t){return this.from(Vi(),t)}function Jr(t,e){return this.isValid()&&(S(t)&&t.isValid()||Vi(t).isValid())?Dr({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Xr(t){return this.to(Vi(),t)}function tn(t){var e;return void 0===t?this._locale._abbr:(e=gi(t),null!=e&&(this._locale=e),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var en=T("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(t){return void 0===t?this.localeData():this.locale(t)}));function rn(){return this._locale}var nn=1e3,sn=60*nn,an=60*sn,on=3506328*an;function cn(t,e){return(t%e+e)%e}function hn(t,e,i){return t<100&&t>=0?new Date(t+400,e,i)-on:new Date(t,e,i).valueOf()}function un(t,e,i){return t<100&&t>=0?Date.UTC(t+400,e,i)-on:Date.UTC(t,e,i)}function ln(t){var e;if(t=J(t),void 0===t||"millisecond"===t||!this.isValid())return this;var i=this._isUTC?un:hn;switch(t){case"year":e=i(this.year(),0,1);break;case"quarter":e=i(this.year(),this.month()-this.month()%3,1);break;case"month":e=i(this.year(),this.month(),1);break;case"week":e=i(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=i(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=cn(e+(this._isUTC?0:this.utcOffset()*sn),an);break;case"minute":e=this._d.valueOf(),e-=cn(e,sn);break;case"second":e=this._d.valueOf(),e-=cn(e,nn);break}return this._d.setTime(e),r.updateOffset(this,!0),this}function dn(t){var e;if(t=J(t),void 0===t||"millisecond"===t||!this.isValid())return this;var i=this._isUTC?un:hn;switch(t){case"year":e=i(this.year()+1,0,1)-1;break;case"quarter":e=i(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=i(this.year(),this.month()+1,1)-1;break;case"week":e=i(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=i(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=an-cn(e+(this._isUTC?0:this.utcOffset()*sn),an)-1;break;case"minute":e=this._d.valueOf(),e+=sn-cn(e,sn)-1;break;case"second":e=this._d.valueOf(),e+=nn-cn(e,nn)-1;break}return this._d.setTime(e),r.updateOffset(this,!0),this}function _n(){return this._d.valueOf()-6e4*(this._offset||0)}function fn(){return Math.floor(this.valueOf()/1e3)}function mn(){return new Date(this.valueOf())}function pn(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function yn(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function gn(){return this.isValid()?this.toISOString():null}function vn(){return v(this)}function bn(){return m({},g(this))}function wn(){return g(this).overflow}function kn(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function xn(t,e){ct(0,[t,t.length],0,e)}function On(t){return Pn.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Sn(t){return Pn.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Mn(){return Me(this.year(),1,4)}function Dn(){var t=this.localeData()._week;return Me(this.year(),t.dow,t.doy)}function Pn(t,e,i,r,n){var s;return null==t?Se(this,r,n).year:(s=Me(t,r,n),e>s&&(e=s),jn.call(this,t,e,i,r,n))}function jn(t,e,i,r,n){var s=Oe(t,e,i,r,n),a=ke(s.year,0,s.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function Tn(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)}ct(0,["gg",2],0,(function(){return this.weekYear()%100})),ct(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),xn("gggg","weekYear"),xn("ggggg","weekYear"),xn("GGGG","isoWeekYear"),xn("GGGGG","isoWeekYear"),Z("weekYear","gg"),Z("isoWeekYear","GG"),et("weekYear",1),et("isoWeekYear",1),Ct("G",St),Ct("g",St),Ct("GG",gt,ft),Ct("gg",gt,ft),Ct("GGGG",kt,pt),Ct("gggg",kt,pt),Ct("GGGGG",xt,yt),Ct("ggggg",xt,yt),Yt(["gggg","ggggg","GGGG","GGGGG"],(function(t,e,i,r){e[r.substr(0,2)]=D(t)})),Yt(["gg","GG"],(function(t,e,i,n){e[n]=r.parseTwoDigitYear(t)})),ct("Q",0,"Qo","quarter"),Z("quarter","Q"),et("quarter",7),Ct("Q",_t),Wt("Q",(function(t,e){e[Nt]=3*(D(t)-1)})),ct("D",["DD",2],"Do","date"),Z("date","D"),et("date",9),Ct("D",gt),Ct("DD",gt,ft),Ct("Do",(function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient})),Wt(["D","DD"],Ut),Wt("Do",(function(t,e){e[Ut]=D(t.match(gt)[0])}));var Cn=Xt("Date",!0);function En(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")}ct("DDD",["DDDD",3],"DDDo","dayOfYear"),Z("dayOfYear","DDD"),et("dayOfYear",4),Ct("DDD",wt),Ct("DDDD",mt),Wt(["DDD","DDDD"],(function(t,e,i){i._dayOfYear=D(t)})),ct("m",["mm",2],0,"minute"),Z("minute","m"),et("minute",14),Ct("m",gt),Ct("mm",gt,ft),Wt(["m","mm"],Ht);var qn=Xt("Minutes",!1);ct("s",["ss",2],0,"second"),Z("second","s"),et("second",15),Ct("s",gt),Ct("ss",gt,ft),Wt(["s","ss"],Ft);var In,An=Xt("Seconds",!1);for(ct("S",0,0,(function(){return~~(this.millisecond()/100)})),ct(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),ct(0,["SSS",3],0,"millisecond"),ct(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),ct(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),ct(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),ct(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),ct(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),ct(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),Z("millisecond","ms"),et("millisecond",16),Ct("S",wt,_t),Ct("SS",wt,ft),Ct("SSS",wt,mt),In="SSSS";In.length<=9;In+="S")Ct(In,Ot);function Wn(t,e){e[Bt]=D(1e3*("0."+t))}for(In="S";In.length<=9;In+="S")Wt(In,Wn);var Yn=Xt("Milliseconds",!1);function Ln(){return this._isUTC?"UTC":""}function Rn(){return this._isUTC?"Coordinated Universal Time":""}ct("z",0,0,"zoneAbbr"),ct("zz",0,0,"zoneName");var Nn=O.prototype;function Un(t){return Vi(1e3*t)}function Gn(){return Vi.apply(null,arguments).parseZone()}function Hn(t){return t}Nn.add=qr,Nn.calendar=Wr,Nn.clone=Yr,Nn.diff=Fr,Nn.endOf=dn,Nn.format=Vr,Nn.from=Qr,Nn.fromNow=Zr,Nn.to=Jr,Nn.toNow=Xr,Nn.get=ie,Nn.invalidAt=wn,Nn.isAfter=Lr,Nn.isBefore=Rr,Nn.isBetween=Nr,Nn.isSame=Ur,Nn.isSameOrAfter=Gr,Nn.isSameOrBefore=Hr,Nn.isValid=vn,Nn.lang=en,Nn.locale=tn,Nn.localeData=rn,Nn.max=Zi,Nn.min=Qi,Nn.parsingFlags=bn,Nn.set=re,Nn.startOf=ln,Nn.subtract=Ir,Nn.toArray=pn,Nn.toObject=yn,Nn.toDate=mn,Nn.toISOString=$r,Nn.inspect=Kr,Nn.toJSON=gn,Nn.toString=zr,Nn.unix=fn,Nn.valueOf=_n,Nn.creationData=kn,Nn.year=Zt,Nn.isLeapYear=Jt,Nn.weekYear=On,Nn.isoWeekYear=Sn,Nn.quarter=Nn.quarters=Tn,Nn.month=fe,Nn.daysInMonth=me,Nn.week=Nn.weeks=Ce,Nn.isoWeek=Nn.isoWeeks=Ee,Nn.weeksInYear=Dn,Nn.isoWeeksInYear=Mn,Nn.date=Cn,Nn.day=Nn.days=Fe,Nn.weekday=Be,Nn.isoWeekday=ze,Nn.dayOfYear=En,Nn.hour=Nn.hours=ci,Nn.minute=Nn.minutes=qn,Nn.second=Nn.seconds=An,Nn.millisecond=Nn.milliseconds=Yn,Nn.utcOffset=fr,Nn.utc=pr,Nn.local=yr,Nn.parseZone=gr,Nn.hasAlignedHourOffset=vr,Nn.isDST=br,Nn.isLocal=kr,Nn.isUtcOffset=xr,Nn.isUtc=Or,Nn.isUTC=Or,Nn.zoneAbbr=Ln,Nn.zoneName=Rn,Nn.dates=T("dates accessor is deprecated. Use date instead.",Cn),Nn.months=T("months accessor is deprecated. Use month instead",fe),Nn.years=T("years accessor is deprecated. Use year instead",Zt),Nn.zone=T("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",mr),Nn.isDSTShifted=T("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",wr);var Fn=Y.prototype;function Bn(t,e,i,r){var n=gi(),s=p().set(r,e);return n[i](s,t)}function zn(t,e,i){if(h(t)&&(e=t,t=void 0),t=t||"",null!=e)return Bn(t,e,i,"month");var r,n=[];for(r=0;r<12;r++)n[r]=Bn(t,r,i,"month");return n}function $n(t,e,i,r){"boolean"===typeof t?(h(e)&&(i=e,e=void 0),e=e||""):(e=t,i=e,t=!1,h(e)&&(i=e,e=void 0),e=e||"");var n,s=gi(),a=t?s._week.dow:0;if(null!=i)return Bn(e,(i+a)%7,r,"day");var o=[];for(n=0;n<7;n++)o[n]=Bn(e,(n+a)%7,r,"day");return o}function Kn(t,e){return zn(t,e,"months")}function Vn(t,e){return zn(t,e,"monthsShort")}function Qn(t,e,i){return $n(t,e,i,"weekdays")}function Zn(t,e,i){return $n(t,e,i,"weekdaysShort")}function Jn(t,e,i){return $n(t,e,i,"weekdaysMin")}Fn.calendar=R,Fn.longDateFormat=U,Fn.invalidDate=H,Fn.ordinal=z,Fn.preparse=Hn,Fn.postformat=Hn,Fn.relativeTime=K,Fn.pastFuture=V,Fn.set=A,Fn.months=ce,Fn.monthsShort=ue,Fn.monthsParse=de,Fn.monthsRegex=ve,Fn.monthsShortRegex=ye,Fn.week=De,Fn.firstDayOfYear=Te,Fn.firstDayOfWeek=je,Fn.weekdays=Ye,Fn.weekdaysMin=Ue,Fn.weekdaysShort=Re,Fn.weekdaysParse=He,Fn.weekdaysRegex=Ke,Fn.weekdaysShortRegex=Qe,Fn.weekdaysMinRegex=Je,Fn.isPM=ni,Fn.meridiem=ai,mi("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,i=1===D(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+i}}),r.lang=T("moment.lang is deprecated. Use moment.locale instead.",mi),r.langData=T("moment.langData is deprecated. Use moment.localeData instead.",gi);var Xn=Math.abs;function ts(){var t=this._data;return this._milliseconds=Xn(this._milliseconds),this._days=Xn(this._days),this._months=Xn(this._months),t.milliseconds=Xn(t.milliseconds),t.seconds=Xn(t.seconds),t.minutes=Xn(t.minutes),t.hours=Xn(t.hours),t.months=Xn(t.months),t.years=Xn(t.years),this}function es(t,e,i,r){var n=Dr(e,i);return t._milliseconds+=r*n._milliseconds,t._days+=r*n._days,t._months+=r*n._months,t._bubble()}function is(t,e){return es(this,t,e,1)}function rs(t,e){return es(this,t,e,-1)}function ns(t){return t<0?Math.floor(t):Math.ceil(t)}function ss(){var t,e,i,r,n,s=this._milliseconds,a=this._days,o=this._months,c=this._data;return s>=0&&a>=0&&o>=0||s<=0&&a<=0&&o<=0||(s+=864e5*ns(os(o)+a),a=0,o=0),c.milliseconds=s%1e3,t=M(s/1e3),c.seconds=t%60,e=M(t/60),c.minutes=e%60,i=M(e/60),c.hours=i%24,a+=M(i/24),n=M(as(a)),o+=n,a-=ns(os(n)),r=M(o/12),o%=12,c.days=a,c.months=o,c.years=r,this}function as(t){return 4800*t/146097}function os(t){return 146097*t/4800}function cs(t){if(!this.isValid())return NaN;var e,i,r=this._milliseconds;if(t=J(t),"month"===t||"quarter"===t||"year"===t)switch(e=this._days+r/864e5,i=this._months+as(e),t){case"month":return i;case"quarter":return i/3;case"year":return i/12}else switch(e=this._days+Math.round(os(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return 24*e+r/36e5;case"minute":return 1440*e+r/6e4;case"second":return 86400*e+r/1e3;case"millisecond":return Math.floor(864e5*e)+r;default:throw new Error("Unknown unit "+t)}}function hs(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*D(this._months/12):NaN}function us(t){return function(){return this.as(t)}}var ls=us("ms"),ds=us("s"),_s=us("m"),fs=us("h"),ms=us("d"),ps=us("w"),ys=us("M"),gs=us("Q"),vs=us("y");function bs(){return Dr(this)}function ws(t){return t=J(t),this.isValid()?this[t+"s"]():NaN}function ks(t){return function(){return this.isValid()?this._data[t]:NaN}}var xs=ks("milliseconds"),Os=ks("seconds"),Ss=ks("minutes"),Ms=ks("hours"),Ds=ks("days"),Ps=ks("months"),js=ks("years");function Ts(){return M(this.days()/7)}var Cs=Math.round,Es={ss:44,s:45,m:45,h:22,d:26,M:11};function qs(t,e,i,r,n){return n.relativeTime(e||1,!!i,t,r)}function Is(t,e,i){var r=Dr(t).abs(),n=Cs(r.as("s")),s=Cs(r.as("m")),a=Cs(r.as("h")),o=Cs(r.as("d")),c=Cs(r.as("M")),h=Cs(r.as("y")),u=n<=Es.ss&&["s",n]||n<Es.s&&["ss",n]||s<=1&&["m"]||s<Es.m&&["mm",s]||a<=1&&["h"]||a<Es.h&&["hh",a]||o<=1&&["d"]||o<Es.d&&["dd",o]||c<=1&&["M"]||c<Es.M&&["MM",c]||h<=1&&["y"]||["yy",h];return u[2]=e,u[3]=+t>0,u[4]=i,qs.apply(null,u)}function As(t){return void 0===t?Cs:"function"===typeof t&&(Cs=t,!0)}function Ws(t,e){return void 0!==Es[t]&&(void 0===e?Es[t]:(Es[t]=e,"s"===t&&(Es.ss=e-1),!0))}function Ys(t){if(!this.isValid())return this.localeData().invalidDate();var e=this.localeData(),i=Is(this,!t,e);return t&&(i=e.pastFuture(+this,i)),e.postformat(i)}var Ls=Math.abs;function Rs(t){return(t>0)-(t<0)||+t}function Ns(){if(!this.isValid())return this.localeData().invalidDate();var t,e,i,r=Ls(this._milliseconds)/1e3,n=Ls(this._days),s=Ls(this._months);t=M(r/60),e=M(t/60),r%=60,t%=60,i=M(s/12),s%=12;var a=i,o=s,c=n,h=e,u=t,l=r?r.toFixed(3).replace(/\.?0+$/,""):"",d=this.asSeconds();if(!d)return"P0D";var _=d<0?"-":"",f=Rs(this._months)!==Rs(d)?"-":"",m=Rs(this._days)!==Rs(d)?"-":"",p=Rs(this._milliseconds)!==Rs(d)?"-":"";return _+"P"+(a?f+a+"Y":"")+(o?f+o+"M":"")+(c?m+c+"D":"")+(h||u||l?"T":"")+(h?p+h+"H":"")+(u?p+u+"M":"")+(l?p+l+"S":"")}var Us=ar.prototype;return Us.isValid=nr,Us.abs=ts,Us.add=is,Us.subtract=rs,Us.as=cs,Us.asMilliseconds=ls,Us.asSeconds=ds,Us.asMinutes=_s,Us.asHours=fs,Us.asDays=ms,Us.asWeeks=ps,Us.asMonths=ys,Us.asQuarters=gs,Us.asYears=vs,Us.valueOf=hs,Us._bubble=ss,Us.clone=bs,Us.get=ws,Us.milliseconds=xs,Us.seconds=Os,Us.minutes=Ss,Us.hours=Ms,Us.days=Ds,Us.weeks=Ts,Us.months=Ps,Us.years=js,Us.humanize=Ys,Us.toISOString=Ns,Us.toString=Ns,Us.toJSON=Ns,Us.locale=tn,Us.localeData=rn,Us.toIsoString=T("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ns),Us.lang=en,ct("X",0,0,"unix"),ct("x",0,0,"valueOf"),Ct("x",St),Ct("X",Pt),Wt("X",(function(t,e,i){i._d=new Date(1e3*parseFloat(t,10))})),Wt("x",(function(t,e,i){i._d=new Date(D(t))})),r.version="2.24.0",n(Vi),r.fn=Nn,r.min=Xi,r.max=tr,r.now=er,r.utc=p,r.unix=Un,r.months=Kn,r.isDate=u,r.locale=mi,r.invalid=b,r.duration=Dr,r.isMoment=S,r.weekdays=Qn,r.parseZone=Gn,r.localeData=gi,r.isDuration=or,r.monthsShort=Vn,r.weekdaysMin=Jn,r.defineLocale=pi,r.updateLocale=yi,r.locales=vi,r.weekdaysShort=Zn,r.normalizeUnits=J,r.relativeTimeRounding=As,r.relativeTimeThreshold=Ws,r.calendarFormat=Ar,r.prototype=Nn,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r}))})),hi=(Object(d["l"])(".%L"),Object(d["l"])(":%S"),Object(d["l"])("%H:%M"),Object(d["l"])("%H:%M"),Object(d["l"])("%m%d"),Object(d["l"])("%m%d"),Object(d["l"])("%y"),function(t){var e="";if(t&&t>=1e9){var i=ci.duration(t/1e9,"seconds");i.years()>0&&(e+=i.years()+"Y"),i.months()>0&&(e+=i.months()+"M"),i.days()>0&&(e+=i.days()+"D"),i.hours()>0&&(e+=i.hours()+"h"),i.minutes()>0&&(e+=i.minutes()+"m"),i.seconds()>0&&(e+=i.seconds()+"s")}return e}),ui={up:function(t){return t.open<=t.close},down:function(t){return t.open>t.close}},li=Object.keys(ui),di={up:function(t){return t.open<t.close},down:function(t){return t.open>t.close},equal:function(t){return t.open===t.close}},_i=Object.keys(di),fi=function(t,e,i){return function(){var r=Array.from(arguments).join(" "),n="color: white; background-color: ".concat(i,";");console.log.apply(this,["%c "+e+" %c "+r,n,t])}},mi=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"TqChart",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"plum";return{log:fi("color: green;",t,e),info:fi("color: blue;",t,e),debug:fi("color: pink;",t,e),warn:fi("color: orange;",t,e),error:fi("color: red;",t,e)}},pi=function(t){return Number.isInteger(Number(t))},yi=function(t){var e="string"===typeof t?t:"";if(pi(t)){var i=t.toString(16).padStart(8,"F"),r=parseInt(i.slice(0,2),16)/255,n=parseInt(i.slice(2,4),16),s=parseInt(i.slice(4,6),16),a=parseInt(i.slice(6),16);e="rgba(".concat(n,", ").concat(s,", ").concat(a,", ").concat(r,")")}return e},gi=function t(){Object(h["a"])(this,t);var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.id,r=e.xScale,n=e.yScale,s=e.bar;this.id=i||(new Date).getTime(),this.bar=s,this.xScale=r,this.yScale=n,this.paths=[]},vi=function(t){function e(){var t;Object(h["a"])(this,e);var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.id,n=i.xScale,s=i.yScale,c=i.bar;return t=Object(a["a"])(this,Object(o["a"])(e).call(this,{id:r,xScale:n,yScale:s,bar:c})),_i.forEach((function(e){return t.paths.push([t.id,"candle","line",e].join("."))})),_i.forEach((function(e){return t.paths.push([t.id,"candle","body",e].join("."))})),t}return Object(c["a"])(e,t),Object(u["a"])(e,[{key:"getYDomain",value:function(t,e,i){var r=i.slice(t,e+1),n=[Object(d["g"])(r,(function(t){return t&&t.low})),Object(d["f"])(r,(function(t){return t&&t.high}))],s=n[0],a=n[1];return s-=.2*(a-s),a+=.2*(a-s),[s,a]}},{key:"calcPaths",value:function(t,e,i){var r=this;if(this.yScale&&this.xScale&&this.bar){var n={};this.paths.forEach((function(t){n[t]=""}));for(var s=function(t){if("kline"===r.id&&console.info(t,i,i[t]),!i[t])return"continue";_i.forEach((function(e){if(di[e](i[t])){var s="up"===e?.5:0;n[[r.id,"candle","body",e].join(".")]+=r._bodyPath(i[t],t,s),n[[r.id,"candle","line",e].join(".")]+=r._linePath(i[t],t)}}))},a=t;a<=e;a++)s(a);return n}}},{key:"_bodyPath",value:function(t,e,i){var r=Math.round(this.yScale(t.open))+i,n=Math.round(this.yScale(t.close))+i,s=this.xScale(e)+this.bar.barPadding;if(Number.isNaN(r)||Number.isNaN(n)||Number.isNaN(s))return"";var a=this.bar.barWidth-2*this.bar.barPadding;return r!==n?"M".concat(s+i," ").concat(r," L").concat(s+a-i," ").concat(r," L").concat(s+a-i," ").concat(n," L").concat(s+i," ").concat(n," L").concat(s+i," ").concat(r):"M".concat(s," ").concat(r+.5," L").concat(s+a," ").concat(r+.5)}},{key:"_linePath",value:function(t,e){var i=Math.round(this.yScale(t.high)),r=Math.round(this.yScale(t.low)),n=this.xScale(e)+this.bar.barWidth/2;return Number.isNaN(i)||Number.isNaN(r)||Number.isNaN(n)?"":"M ".concat(n," ").concat(i," L ").concat(n," ").concat(r)}}]),e}(gi),bi=function(t){function e(){var t;Object(h["a"])(this,e);var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.id,n=i.xScale,s=i.yScale,c=i.bar;return t=Object(a["a"])(this,Object(o["a"])(e).call(this,{id:r,xScale:n,yScale:s,bar:c})),li.forEach((function(e){return t.paths.push([t.id,"body",e].join("."))})),t}return Object(c["a"])(e,t),Object(u["a"])(e,[{key:"getYDomain",value:function(t,e,i){var r=i.slice(t,e+1);return[0,1.2*Object(d["f"])(r,(function(t){return t&&t.volume}))]}},{key:"calcPaths",value:function(t,e,i){var r=this;if(this.yScale&&this.xScale&&this.bar){var n={};this.paths.forEach((function(t){n[t]=""}));for(var s=function(t){if(!i[t])return"continue";li.forEach((function(e){ui[e](i[t])&&(n[[r.id,"body",e].join(".")]+=r.bodyPath(i[t],t,"up"===e?.5:0))}))},a=t;a<=e;a++)s(a);return n}}},{key:"bodyPath",value:function(t,e,i){var r=Math.ceil(this.yScale(0))+(0===i?1:i),n=Math.min(Math.round(r-this.yScale(t.volume)),r-i),s=this.xScale(e)+this.bar.barPadding,a=this.bar.barWidth-2*this.bar.barPadding,o="M".concat(s+i," ").concat(r,"L").concat(s+a-i," ").concat(r,"L ").concat(s+a-i," ").concat(r-n,"L").concat(s+i," ").concat(r-n,"L").concat(s+i," ").concat(r);return o}}]),e}(gi),wi=function(t){function e(){var t;Object(h["a"])(this,e);var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.id,n=i.xScale,s=i.yScale,c=i.bar;return t=Object(a["a"])(this,Object(o["a"])(e).call(this,{id:r,xScale:n,yScale:s,bar:c})),t.paths=["oi"],t}return Object(c["a"])(e,t),Object(u["a"])(e,[{key:"getYDomain",value:function(t,e,i){var r=i.slice(t,e+1),n=[Object(d["g"])(r,(function(t){return t&&t.close_oi})),Object(d["f"])(r,(function(t){return t&&t.close_oi}))],s=n[0],a=n[1];return s-=.2*(a-s),a+=.2*(a-s),[s,a]}},{key:"calcPaths",value:function(t,e,i){if(this.yScale&&this.xScale&&this.bar){for(var r="",n=t;n<=e;n++)if(i[n]){var s=this.yScale(i[n].close_oi),a=this.xScale(n)+this.bar.barWidth/2;r+=""===r?"M":"L",r+="".concat(a," ").concat(s," ")}return{oi:r}}}}]),e}(gi),ki=function(t){function e(){var t;Object(h["a"])(this,e);var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.id,n=i.xScale,s=i.yScale,c=i.bar,u=i.propName,l=i.min,d=i.max;return t=Object(a["a"])(this,Object(o["a"])(e).call(this,{id:r,xScale:n,yScale:s,bar:c})),t.min=l,t.max=d,t.propName=u||"value",t.paths=["value"],t}return Object(c["a"])(e,t),Object(u["a"])(e,[{key:"getYDomain",value:function(t,e,i){var r=this;if(Number.isFinite(this.min)&&Number.isFinite(this.max))return[this.min,this.max];var n=i.slice(t,e+1);return[Object(d["g"])(n,(function(t){return t&&t[r.propName]})),Object(d["f"])(n,(function(t){return t&&t[r.propName]}))]}},{key:"calcPaths",value:function(t,e,i){if(this.yScale&&this.xScale&&this.bar){for(var r="M",n=t;n<=e;n++)if(i[n]){var s=this.yScale(i[n][this.propName]),a=this.xScale(n)+this.bar.barWidth/2;void 0===s||Number.isNaN(s)||Number.isNaN(a)?r.endsWith("M")||(r+="M"):(r+=r.endsWith("M")?"":"L",r+="".concat(a," ").concat(s))}else r.endsWith("M")||(r+="M");return{value:r.replace(/[LM]$/,"")}}}}]),e}(gi),xi=function(t){function e(){var t;Object(h["a"])(this,e);var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.id,n=i.xScale,s=i.yScale,c=i.bar,u=i.propName,l=i.isHollow,d=i.min,_=i.max;return t=Object(a["a"])(this,Object(o["a"])(e).call(this,{id:r,xScale:n,yScale:s,bar:c})),t.isHollow=l||!1,t.min=d,t.max=_,t.propName=u||"value",t.paths=["value"],t}return Object(c["a"])(e,t),Object(u["a"])(e,[{key:"getYDomain",value:function(t,e,i){var r=this;if(Number.isFinite(this.min)&&Number.isFinite(this.max))return[this.min,this.max];var n=i.slice(t,e+1);return[0,Object(d["f"])(n,(function(t){return t&&t[r.propName]}))]}},{key:"calcPaths",value:function(t,e,i){if(this.yScale&&this.xScale&&this.bar){for(var r="",n=t;n<=e;n++)i[n]&&(r+=this.bodyPath(i[n],n,this.isHollow?.5:0));return{value:r}}}},{key:"bodyPath",value:function(t,e,i){var r=Math.floor(this.yScale(0)),n=Math.round(r-this.yScale(t[this.propName])),s=this.xScale(e)+this.bar.barPadding;if(Number.isNaN(n)||Number.isNaN(s))return"";var a=this.bar.barWidth-2*this.bar.barPadding;return"M ".concat(s+i," ").concat(r-i," L ").concat(s+a-i," ").concat(r-i," L ").concat(s+a-i," ").concat(r-n+i," L ").concat(s+i," ").concat(r-n+i," L ").concat(s+i," ").concat(r-i)}}]),e}(gi),Oi=function(t){function e(){var t;Object(h["a"])(this,e);var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.id,n=i.xScale,s=i.yScale,c=i.bar,u=i.propName,l=i.min,d=i.max;return t=Object(a["a"])(this,Object(o["a"])(e).call(this,{id:r,xScale:n,yScale:s,bar:c})),t.min=l,t.max=d,t.propName=u||"value",t.paths=["value"],t}return Object(c["a"])(e,t),Object(u["a"])(e,[{key:"getYDomain",value:function(t,e,i){var r=this;if(Number.isFinite(this.min)&&Number.isFinite(this.max))return[this.min,this.max];var n=i.slice(t,e+1);return[Object(d["g"])(n,(function(t){return t&&t[r.propName]})),Object(d["f"])(n,(function(t){return t&&t[r.propName]}))]}},{key:"calcPaths",value:function(t,e,i){if(this.yScale&&this.xScale&&this.bar){for(var r="",n=t;n<=e;n++)if(i[n]){var s=this.yScale(i[n][this.propName]),a=this.xScale(n)+this.bar.barWidth/2;if(!Number.isNaN(s)&&!Number.isNaN(a)){var o=3;r+="M ".concat(a-o," ").concat(s," a ").concat(o,", ").concat(o," 0 1,0 ").concat(2*o,",0 a ").concat(o,", ").concat(o," 0 1,0 ").concat(2*-o,",0 ")}}return{value:r}}}}]),e}(gi),Si=function(){function t(){Object(h["a"])(this,t);var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.chart,r=e.boardId,n=e.plotId,s=void 0===n?"":n,a=e.yAlign,o=void 0===a?"right":a,c=e.type,u=void 0===c?"candle":c,l=e.color,d=void 0===l?"red":l,_=e.width,f=void 0===_?2:_,m=e.dash,p=void 0!==m&&m,y=e.data;this.chart=i,this.boardId=r,this.plotId=s,this.yAlign=o,this.board=this.chart.boards[r],this.data=y,this.type=u,this.color=d,this.width=Number.isFinite(f)?Math.round(f):2,this.dash=p,this.g=this.board.plotG.append("g").attr("class","plot ".concat(this.boardId," ").concat(this.plotId)),this.path=null,this._initPath()}return Object(u["a"])(t,[{key:"_initPath",value:function(){switch(this.type){case"candle":this.path=new vi({id:this.plotId,xScale:this.chart.xAxis.xScale,yScale:this.chart.boards[this.boardId][this.yAlign+"YAxis"].yScale,bar:this.chart.bar});break;case"volume":this.path=new bi({id:this.plotId,xScale:this.chart.xAxis.xScale,yScale:this.chart.boards[this.boardId][this.yAlign+"YAxis"].yScale,bar:this.chart.bar});break;case"oi":this.path=new wi({id:this.plotId,xScale:this.chart.xAxis.xScale,yScale:this.chart.boards[this.boardId][this.yAlign+"YAxis"].yScale,bar:this.chart.bar});break;case"dash":this.path=new ki({id:this.plotId,xScale:this.chart.xAxis.xScale,yScale:this.chart.boards[this.boardId][this.yAlign+"YAxis"].yScale,bar:this.chart.bar});break;case"line":this.path=new ki({id:this.plotId,xScale:this.chart.xAxis.xScale,yScale:this.chart.boards[this.boardId][this.yAlign+"YAxis"].yScale,bar:this.chart.bar});break;case"bar":this.path=new xi({id:this.plotId,xScale:this.chart.xAxis.xScale,yScale:this.chart.boards[this.boardId][this.yAlign+"YAxis"].yScale,bar:this.chart.bar});break;case"dot":this.path=new Oi({id:this.plotId,xScale:this.chart.xAxis.xScale,yScale:this.chart.boards[this.boardId][this.yAlign+"YAxis"].yScale,bar:this.chart.bar});break}for(var t=0;t<this.path.paths.length;t++)this._appendPlotTypePath(this.path.paths[t])}},{key:"_appendPlotTypePath",value:function(t){if(Array.isArray(t)||(t=t.split(".")),this.g.selectAll("path.".concat(t.join("."))).data((function(t){return[t]})).enter().append("path").attr("class",t.join(" ")),"line"===this.type||"dash"===this.type){var e="string"===typeof this.color?this.color:"";this.g.selectAll("path.".concat(t.join("."))).style("fill","none").attr("stroke",e).attr("stroke-width",this.width+"px").attr("stroke-dasharray",this.dash?"4 4":"0")}else"bar"===this.type?this.g.selectAll("path.".concat(t.join("."))).style("fill",this.color).attr("stroke","none"):"dot"===this.type&&this.g.selectAll("path.".concat(t.join("."))).style("fill",this.color).attr("stroke","none")}},{key:"getYDomain",value:function(t,e,i){return this.path.getYDomain(t,e,i)}},{key:"draw",value:function(t,e,i){var r=this.path.calcPaths(t,e,i);for(var n in r)try{this.g.select("path.".concat(n)).attr("d",r[n])}catch(s){this.chart.tqChartConsole.error(s)}}},{key:"remove",value:function(){this.g.remove()}}]),t}(),Mi=function(){function t(e,i,r){Object(h["a"])(this,t),this.tqchart=e,this.id=i,this.klineId=r}return Object(u["a"])(t,[{key:"update",value:function(t){this.klineId=t}},{key:"resize",value:function(){this.g.attr("width",this.tqchart.bar.barWidth).attr("height",this.tqchart.innerHeight)}},{key:"draw",value:function(){this.g||(this.g=this.tqchart.bgShapesG.append("rect").attr("class","highlight").attr("width",this.tqchart.bar.barWidth).attr("height",this.tqchart.innerHeight));var t=this.tqchart.chartController.revertIdToPx(this.klineId);this.g.attr("transform","translate(".concat(t,",0)"))}},{key:"clear",value:function(){this.g.remove()}}]),t}(),Di={HighlightBar:Mi},Pi=function(){function t(e,i,r){Object(h["a"])(this,t),this.tqchart=e,this.managerId=i,this.typeClass=r,this.contents={}}return Object(u["a"])(t,[{key:"add",value:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];var n;this.contents[t]?(n=this.contents[t]).update.apply(n,i):this.contents[t]=Object(s["a"])(Di[this.typeClass],[this.tqchart,t].concat(i));return this.contents[t]}},{key:"each",value:function(t,e){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];for(var s in this.contents)if(this.contents[s]){var a=this.contents[s];a[t].apply(a,[e].concat(r))}}},{key:"get",value:function(t){return this.contents[t]||null}},{key:"remove",value:function(t){this.contents[t].clear(),delete this.contents[t]}},{key:"removeAll",value:function(){for(var t in this.contents)this.contents[t].clear(),delete this.contents[t]}}]),t}(),ji=function(){function t(){Object(h["a"])(this,t);var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.id,r=e.chart,n=e.board,s=e.boardId,a=e.parentG,o=e.type,c=e.yAlign,u=e.fill,l=e.fillOpacity,d=e.stroke,_=e.strokeWidth,f=e.strokeOpacity,m=e.strokeDasharray;this.id=i||(new Date).getTime(),this.chart=r,this.boardId=s||"main",this.board=n||this.chart.boards[this.boardId],this.parentG=a,this.g=a?a.append("g").attr("class",this.boardId+" mark "+o+" "+this.id):this.board.markG.append("g").attr("class",this.boardId+" mark "+o+" "+this.id),this.yAlign=c||"right",this.type=o,this.fill=u||"none",this.fillOpacity=l||.5,this.stroke=d||"#bbbbbb",this.strokeWidth=_||1,this.strokeOpacity=f||.5,this.strokeDasharray=m||"0",this._show=!0}return Object(u["a"])(t,[{key:"update",value:function(t){this.xPos1=void 0===t.xPos1?this.xPos1:t.xPos1,this.x1=void 0===t.x1?this.x1:t.x1,this.dt1=void 0===t.dt1?this.dt1:t.dt1,this.yPos1=void 0===t.yPos1?this.yPos1:t.yPos1,this.y1=void 0===t.y1?this.y1:t.y1,this.xPos2=void 0===t.xPos2?this.xPos2:t.xPos2,this.x2=void 0===t.x2?this.x2:t.x2,this.dt2=void 0===t.dt2?this.dt2:t.dt2,this.yPos2=void 0===t.yPos2?this.yPos2:t.yPos2,this.y2=void 0===t.y2?this.y2:t.y2}},{key:"show",value:function(){this.g&&!this._show&&(this._show=!0,this.g.attr("visibility","visible"))}},{key:"hide",value:function(){this.g&&this._show&&(this._show=!1,this.g.attr("visibility","hidden"))}},{key:"remove",value:function(){this.g.remove()}},{key:"revertSomeToPos",value:function(t){var e={x:null,y:null};return Number.isFinite(this["xPos"+t])?e.x=this["xPos"+t]:Number.isFinite(this["x"+t])?e.x=this.revertIdToPos(this["x"+t]):Number.isFinite(this["dt"+t])&&(e.x=this.revertIdToPos(this.revertDtToId(this["dt"+t]))),Number.isFinite(this["yPos"+t])?e.y=this["yPos"+t]:Number.isFinite(this["y"+t])&&(e.y=this.revertValueToYPos(this["y"+t])),e}},{key:"revertDtToId",value:function(t){var e=this.chart.mainSeries,i=[this.chart.range.leftId,this.chart.range.rightId],r=i[0],n=i[1];if(!e||!e.data||!e.data[r]||t<e.data[r].datetime)return null;var s=e.data[n]?n:e.last_id;if(t<=e.data[s].datetime)for(var a=r;a<s+1;a++)if(t-e.data[a].datetime<=0)return a;return null}},{key:"revertIdToPos",value:function(t){return Math.round(this.chart.xAxis.xScale(t))+Math.floor(this.chart.bar.barWidth/2)}},{key:"revertValueToYPos",value:function(t){return t&&this.board[this.yAlign+"YAxis"]?Math.round(this.board[this.yAlign+"YAxis"].yScale(t)):null}},{key:"isPointInChart",value:function(t){var e=t.x,i=t.y;return e>=0&&e<=this.chart.innerWidth&&i>=0&&i<=this.chart.innerHeight}}]),t}(),Ti=function(t){function e(t){var i;return Object(h["a"])(this,e),i=Object(a["a"])(this,Object(o["a"])(e).call(this,t)),i.type="text",i.xPos1=t.xPos1,i.x1=t.x1,i.dt1=t.dt1,i.yPos1=t.yPos1,i.y1=t.y1,i.text=t.text,i.size=t.size,i.textG=i.g.append("text").style("font-size",i.size).style("fill",i.fill),i}return Object(c["a"])(e,t),Object(u["a"])(e,[{key:"update",value:function(t){Object(n["a"])(Object(o["a"])(e.prototype),"update",this).call(this,t),this.text=void 0===t.text?this.text:t.text}},{key:"draw",value:function(){var t=this.revertSomeToPos("1");if(Number.isFinite(t.x)&&Number.isFinite(t.y)&&this.text)return this.show(),void this.textG.attr("x",t.x).attr("y",t.y).text(this.text);this.hide()}}]),e}(ji),Ci=function(t){function e(t){var i;return Object(h["a"])(this,e),i=Object(a["a"])(this,Object(o["a"])(e).call(this,t)),i.type="line",i.lineG=i.g.append("line"),i.lineG.style("fill","none").attr("stroke",i.stroke).attr("stroke-width",i.strokeWidth).attr("stroke-opacity",i.strokeOpacity).attr("stroke-dasharray",i.strokeDasharray),i.xPos1=t.xPos1,i.x1=t.x1,i.dt1=t.dt1,i.yPos1=t.yPos1,i.y1=t.y1,i.xPos2=t.xPos2,i.x2=t.x2,i.dt2=t.dt2,i.yPos2=t.yPos2,i.y2=t.y2,i.text=t.text,i.clamp=t.clamp,i}return Object(c["a"])(e,t),Object(u["a"])(e,[{key:"update",value:function(t){Object(n["a"])(Object(o["a"])(e.prototype),"update",this).call(this,t),this.x1=t.x1||this.x1,this.y1=t.y1||this.y1,this.text=void 0===t.text?this.text:t.text,this.clamp=void 0===t.clamp?this.clamp:t.clamp}},{key:"draw",value:function(){var t=this.revertSomeToPos("1"),e=this.revertSomeToPos("2");Number.isFinite(t.x)&&Number.isFinite(t.y)&&Number.isFinite(e.x)&&Number.isFinite(e.y)&&(this.clamp&&t.y-e.y<1e-6&&(t.y<0||e.y<0?t.y=e.y=0:(t.y>this.chart.innerHeight||e.y>this.chart.innerHeight)&&(t.y=e.y=this.chart.innerHeight)),this.lineG.attr("x1",t.x).attr("y1",t.y).attr("x2",e.x).attr("y2",e.y),this.show(),this.text&&(this.textG=this.textG||this.g.append("text"),this.textG.attr("x",t.x).attr("y",t.y).attr("dy",t.y<15?"12px":"-2px").text(this.text)))}}]),e}(ji),Ei=function(t){function e(t){var i;return Object(h["a"])(this,e),i=Object(a["a"])(this,Object(o["a"])(e).call(this,t)),i.type="rect",i.rectG=i.g.append("rect"),i.rectG.style("fill",i.fill).attr("fill-opacity",i.fillOpacity).attr("stroke",i.stroke).attr("stroke-width",i.strokeWidth).attr("stroke-opacity",i.strokeOpacity).attr("stroke-dasharray",i.strokeDasharray),i.xPos1=t.xPos1,i.x1=t.x1,i.dt1=t.dt1,i.yPos1=t.yPos1,i.y1=t.y1,i.xPos2=t.xPos2,i.x2=t.x2,i.dt2=t.dt2,i.yPos2=t.yPos2,i.y2=t.y2,i.width=t.width,i.height=t.height,i}return Object(c["a"])(e,t),Object(u["a"])(e,[{key:"update",value:function(t){Object(n["a"])(Object(o["a"])(e.prototype),"update",this).call(this,t),this.width=void 0===t.width?this.width:t.width,this.height=void 0===t.height?this.height:t.height}},{key:"draw",value:function(){var t=this.revertSomeToPos("1"),e=.5;if("none"===this.rectG.attr("stroke")&&(e=0),Number.isFinite(t.x)&&Number.isFinite(t.y)){if(Number.isFinite(this.width)&&Number.isFinite(this.height))return this.rectG.attr("x",t.x+e).attr("y",t.y+e).attr("width",this.width).attr("height",this.height),void this.show();var i=this.revertSomeToPos("2");if(Number.isFinite(i.x)&&Number.isFinite(i.y))return this.rectG.attr("x",t.x+e).attr("y",t.y+e).attr("width",Math.abs(i.x-t.x)).attr("height",Math.abs(i.y-t.y)),void this.show()}this.hide()}}]),e}(ji),qi=function(t){function e(t){var i;return Object(h["a"])(this,e),i=Object(a["a"])(this,Object(o["a"])(e).call(this,t)),i.type="arrow",i.arrowG=i.g.append("path"),i.arrowG.style("fill",i.fill).attr("stroke",i.stroke).attr("stroke-width",i.strokeWidth).attr("stroke-opacity",i.strokeOpacity).attr("stroke-dasharray",i.strokeDasharray),i.xPos1=t.xPos1,i.x1=t.x1,i.dt1=t.dt1,i.yPos1=t.yPos1,i.y1=t.y1,i.xPos2=t.xPos2,i.x2=t.x2,i.dt2=t.dt2,i.yPos2=t.yPos2,i.y2=t.y2,i.width=t.width,i.height=t.height,i.direction=t.direction,i}return Object(c["a"])(e,t),Object(u["a"])(e,[{key:"update",value:function(t){Object(n["a"])(Object(o["a"])(e.prototype),"update",this).call(this,t),this.width=void 0===t.width?this.width:t.width,this.height=void 0===t.height?this.height:t.height,this.direction=void 0===t.direction?this.direction:t.direction}},{key:"draw",value:function(){var t=this.revertSomeToPos("1"),e=this.width||this.chart.bar.barWidth,i=this.height||this.chart.bar.barWidth,r="up"===this.direction?1:-1,n="none"===this.stroke?0:.5;if(Number.isFinite(t.x)&&Number.isFinite(t.y)&&this.isPointInChart(t)){var s=Math.round(e/3),a="M ".concat(t.x+e/2," ").concat(t.y," l ").concat(-e/2," ").concat(r*i/2," l ").concat(s-n," 0 l 0 ").concat(r*i/2," l ").concat(s," 0 l 0 ").concat(-1*r*i/2," l ").concat(s," 0 z");this.arrowG.attr("d",a),this.show()}else this.hide()}}]),e}(ji),Ii=function(){function t(e){Object(h["a"])(this,t),this.chart=e,this.marks={}}return Object(u["a"])(t,[{key:"addMark",value:function(t){return t.id=t.id||(new Date).getTime(),this.marks[t.id]?this.marks[t.id].update(t):(t.chart=t.chart||this.chart,t.boardId=t.boardId||"main",t.board=t.board||this.chart.boards[t.boardId],t.yAlign=t.yAlign||"right","line"===t.type?this.marks[t.id]=new Ci(t):"rect"===t.type?this.marks[t.id]=new Ei(t):"arrow"===t.type?this.marks[t.id]=new qi(t):"text"===t.type?this.marks[t.id]=new Ti(t):this.chart.tqChartConsole.error("未支持 ".concat(t.type," 类型标记，[line|rect|arrow|text]"))),this.marks[t.id]}},{key:"removeMarkAll",value:function(){for(var t in this.marks)this.marks[t].remove(),delete this.marks[t]}},{key:"removeMark",value:function(t){this.marks[t]&&this.marks[t].remove(),delete this.marks[t]}},{key:"showMark",value:function(t){this.marks[t].show()}},{key:"hideMark",value:function(t){this.marks[t].hide()}},{key:"draw",value:function(){var t=this.chart.mainSeries,e=[this.chart.range.leftId,this.chart.range.rightId],i=e[0],r=e[1];if(r=t.data[r]?r:t.last_id,t.data[i]&&t.data[r]){var n=t.data[i].datetime,s=t.data[r].datetime;for(var a in this.marks){var o=this.marks[a];if("arrow"===o.type)if(o.dt1>=n&&o.dt1<=s){var c=this.marks[a].revertDtToId(o.dt1);this.marks[a].x1=c,this.marks[a].y1="up"===this.marks[a].direction?t.data[c].low:t.data[c].high,this.marks[a].draw()}else this.marks[a].hide();else this.marks[a].draw()}}}}]),t}(),Ai=function(){function t(e){Object(h["a"])(this,t),this.tqchart=e,this._board=null,this._g=null,this.trades={}}return Object(u["a"])(t,[{key:"add",value:function(t,e){this.trades[t]||(this.trades[t]=e)}},{key:"removeAll",value:function(){for(var t in this.g.select("path").remove(),this.trades)delete this.trades[t]}},{key:"revertValueToYPos",value:function(t){return t&&this.board.rightYAxis?Math.round(this.board.rightYAxis.yScale(t)):null}},{key:"draw",value:function(){var t=[],e={},i={},r=this.tqchart.mainSeries,n=[this.tqchart.range.leftId,this.tqchart.range.rightId],s=n[0],a=n[1];if(a=r.data[a]?a:r.last_id,r.data[s]&&r.data[a]){var o=[r.data[s].datetime,r.data[a].datetime],c=o[0],h=o[1];for(var u in this.trades){var l=this.trades[u];if(l.trade_date_time>=c&&l.trade_date_time<=h+this.tqchart.duration){var d=this.tqchart.chartController.revertDtToId(l.trade_date_time,s,a);if(!d)continue;if("BUY"===l.direction)if(e[d])e[d].volume+=l.volume;else{var _={x:this.tqchart.chartController.revertIdToPx(d),y:this.revertValueToYPos(r.data[d].low),dir:"up",diff:"OPEN"===l.offset?0:.5,width:this.tqchart.bar.barWidth,volume:l.volume};e[d]=_,t.push(_)}else if("SELL"===l.direction)if(i[d])i[d].volume+=l.volume;else{var f={x:this.tqchart.chartController.revertIdToPx(d),y:this.revertValueToYPos(r.data[d].high),dir:"down",diff:"OPEN"===l.offset?0:.5,width:this.tqchart.bar.barWidth,volume:l.volume};i[d]=f,t.push(f)}}}this.drawArrows(t)}}},{key:"drawArrows",value:function(t){var e=this.g.selectAll("path").data(t);e.enter().append("path").attr("class",(function(t){return t.dir})).attr("d",this.getArrowPath),e.merge(e).attr("class",(function(t){return t.dir})).attr("d",this.getArrowPath),e.exit().remove()}},{key:"getArrowPath",value:function(t){var e="up"===t.dir?1:-1,i=t.width,r=t.width,n=Math.round(r/3);return"M ".concat(t.x+r/2," ").concat(t.y," l ").concat(-r/2," ").concat(e*i/2," l ").concat(n-t.diff," 0 l 0 ").concat(e*i/2," l ").concat(n," 0 l 0 ").concat(-1*e*i/2," l ").concat(n," 0 z")}},{key:"board",get:function(){return null===this._board&&(this._board=this.tqchart.boards.main?this.tqchart.boards.main:null),this._board}},{key:"g",get:function(){return null===this._g&&(this._g=this.board.markG.append("g").attr("class","tradearrow")),this._g}}]),t}(),Wi=function(){function t(e){Object(h["a"])(this,t),this.tqchart=e,this._board=null,this._g=null,this.datetimeKeys=[],this.positions={}}return Object(u["a"])(t,[{key:"add",value:function(t,e){this.positions[t]||(this.positions[t]=e,e.datetime=t,e.volume_net=e.volume_long-e.volume_short,e.klineId=this.tqchart.chartController.revertDtToId(t),this.datetimeKeys=Object.keys(this.positions).sort())}},{key:"removeAll",value:function(){for(var t in this.g.select("rect").remove(),this.positions)delete this.positions[t]}},{key:"getPostionKlineId",value:function(t){return t.klineId?t.klineId:(t.klineId=this.tqchart.chartController.revertDtToId(t.datetime),t.klineId)}},{key:"revertValueToYPos",value:function(t){return t&&this.board.rightYAxis?Math.round(this.board.rightYAxis.yScale(t)):null}},{key:"draw",value:function(){var t=this.tqchart.mainSeries,e=[this.tqchart.range.leftId,this.tqchart.range.rightId],i=e[0],r=e[1];if(r=t.data[r]?r:t.last_id,t.data[i]&&t.data[r]){for(var n=[t.data[i].datetime,t.data[r].datetime],s=n[0],a=n[1],o=[],c=1;c<this.datetimeKeys.length;c++){var h=this.datetimeKeys[c-1],u=this.datetimeKeys[c];if(!(u<s)){if(s>a)break;var l=this.positions[h],d=this.positions[u],_=this.getPostionKlineId(l),f=this.getPostionKlineId(d);if(null!==_&&null!==f&&f-_>1&&0!==l.volume_net){var m=t.data[f].close-t.data[_].open;if(0!==l.volume_net&&0!==m){var p=Math.min(t.data[_].low,t.data[f].low),y=Math.max(t.data[_].high,t.data[f].high),g=l.volume_net*m>0?"profit":"loss";o.push({id:"rect"+_,x1:_,y1:y,x2:f+1,y2:p,className:g,stroke:"none"})}}}}this.drawPosRect(o)}}},{key:"drawPosRect",value:function(t){var e=this,i=this.g.selectAll("rect").data(t);i.enter().append("rect").attr("class",(function(t){return t.className})).attr("x",(function(t){return e.tqchart.chartController.revertIdToPx(t.x1)})).attr("y",(function(t){return e.revertValueToYPos(t.y1)})).attr("width",(function(t){return(t.x2-t.x1)*e.tqchart.bar.barWidth})).attr("height",(function(t){return e.revertValueToYPos(t.y2)-e.revertValueToYPos(t.y1)})),i.merge(i).attr("class",(function(t){return t.className})).attr("x",(function(t){return e.tqchart.chartController.revertIdToPx(t.x1)})).attr("y",(function(t){return e.revertValueToYPos(t.y1)})).attr("width",(function(t){return(t.x2-t.x1)*e.tqchart.bar.barWidth})).attr("height",(function(t){return e.revertValueToYPos(t.y2)-e.revertValueToYPos(t.y1)})),i.exit().remove()}},{key:"board",get:function(){return null===this._board&&(this._board=this.tqchart.boards.main?this.tqchart.boards.main:null),this._board}},{key:"g",get:function(){return null===this._g&&(this._g=this.board.markG.append("g").attr("class","posrect")),this._g}}]),t}(),Yi=function(){function t(e){Object(h["a"])(this,t),this.fullWidth=e,this.barWidth=t.BAR_WIDTH,this.barPadding=this._getBarPadding(),this.barNumbers=this._getBarNumbers()}return Object(u["a"])(t,[{key:"_getBarPadding",value:function(){return this.barWidth<=3?0:this.barWidth<=17?1:2}},{key:"_getBarNumbers",value:function(){return Math.floor(this.fullWidth/this.barWidth)}},{key:"zoom",value:function(e){if(0!==e){var i=e/Math.abs(e),r=this.barWidth+2*i;r<t.BAR_WIDTH_MIN||r>t.BAR_WIDTH_MAX||r===this.barWidth||(this.barWidth=r,this.barPadding=this._getBarPadding(),this.barNumbers=this._getBarNumbers())}}},{key:"setFullWidth",value:function(t){this.fullWidth=t,this.barNumbers=this._getBarNumbers()}}]),t}();Yi.BAR_WIDTH=9,Yi.BAR_WIDTH_MAX=35,Yi.BAR_WIDTH_MIN=1;var Li=function(){function t(e,i){Object(h["a"])(this,t),this.leftId=Number.isInteger(e)?e:-1,this.rightId=Number.isInteger(i)?i:-1}return Object(u["a"])(t,[{key:"reset",value:function(t,e){return!(!this.isInvalid()&&t===this.leftId&&e===this.rightId)&&(this.leftId=Number.isInteger(t)?t:-1,this.rightId=Number.isInteger(e)?e:-1,!0)}},{key:"isInvalid",value:function(){return-1===this.leftId||-1===this.rightId}},{key:"isEqual",value:function(t){return t.leftId===this.leftId&&t.rightId===this.rightId}},{key:"copy",value:function(e){e instanceof t&&(this.leftId=e.leftId,this.rightId=e.rightId)}}]),t}(),Ri=function(){function t(e){Object(h["a"])(this,t),this.tqchart=e,this.range=new Li}return Object(u["a"])(t,[{key:"_initRange",value:function(){var t=-1,e=-1;this.tqchart.mainSeries&&-1!==this.tqchart.mainSeries.last_id&&(e=this.tqchart.mainSeries.last_id,t=e-this.tqchart.bar.barNumbers+1),this.range.reset(t,e)}},{key:"getRange",value:function(){return this.range.isInvalid()&&this._initRange(),this.range}},{key:"init",value:function(){this._initRange()}},{key:"setRange",value:function(t,e){t>=0&&e>=t?this.range.reset(t,e):(this.tqchart.tqChartConsole.warn("setRange 不传入数据，表示指定移动到最后端"),this.range.reset(-1,-1))}},{key:"move",value:function(t){if(this.getRange().isInvalid())return this.tqchart.tqChartConsole.warn("move 拖动图表的时候，图表范围还未确定"),!1;var e=this.range.leftId-t,i=e+this.tqchart.bar.barNumbers-1;return e>=0&&e<=this.tqchart.mainSeries.last_id-this.tqchart.bar.barNumbers+10?this.range.reset(e,i):e<0?0!==this.range.leftId&&(e=0,i=e+this.tqchart.bar.barNumbers-1,this.range.reset(e,i)):e>=0&&t>0&&this.range.reset(e,i)}},{key:"zoom",value:function(){var t=-1,e=-1;return t=this.range.rightId>this.tqchart.mainSeries.last_id?this.tqchart.mainSeries.last_id-this.tqchart.bar.barNumbers+1:this.range.rightId-this.tqchart.bar.barNumbers+1,t=t<0?0:t,e=t+this.tqchart.bar.barNumbers-1,this.range.reset(t,e),!0}},{key:"revertIdToPx",value:function(t){return Math.round(this.tqchart.xAxis.xScale(t))}},{key:"revertDtToId",value:function(t,e,i){var r=this.tqchart.mainSeries;if(!r||!r.data||this.range.isInvalid())return null;var n=!1;e>=0&&i>e?n=!0:(e=this.range.leftId,i=this.range.rightId);var s=e,a=i;if(a=a<=r.last_id?a:r.last_id,!r.data[s]||!r.data[a])return null;if(t>=r.data[a].datetime&&t<r.data[a].datetime+this.tqchart.duration)return a;if(t>=r.data[s].datetime&&t<=r.data[a].datetime){for(var o=s;o<a+1&&r.data[o];o++)if(t-r.data[o].datetime<=0)return o>=1?o-1:o;return null}if(n)return null;if(t>r.data[a].datetime){if(a===r.last_id)return null;for(var c=a;c<r.last_id&&r.data[c]&&r.data[c];c++)if(t-r.data[c].datetime<=0)return c>=1?c-1:c;return null}if(t<r.data[s].datetime){if(0===s)return null;for(var h=s;h>=0&&r.data[h];h--)if(t-r.data[h].datetime>=0)return h;return null}}}]),t}(),Ni=function(t){function e(t){var i;return Object(h["a"])(this,e),i=Object(a["a"])(this,Object(o["a"])(e).call(this)),i.divDomId=t.id,i.outerWidth=t.width,i.outerHeight=t.height,i.margin=t.margin?t.margin:{top:15,right:50,bottom:20,left:80},i.innerWidth=i.outerWidth-i.margin.left-i.margin.right,i.innerHeight=i.outerHeight-i.margin.top-i.margin.bottom,i.mode="free",i.customRange=new Li,i.mainType="candle",i.bar=new Yi(i.innerWidth),i.range=new Li,i.symbol=t.symbol||t.instrumentId,i.duration=t.duration||6e10,i.price_decs=t.price_decs||2,i.price_ticks=t.price_ticks,i.mainSeries=t.mainSeries,i.chartController=new Ri(Object(r["a"])(i)),i.highlightManager=new Pi(Object(r["a"])(i),"highlight","HighlightBar"),i.tradeArrowManager=new Ai(Object(r["a"])(i)),i.positionManager=new Wi(Object(r["a"])(i)),i.tqChartConsole=mi("TqChart","plum"),i}return Object(c["a"])(e,t),Object(u["a"])(e,[{key:"setMode",value:function(t,e,i){"free"===t?(this.mode="free",e>=0&&i>=e?this.customRange.reset(e,i):this.customRange.reset()):"fixed"===t?e>=0&&i>=e?(this.mode="fixed",this.customRange.reset(e,i)):this.tqChartConsole.error("mode:fixed 必须指定 leftId rightId"):this.tqChartConsole.error("不支持 mode:".concat(t,"， 只支持 mode:[free|fixed]"))}},{key:"setRange",value:function(t,e){this.chartController.setRange(t,e),this.draw()}},{key:"setMainType",value:function(t){"candle"===t||"close"===t?this.mainType=t:this.tqChartConsole.error("mainType 只支持 [candle|close] => [K线图|收盘价线]")}},{key:"setMainSeries",value:function(t,e,i){t&&e&&i?(this.symbol=t,this.duration=e,this.mainSeries=i,this.backgroundText.text("".concat(this.symbol," ").concat(hi(this.duration))).attr("dy","-2"),this.chartController.init(),this.marksManager.removeMarkAll(),this.tradeArrowManager.removeAll(),this.positionManager.removeAll(),this._resetBoards(),this.draw()):this.tqChartConsole.error("setMainSeries 必须同时指定 symbol, duration, klines")}},{key:"addHighlightBar",value:function(t,e){this.highlightManager.add(t,e)}},{key:"addTradeArrow",value:function(t,e){this.tradeArrowManager.add(t,e)}},{key:"addPositionRecord",value:function(t,e){this.positionManager.add(t,e)}},{key:"init",value:function(){this._initSvgNode(),this._initEventListenners(),this.xAxis=new _e(this);var t=ve.GetMutilPlotsHeight(2,this.innerHeight);this.boards={main:new ve(this,"main",t[0].top,t[0].height,!1),sub:new ve(this,"sub",t[1].top,t[1].height,!0)},this.plots={mainkline:new Si({chart:this,boardId:"main",plotId:"candle",yAlign:"right",type:"candle"}),volume:new Si({chart:this,boardId:"sub",plotId:"volume",yAlign:"right",type:"volume"}),oi:new Si({chart:this,boardId:"sub",plotId:"oi",yAlign:"left",type:"oi"})},this.marksManager=new Ii(this),this.crosshair=new me(this),this.chartController.init()}},{key:"_initSvgNode",value:function(){this.svg=Object(d["j"])("#"+this.divDomId).append("svg").attr("class","tqchart").attr("width",this.outerWidth).attr("height",this.outerHeight),this.defs=this.svg.append("defs");var t="mask-global";this.maskGlobal=e.AppendMask(this.defs,t,this.innerWidth,this.innerHeight,0,0);var i=[this.margin.left,this.margin.top],r=i[0],n=i[1];this.backgroundG=e.AppendG(this.svg,"background global",r,n),this.boardBackgroundG=e.AppendG(this.svg,"boardBackground global",r,n),this.rootG=e.AppendG(this.svg,"root global",r,n),this.crosshairG=e.AppendG(this.svg,"crosshair global",r,n),this.loadingG=e.AppendG(this.svg,"loading global",r,n),this.bgShapesG=e.AppendG(this.svg,"bgShapes global",r,n,t),this.backgroundText=this.backgroundG.append("g").append("text"),this.backgroundText.text("".concat(this.symbol," ").concat(hi(this.duration))).attr("dy","-2"),this.markG=this.rootG.append("g")}},{key:"_debounce",value:function(t,e){var i=null;return function(){var r=this,n=arguments;clearTimeout(i),i=setTimeout((function(){t.apply(r,n)}),e)}}},{key:"_initEventListenners",value:function(){var t=this;this.svg.on("mousemove",(function(){var e=Object(d["h"])(this),i=te(e,2),r=i[0],n=i[1];r>t.margin.left&&r<t.margin.left+t.innerWidth&&n>t.margin.top&&n<t.margin.top+t.innerHeight&&t.crosshair.update(r-t.margin.left,n-t.margin.top)})),this.svg.on("mouseover",(function(){null===e&&t.crosshair.show()})),this.svg.on("mouseleave",(function(){t.crosshair.hide()}));var e=null,i=Object(d["d"])().on("start",(function(){e=d["e"].x,t.crosshair.hide(),t.crosshair.drag(!0)})).on("drag",(function(){var i=Math.round((d["e"].x-e)/t.bar.barWidth);this.bar=new Yi(this.innerWidth),Math.abs(i)>0&&(e=d["e"].x,t.move(i))})).on("end",(function(){e=null,t.crosshair.show(),t.crosshair.drag(!1)}));this.svg.call(i);var r=Object(d["r"])().on("zoom",(function(){var e=d["e"].sourceEvent.deltaY;Math.abs(e)>0&&t._debounce(t.zoom,200).bind(t)(e>0?-2:2)}));this.svg.call(r).on("dblclick.zoom",null)}},{key:"getBoardByYPosition",value:function(t){for(var e in this.boards)if(t>=this.boards[e].top&&t<=this.boards[e].top+this.boards[e].height)return this.boards[e]}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.height,i=t.width;this.tqChartConsole.log("onresize",i),this.outerWidth=i,this.outerHeight=e,this.innerWidth=this.outerWidth-this.margin.left-this.margin.right,this.innerHeight=this.outerHeight-this.margin.top-this.margin.bottom,this.svg.attr("width",this.outerWidth).attr("height",this.outerHeight),this.bar.setFullWidth(this.innerWidth),this.xAxis.resetPosition(),this.chartController.zoom();var r=ve.GetMutilPlotsHeight(Object.keys(this.boards).length,this.innerHeight),n=0;for(var s in this.boards)this.boards[s].resetPosition(r[n++]);this.crosshair.resize(),this.draw()}},{key:"_resetBoards",value:function(){for(var t in this.boards)"main"!==t&&"sub"!==t&&(this.boards[t].remove(),delete this.boards[t]);var e=ve.GetMutilPlotsHeight(2,this.innerHeight);for(var i in this.boards.main.resetPosition(e[0]),this.boards.sub.resetPosition(e[1]),this.plots)"mainkline"!==i&&"volume"!==i&&"oi"!==i&&(this.plots[i].remove(),delete this.plots[i])}},{key:"_updateBoards",value:function(){var t=ve.GetMutilPlotsHeight(Object.keys(this.boards).length,this.innerHeight),e=0;for(var i in this.boards)this.boards[i].resetPosition(t[e++])}},{key:"addSeries",value:function(t,e){this.tqChartConsole.log("addSeries",t,e);var i=e.board?e.board.toLowerCase():"main";this.boards[i]||(this.boards[i]=new ve(this,i,this.innerHeight,0,!0),this._updateBoards()),"KSERIAL"!==e.type&&"SERIAL"!==e.type||this.plots[t]||("KSERIAL"===e.type?this.plots[t]=new Si({chart:this,boardId:i,plotId:t,yAlign:e.yAlign,type:"candle",data:e.data}):"SERIAL"===e.type&&(this.plots[t]=new Si({chart:this,boardId:i,plotId:t,yAlign:e.yAlign,type:e.style.toLowerCase(),data:e.data,color:yi(e.color),width:e.width,dash:"dash"===e.style.toLowerCase()}))),"TEXT"===e.type?this.addMark({id:t,boardId:e.board.toLowerCase(),type:"text",x1:e.x1,y1:e.y1,fill:yi(e.color),size:e.size,text:e.text}):"LINE"===e.type||"SEG"===e.type||"RAY"===e.type?this.addMark({id:t,boardId:e.board.toLowerCase(),type:"line",x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,stroke:yi(e.color),strokeWidth:e.width,text:"",clamp:!1}):"BOX"===e.type&&this.addMark({id:t,boardId:e.board.toLowerCase(),type:"rect",x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,fill:yi(e.bg_color),stroke:yi(e.color),strokeWidth:e.width||1}),this.draw()}},{key:"addMark",value:function(t){this.marksManager.addMark(t)}},{key:"removeMark",value:function(t){this.marksManager.removeMark(t)}},{key:"removeMarkAll",value:function(){this.marksManager.removeMarkAll()}},{key:"showMark",value:function(t){this.marksManager.showMark(t)}},{key:"hideMark",value:function(t){this.marksManager.hideMark(t)}},{key:"move",value:function(t){"fixed"!==this.mode&&this.chartController.move(t)&&this.draw()}},{key:"zoom",value:function(t){if("fixed"!==this.mode){var e=this.bar.barWidth;this.bar.zoom(t),e!==this.bar.barWidth&&(this.highlightManager.each("resize"),this.chartController.zoom(),this.xAxis.resetPosition(),this.draw())}}},{key:"readyToDraw",value:function(){return this.dm.readyToDraw()}},{key:"draw",value:function(){if(-1!==this.mainSeries.last_id){this.mainSeries.last_id-this.range.rightId===1&&this.chartController.setRange(this.mainSeries.last_id-this.bar.barNumbers+1,this.mainSeries.last_id);var t=this.chartController.getRange(),e=t.leftId,i=t.rightId;this.xAxis.draw(e,i,this.mainSeries.data);var r={};for(var n in this.plots){var s=this.plots[n].getYDomain(e,i,this.plots[n].data||this.mainSeries.data),a=this.plots[n].boardId,o=this.plots[n].yAlign;r[a]=r[a]||{left:[1/0,-1/0],right:[1/0,-1/0]},r[a][o][0]=Math.min(r[a][o][0],s[0]),r[a][o][1]=Math.max(r[a][o][1],s[1])}for(var c in this.boards){var h=r[c];h&&(this.boards[c].setDomain(h.left,"left"),this.boards[c].setDomain(h.right,"right"),this.boards[c].draw(e,i,this.mainSeries.data))}for(var u in this.plots)this.plots[u].draw(e,i,this.plots[u].data||this.mainSeries.data);this.marksManager.draw(),this.highlightManager.each("draw"),this.tradeArrowManager.draw(),this.positionManager.draw(),this.chartController.range.isEqual(this.range)||(this.range.copy(this.chartController.range),this.emit("showRangeChanged",this.range))}}},{key:"_drawBackground",value:function(t,e,i){var r=this.tqsdk.get_quote(this.symbol);if(r&&r.trading_time){var n=[],s=Object(d["l"])("%H:%M:%S"),a=Object(d["l"])("%d");if(this.duration<=6e10){var o=[];for(var c in r.trading_time.day)o.push(r.trading_time.day[c][0]);if(r.trading_time.night&&r.trading_time.night.length>0)for(var h in r.trading_time.night)o.push(r.trading_time.night[h][0]);for(var u=t;u<=e;u++)i[u]&&o.indexOf(s(i[u].datetime/1e6))>-1&&n.push((u-t)*this.bar.barWidth+this.bar.barWidth/2)}else if(this.duration<864e11){var l=[],_=r.trading_time.night?"night":"day";l.push(r.trading_time[_][0][0]);for(var f=t;f<=e;f++)i[f]&&l.indexOf(s(i[f].datetime/1e6))>-1&&n.push((f-t)*this.bar.barWidth+this.bar.barWidth/2)}else if(this.duration<=432e12)for(var m=t;m<=e;m++)i[m]&&i[m-1]&&a(i[m].datetime/1e6)<a(i[m-1].datetime/1e6)&&n.push((m-t)*this.bar.barWidth+this.bar.barWidth/2);var p=this.backgroundG.selectAll("line").data(n);p.enter().append("line").attr("y1",0).attr("y2",this.innerHeight).attr("stroke","#E6E6E6").attr("stroke-dasharray","12 6").attr("x1",(function(t){return t})).attr("x2",(function(t){return t})),p.merge(p).attr("x1",(function(t){return t})).attr("x2",(function(t){return t})),p.exit().remove()}}}]),e}(ne);Ni.AppendG=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=t.append("g").attr("class",e);return 0===i&&0===r||s.attr("transform","translate(".concat(i,",").concat(r,")")),n&&s.attr("mask","url(#".concat(n,")")),s},Ni.AppendMask=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return t.append("mask").attr("id",e).append("rect").attr("x",n).attr("y",s).attr("width",i).attr("height",r).style("fill","#FFFFFF").attr("stroke","none")},Ni.version=_,e["a"]=Ni}).call(this,i("c8ba"))},cf05:function(t,e,i){t.exports=i.p+"img/logo.165e0f64.png"},d85d:function(t,e,i){},dcf3:function(t,e,i){},f451:function(t,e,i){"use strict";var r=i("5c44"),n=i.n(r);n.a},f6c5:function(t,e,i){}});