(function(t){function e(e){for(var a,r,o=e[0],d=e[1],c=e[2],l=0,h=[];l<o.length;l++)r=o[l],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&h.push(s[r][0]),s[r]=0;for(a in d)Object.prototype.hasOwnProperty.call(d,a)&&(t[a]=d[a]);u&&u(e);while(h.length)h.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,o=1;o<n.length;o++){var d=n[o];0!==s[d]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},s={app:0},i=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],d=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=d;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"07f6":function(t,e,n){},"19da":function(t,e,n){"use strict";var a=n("dcf3"),s=n.n(a);s.a},"1a2d3":function(t,e,n){"use strict";var a=n("f6c5"),s=n.n(a);s.a},2975:function(t,e,n){"use strict";var a=n("8fde"),s=n.n(a);s.a},"2dac":function(t,e,n){"use strict";var a=n("5a46"),s=n.n(a);s.a},"326a":function(t,e,n){"use strict";var a=n("6491"),s=n.n(a);s.a},4678:function(t,e,n){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=i(t);return n(e)}function i(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}s.keys=function(){return Object.keys(a)},s.resolve=i,t.exports=s,s.id="4678"},5096:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("4de4"),n("c975"),n("a9e3"),n("f00c"),n("8ba4"),n("b680"),n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=n("c1df"),i=n.n(s),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("tianqin")],1)},o=[],d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tq-home"},[n("div",{staticClass:"layout-area header-container"},[n("tq-header-view",{attrs:{height:t.headerHeight,width:t.$root.windowWidth}})],1),n("div",{staticClass:"layout-area top-container",style:{height:t.topHeight+"px"}},[n("tq-top-view",{attrs:{height:t.topHeight,width:t.$root.windowWidth}})],1),n("div",{staticClass:"layout-area bottom-container",style:{height:t.bottomHeight+"px",top:t.bottomYOffset+4+"px",backgroundColor:"#FEFEFE",boxShadow:t.showBottomShadow?"0px -3px 4px -1px #AFAFAF":""}},[n("div",{staticClass:"bottom-area-handle",on:{mousedown:t.handleMousedown}}),n("tq-bottom-view",{attrs:{height:t.bottomHeight,width:t.$root.windowWidth}})],1)])},c=[],u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tq-header-view"},[a("tq-layout-area",{attrs:{height:t.height,otherStyle:{backgroundColor:"#FEFEFE"}}},[a("a",{attrs:{href:"https://www.shinnytech.com/tianqin/",target:"_blank"}},[a("img",{staticClass:"logo",style:{padding:"4px",width:t.height+"px",height:t.height+"px"},attrs:{alt:"Tianqin",src:n("cf05")}})])]),a("tq-layout-area",{attrs:{height:t.height,left:t.height,width:240,otherStyle:{paddingTop:"8px"}}},[t._v(" "+t._s(t.$store.state.file_name)+" ")]),a("tq-layout-area",{attrs:{height:t.height,left:t.height+240,width:380,otherStyle:{paddingTop:"8px",backgroundColor:"backtest"===t.$store.state.mode?"#FAF5EA":"replay"===t.$store.state.mode?"#F0E2FA":"#FFF"}}},["run"===t.$store.state.mode?a("div",[t._v("账户："+t._s(t.$store.state.broker_id)+","+t._s(t.$store.state.account_id)+" ")]):t._e(),"backtest"===t.$store.state.mode?a("div",[t._v("回测区间： "+t._s(t.formatDt(t.$store.state.start_dt))+" -- "+t._s(t.formatDt(t.$store.state.end_dt))+" ")]):t._e(),"replay"===t.$store.state.mode?a("div",[a("tq-replay-ctrl")],1):t._e()]),a("tq-layout-area",{attrs:{height:t.height,width:160,horizontalAlign:"right",otherStyle:{paddingTop:"8px"}}},[a("Badge",{attrs:{color:t.$store.state.py_file_status?"green":"red",text:"py文件"}}),a("Badge",{attrs:{color:t.$store.state.md_url_status?"green":"red",text:"行情"}}),a("Badge",{attrs:{color:t.$store.state.td_url_status?"green":"red",text:"交易"}})],1)],1)},l=[],h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tq-layout-absolute",style:t.computedStyle},[t._t("default")],2)},f=[],p={name:"tq-layout-absolute",data:function(){return{}},props:{horizontalAlign:{type:String,default:"left"},verticalAlign:{type:String,default:"top"},top:{type:Number,default:0},left:{type:Number,default:0},bottom:{type:Number,default:0},right:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0},otherStyle:{type:Object,default:function(){}}},computed:{computedStyle:function(){var t={width:this.width+"px",height:this.height+"px"};return t[this.horizontalAlign]=this[this.horizontalAlign]+"px",t[this.verticalAlign]=this[this.verticalAlign]+"px",Object.assign(t,this.otherStyle)}}},m=p,_=(n("b9e2"),n("2877")),b=Object(_["a"])(m,h,f,!1,null,null,null),g=b.exports,v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"replay-control"},[t._v(" 复盘日期： "+t._s(t.currentDateTime?t.currentDateTime:t.formatDt(t.$store.state.replay_dt))+" ("+t._s(this.currentSpeed)+") "),n("ButtonGroup",{attrs:{size:"small"}},[n("Button",{on:{click:function(e){return t.ctrl("play")}}},[n("Icon",{attrs:{type:"ios-play"}})],1),n("Button",{on:{click:function(e){return t.ctrl("pause")}}},[n("Icon",{attrs:{type:"ios-pause"}})],1),n("Button",{on:{click:function(e){return t.ctrl("rewind")}}},[n("Icon",{attrs:{type:"ios-rewind"}})],1),n("Button",{on:{click:function(e){return t.ctrl("fastforward")}}},[n("Icon",{attrs:{type:"ios-fastforward"}})],1)],1)],1)},y=[],w=(n("a4d3"),n("e01a"),n("d28b"),n("a15b"),n("fb6a"),n("d3b7"),n("3ca3"),n("ddb0"),n("2f62"));a["a"].use(w["a"]);var k=new w["a"].Store({state:{mode:"",broker_id:"",account_id:"",py_file_status:"",md_url_status:"",td_url_status:"",file_path:"",file_name:""},mutations:{set_action:function(t,e){Object.assign(t,e)},set_py_file_status:function(t,e){t.py_file_status=e}},actions:{}}),q=k,x={name:"tq-replay-control",data:function(){return{currentSpeed:"-",currentDateTime:""}},props:{width:Number},computed:{replayUrl:function(){return this.$store.state.ctrl_url}},methods:{setSpeed:function(t){fetch(this.replayUrl,{method:"POST",body:JSON.stringify({aid:"ratio",speed:t})}).then((function(t){console.log(t)}))},ctrl:function(t){"play"===t?("-"===this.currentSpeed&&(this.currentSpeed=1),this.setSpeed(this.currentSpeed)):"pause"===t?this.setSpeed(0):"rewind"===t?("-"===this.currentSpeed?this.currentSpeed=1:this.currentSpeed<=5?this.currentSpeed=Math.max(1,this.currentSpeed-1):this.currentSpeed<=40?this.currentSpeed-=5:this.currentSpeed<=100&&(this.currentSpeed-=10),this.setSpeed(this.currentSpeed)):"fastforward"===t&&("-"===this.currentSpeed?this.currentSpeed=2:this.currentSpeed<5?this.currentSpeed+=1:this.currentSpeed<40?this.currentSpeed+=5:this.currentSpeed<100?this.currentSpeed+=10:this.currentSpeed=100,this.setSpeed(this.currentSpeed))},formatDt:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";return i()(t/1e6).format(e)}},mounted:function(){var t=this,e=["KQ.m@SHFE.au","KQ.m@SHFE.ag","KQ.m@CFFEX.T","KQ.m@CFFEX.TF"];this.$tqsdk.on("rtn_data",(function(){var n=t.$tqsdk.getByPath(["ins_list"]);""!==n&&-1!==n.indexOf("KQ.m@SHFE.au")&&-1!==n.indexOf("KQ.m@SHFE.ag")&&-1!==n.indexOf("KQ.m@CFFEX.T")&&-1!==n.indexOf("KQ.m@CFFEX.TF")||(n+=(n?",":"")+e.join(","),t.$tqsdk.subscribe_quote(n));var a=!0,s=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){var d=r.value,c=t.$tqsdk.get_by_path(["quotes",d,"datetime"]);t.currentDateTime=c&&c>t.currentDateTime?c.slice(0,19):t.currentDateTime}}catch(u){s=!0,i=u}finally{try{a||null==o.return||o.return()}finally{if(s)throw i}}}))}},C=x,j=(n("2dac"),Object(_["a"])(C,v,y,!1,null,null,null)),S=j.exports,$={name:"tq-header-view",components:{TqLayoutArea:g,TqReplayCtrl:S},props:{height:Number},methods:{formatDt:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return i()(t/1e6).format(e)}}},z=$,O=(n("8e24"),Object(_["a"])(z,u,l,!1,null,null,null)),T=O.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tq-top-view"},[n("tq-layout-area",{staticClass:"left-view",attrs:{height:t.height,width:t.chartWidth}},[n("tq-layout-area",{attrs:{height:26,width:300}},[n("button-group-durations",{attrs:{duration:t.duration},on:{onChangeDuration:t.onChangeDuration}})],1),n("tq-layout-area",{attrs:{top:26}},[n("tq-chart-components",{attrs:{instrumentId:t.instrumentId,duration:t.duration,height:t.height-26,width:t.chartWidth,theme:t.theme}})],1)],1),n("tq-layout-area",{staticClass:"right-view",attrs:{height:t.height,width:t.rightWidth,horizontalAlign:"right"}},["backtest"!==t.$store.state.mode?n("tq-layout-area",{attrs:{height:t.rightClosed?t.height-35:160,width:t.rightWidth}},["backtest"!==t.$store.state.mode?n("quote-info",{attrs:{symbol:t.instrumentId,height:t.rightClosed?t.height-35:160,width:t.rightWidth}}):t._e()],1):t._e(),n("tq-layout-area",{attrs:{top:"backtest"!==t.$store.state.mode?160:0,height:t.rightClosed?0:18,width:t.rightWidth,otherStyle:{backgroundColor:"lightgrey",color:"#333333",fontSize:"12px",fontWeight:"700",overflow:"hidden"}}},[t._v(" 订阅合约列表 ")]),n("tq-layout-area",{attrs:{verticalAlign:"bottom",bottom:35,height:t.rightClosed?0:t.height-("backtest"!==t.$store.state.mode?160:0)-18-35,width:t.rightWidth,otherStyle:{overflowY:"scroll"}}},[n("subscribed-list",{on:{onChange:t.onChangeSelectedSubscribed}})],1),n("tq-layout-area",{attrs:{verticalAlign:"bottom",height:35,width:t.rightWidth}},[n("about-us",{attrs:{width:t.rightWidth}})],1),"backtest"!==t.$store.state.mode?n("div",{staticClass:"right-resize-tool",on:{click:t.toggleRightClosed}},[t.rightClosed?n("Icon",{attrs:{type:"ios-arrow-back"}}):n("Icon",{attrs:{type:"ios-arrow-forward"}})],1):t._e()],1)],1)},N=[],A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tq-button-group-durations"},[n("RadioGroup",{attrs:{type:"button",size:"small"},model:{value:t.selectedPeriod,callback:function(e){t.selectedPeriod=e},expression:"selectedPeriod"}},t._l(t.periods,(function(t){return n("Radio",{key:t,attrs:{label:t}})})),1)],1)},F=[],M=(n("4160"),n("b64b"),n("07ac"),n("159b"),{"1m":6e10,"5m":3e11,"15m":9e11,"30m":18e11,"1h":36e11,"1d":864e11}),D={data:function(){return{periods:Object.keys(M),selectedPeriod:"",selectedDuration:null}},props:{duration:Number},watch:{duration:function(){if(this.duration!==this.selectedDuration){var t=Object.values(M).indexOf(this.duration);t>-1?(this.selectedPeriod=M[t],this.selectedDuration=this.duration):(this.selectedPeriod="",this.selectedDuration=null)}},selectedPeriod:function(){document.querySelectorAll(".tq-button-group-durations input[type=radio]").forEach((function(t){return t.blur()})),this.selectedDuration=M[this.selectedPeriod],this.selectedPeriod&&this.selectedDuration&&this.$emit("onChangeDuration",this.selectedDuration)}}},I=D,H=(n("326a"),Object(_["a"])(I,A,F,!1,null,null,null)),P=H.exports,Y=(n("99af"),n("6029")),L=(n("22fe"),"web_chart"),W="web_chart_focus",R=null,B=null,Q={name:"tq-chart-components",data:function(){return{id:"TQ-CHART",action:"run"}},props:{instrumentId:{type:String,default:"TQ.m@SHFE.au"},duration:{type:Number,default:6e10},width:Number,height:Number,theme:{type:String,default:"light"}},render:function(t){var e={class:{"theme-light":"light"===this.theme,"theme-dark":"dark"===this.theme},attrs:{id:this.id}};return t("div",e)},watch:{instrumentId:function(t,e){B.removeMarkAll(),this.$nextTick(this.updateTqChart)},duration:function(t,e){B.removeMarkAll(),this.$nextTick(this.updateTqChart)},width:function(t,e){B&&B.resize({width:t,height:this.height})},height:function(t,e){B&&B.resize({width:this.width,height:t})}},created:function(){R=this.$tqsdk.get({name:"klines",symbol:this.instrumentId,duration:this.duration}),B=new Y["a"]({id:this.id,instrumentId:this.instrumentId,duration:this.duration,height:this.height,width:this.width,mainSeries:R});var t="free",e=3,n=this;B.on("showRangeChanged",(function(a){if(-1!==a.rightId&&-1!==a.leftId)if("fixed"===t){var s=864e11;n.$tqsdk.set_chart({chart_id:L,symbol:n.instrumentId,duration:n.duration,trading_day_start:s*(1-e),trading_day_count:s*e})}else if("free"===t){var i=a.rightId-a.leftId;n.$tqsdk.set_chart({chart_id:L,symbol:n.instrumentId,duration:n.duration,left_kline_id:Math.max(a.leftId-i,0),view_width:3*i})}}))},mounted:function(){B.init();var t=this;this.$tqsdk.on("rtn_data",(function(){if(t.updatePositionLine(),t.updateTrades(),t.updateTqSdkChartData(),t.updatePositionRect(),"run"===t.action&&"backtest"===t.$tqsdk.get_by_path(["action","mode"])){var e=t.$store.state.account_id;if(e){var n=t.$tqsdk.get({name:"trades",user_id:e});for(var a in n){var s=n[a];B&&B.symbol&&B.duration&&(t.$tqsdk.set_chart({chart_id:W,symbol:B.symbol,duration:B.duration,view_width:B.bar.barNumbers,focus_datetime:s.trade_date_time,focus_position:Math.floor(B.bar.barNumbers/2)}),t.action="backtest");break}}}var i=t.$tqsdk.get_by_path(["charts",W]);if(i&&!i.more_data&&i.left_id&&i.right_id){var r=[i.left_id,i.right_id],o=r[0],d=r[1];B.setRange(o,d),B.addHighlightBar("movetoid",o+Math.round(B.bar.barNumbers/2-2)),t.$tqsdk.set_chart({chart_id:W,symbol:"",duration:B.duration,view_width:0})}else{var c=t.$tqsdk.get_by_path(["charts",L,"more_data"]);!c&&t.$tqsdk.is_changed(R)&&B.draw()}})),this.$eventHub.$on("moveChartToDt",(function(t){this.$tqsdk.set_chart({chart_id:W,symbol:B.symbol,duration:B.duration,view_width:B.bar.barNumbers,focus_datetime:t,focus_position:Math.floor(B.bar.barNumbers/2)})}))},methods:{updateTqChart:function(){if(this.$tqsdk.set_chart({chart_id:L,symbol:this.instrumentId,duration:this.duration,view_width:1e3}),R=this.$tqsdk.get({name:"klines",symbol:this.instrumentId,duration:this.duration}),B){var t=this.$tqsdk.get_quote(this.instrumentId);B.setMainSeries(this.instrumentId,this.duration,R),B.price_decs=t.price_decs,this.$nextTick((function(){this.updateTqSdkChartData(),this.updateTrades(!0),this.updatePositionRect(!0)}))}},updateTqSdkChartData:function(){var t=this.$tqsdk.get_by_path(["draw_chart_datas",B.symbol,B.duration]);if(t)for(var e in t)B.addSeries(e,t[e])},updatePositionLine:function(t){var e=this.$store.state.account_id;if(e){var n=this.$tqsdk.get({name:"position",user_id:e,symbol:B.symbol});n&&n.volume_long>0?B.addMark({id:"pos_long",type:"line",boardId:"main",yAlign:"right",xPos1:0,xPos2:B.innerWidth,y1:n.open_price_long,y2:n.open_price_long,stroke:"red",text:"多仓".concat(n.volume_long,"手@").concat(n.open_price_long)}):B.removeMark("pos_long"),n&&n.volume_short>0?B.addMark({id:"pos_short",type:"line",boardId:"main",yAlign:"right",xPos1:0,xPos2:B.innerWidth,y1:n.open_price_short,y2:n.open_price_short,stroke:"green",text:"空仓".concat(n.volume_short,"手@").concat(n.open_price_short)}):B.removeMark("pos_short")}},updateTrades:function(t){var e=this.$store.state.account_id;if(e){var n=this.$tqsdk.get({name:"trades",user_id:e});for(var a in n){var s=n[a];t?s.volume>0&&s.symbol===B.symbol&&B.addTradeArrow(a,s):s._epoch===this.$tqsdk.dm._epoch&&s.volume>0&&s.symbol===B.symbol&&B.addTradeArrow(a,s)}}},updatePositionRect:function(t){var e=this.$tqsdk.get_by_path(["snapshots"]);for(var n in e){var a=e[n];t?a.positions&&a.positions.hasOwnProperty(B.symbol)&&B.addPositionRecord(n,a.positions[B.symbol]):a._epoch===this.$tqsdk.dm._epoch&&a.positions&&a.positions.hasOwnProperty(B.symbol)&&B.addPositionRecord(n,a.positions[B.symbol])}}}},U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"subscribed-list"},[t._l(t.subscribedSymbols,(function(e){return[t._l(t.subscribed[e],(function(a){return[n("Button",{attrs:{size:"small",long:""},on:{click:function(n){return t.onClick(e,a)}}},[t._v(" "+t._s(e)+" "+t._s(t.ParseDuartionToString(a))+" ")])]}))]}))],2)},G=[];n("caad"),n("2532"),n("a434"),n("ac1f"),n("1276"),n("bf2d");function K(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"number"===typeof t?t.toFixed(e):t}function V(t){switch(t){case"BUY":return"买";case"SELL":return"卖";default:return t}}function X(t){switch(t){case"OPEN":return"开";case"CLOSE":return"平";case"CLOSETODAY":return"平今";default:return t}}function J(t){var e="";if(t&&t>=1e9){var n=i.a.duration(t/1e9,"seconds");n.years()>0&&(e+=n.years()+"Y"),n.months()>0&&(e+=n.months()+"M"),n.days()>0&&(e+=n.days()+"D"),n.hours()>0&&(e+=n.hours()+"h"),n.minutes()>0&&(e+=n.minutes()+"m"),n.seconds()>0&&(e+=n.seconds()+"s")}return e}var Z=[],tt={},et={data:function(){return{subscribedSymbols:Z,subscribed:tt}},props:{},watch:{subscribedSymbols:function(t,e){console.log(t,e)}},mounted:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$tqsdk.getByPath(["subscribed"]);if(e&&e._epoch===t.$tqsdk.dm._epoch){for(var n in e){var a=e[n];if(Array.isArray(a.symbol))for(var s in a.symbol)t.addSubscribed(a.symbol[s],a.dur_nano);else t.addSubscribed(a.symbol,a.dur_nano)}t.updateSubscribedSymbols()}}))},methods:{addSubscribed:function(t,e){tt[t]||(tt[t]=[]),e||(e=""),tt[t].includes(e)||tt[t].push(e)},updateSubscribedSymbols:function(){for(var t in tt)-1===Z.indexOf(t)&&Z.push(t)},onClick:function(t,e){this.$emit("onChange",t,e)},ParseDuartionToString:J}},nt=et,at=Object(_["a"])(nt,U,G,!1,null,null,null),st=at.exports,it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"quote-info-container"},[n("Row",{attrs:{"class-name":"quote-items-title"}},[n("Col",{attrs:{span:t.largeSize?12:24}},[n("div",[t._v(t._s(t.quote.ins_name))])]),n("Col",{attrs:{span:t.largeSize?12:24}},[n("div",[t._v(t._s(t.quote.ins_id))])])],1),n("Row",[n("Col",{attrs:{span:t.largeSize?6:12}},[n("div",[t._v("卖一")])]),n("Col",{attrs:{span:t.largeSize?9:12}},[n("div",[t._v(t._s(t.formatter(t.quote.ask_price1)))])]),n("Col",{attrs:{span:t.largeSize?9:"0"}},[t._v(" "+t._s(t.quote.ask_volume1)+" ")])],1),n("div",{staticClass:"outer"},[n("div",{staticClass:"inner",style:{width:100*t.innerWidth+"%"}})]),n("Row",[n("Col",{attrs:{span:t.largeSize?6:12}},[t._v(" 买一 ")]),n("Col",{attrs:{span:t.largeSize?9:12}},[t._v(" "+t._s(t.formatter(t.quote.bid_price1)))]),n("Col",{attrs:{span:t.largeSize?9:"0"}},[t._v(" "+t._s(t.quote.bid_volume1)+" ")])],1),n("Row",{attrs:{"class-name":"quote-items "+(t.largeSize?"large-size":"")}},[n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 最新价 ")]),n("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.last_price))+" ")]),n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 昨结算 ")]),n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.pre_settlement))+" ")]),n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 涨跌 ")]),n("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.change))+" ")]),n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 今开 ")]),n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.quote.open)+" ")]),n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 涨跌幅 ")]),n("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t._f("toFixed")(t.quote.change_percent))+"% ")]),n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 最高 ")]),n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.highest))+" ")]),n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 总手 ")]),n("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatterVolume(t.quote.volume))+" ")]),n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 最低 ")]),n("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.lowest))+" ")]),n("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 涨停 ")]),n("Col",{staticClass:"R",attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.upper_limit))+" ")]),n("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 收盘 ")]),n("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.close))+" ")]),n("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 跌停 ")]),n("Col",{staticClass:"G",attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.lower_limit))+" ")]),n("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 结算 ")]),n("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.settlement))+" ")]),n("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 持仓量 ")]),n("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.quote.open_interest))]),n("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 日增")]),n("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(Number.isNaN(t.quote.open_interest-t.quote.pre_open_interest)?"-":t.quote.open_interest-t.quote.pre_open_interest))])],1)],1)},rt=[],ot={ins_name:"-",ins_id:"-",price_decs:2,last_price:"-",ask_price1:"-",ask_volume1:"-",bid_price1:"-",bid_volume1:"-",pre_settlement:"-",change:"-",change_percent:"-",open:"-",close:"-",highest:"-",volume:"-",lowest:"-",upper_limit:"-",lower_limit:"-",settlement:"-",open_interest:"-",pre_open_interest:"-"},dt={data:function(){return{quote:Object.assign({},ot)}},props:{symbol:String,height:Number,width:Number},watch:{symbol:function(t,e){this.$tqsdk.subscribeQuote(this.symbol);var n=this.$tqsdk.getQuote(this.symbol);ct(this.quote,n)}},computed:{classOfColor:function(){return this.quote["change"]>0?"R":this.quote["change"]<0?"G":""},innerWidth:function(){return this.quote.bid_volume1/(this.quote.bid_volume1+this.quote.ask_volume1)},largeSize:function(){return this.width>100}},created:function(){var t=this;this.$tqsdk.subscribe_quote(this.symbol),this.$tqsdk.on("rtn_data",(function(){var e=t.$tqsdk.getQuote(t.symbol);ct(t.quote,e)}))},methods:{formatter:function(t){return K(t,this.quote.price_decs)},formatterVolume:function(t){return"number"!==typeof t?t:t>1e8?(t/1e8).toFixed(1)+"亿":t>1e4?(t/1e8).toFixed(1)+"万":t}}};function ct(t,e){Object.keys(ot).forEach((function(n,a,s){t[n]!==e[n]&&(t[n]=e[n])}))}var ut=dt,lt=(n("19da"),Object(_["a"])(ut,it,rt,!1,null,null,null)),ht=lt.exports,ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"about-us"},[a("a",{attrs:{href:"https://doc.shinnytech.com/tqsdk/latest/",target:"_blank"}},[a("img",{staticClass:"logo",attrs:{alt:"Tianqin",src:n("cf05")}}),t._v(" 天勤量化"),t.width>100?a("span",[t._v("开发文档")]):t._e()]),a("a",{attrs:{href:"https://www.shinnytech.com/qa/",target:"_blank"}},[a("Icon",{attrs:{type:"ios-chatbubbles"}}),t._v(" 天勤"),t.width>100?a("span",[t._v("量化")]):t._e(),t._v("论坛 ")],1)])},pt=[],mt={props:{width:Number}},_t=mt,bt=(n("2975"),Object(_["a"])(_t,ft,pt,!1,null,null,null)),gt=bt.exports,vt=function(){return document.addEventListener?function(t,e,n){t&&e&&n&&t.addEventListener(e,n,!1)}:function(t,e,n){t&&e&&n&&t.attachEvent("on"+e,n)}}(),yt=function(){return document.removeEventListener?function(t,e,n){t&&e&&t.removeEventListener(e,n,!1)}:function(t,e,n){t&&e&&t.detachEvent("on"+e,n)}}(),wt={name:"tq-top-view",components:{TqLayoutArea:g,TqChartComponents:Q,ButtonGroupDurations:P,QuoteInfo:ht,SubscribedList:st,AboutUs:gt},props:{width:Number,height:Number},data:function(){var t=240,e=80;return{rightClosed:!1,rightOpenedWidth:t,rightClosedWidth:e,instrumentId:"",duration:6e10,theme:"light"}},computed:{chartWidth:function(){var t=this.$root.windowWidth-(this.rightClosed?this.rightClosedWidth:this.rightOpenedWidth);return Math.max(t,400)},rightWidth:function(){return(this.rightClosed?this.rightClosedWidth:this.rightOpenedWidth)-4}},methods:{toggleRightClosed:function(){this.rightClosed=!this.rightClosed},onChangeDuration:function(t){this.duration=t},onChangeSelectedSubscribed:function(t,e){this.instrumentId=t,this.duration=e||6e10}},created:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){t.subscribed=t.$tqsdk.get_by_path(["subscribed"]),t.subscribed&&t.subscribed[0]&&""===t.instrumentId&&(t.subscribedIndex=0,t.instrumentId=Array.isArray(t.subscribed[0].symbol)?t.subscribed[0].symbol[0]:t.subscribed[0].symbol,t.duration=t.subscribed[0].dur_nano||6e10)}))}},kt=wt,qt=(n("f451"),Object(_["a"])(kt,E,N,!1,null,null,null)),xt=qt.exports,Ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tq-bottom-view"},["backtest"===t.$store.state.mode?[n("tq-layout-area",{attrs:{width:t.width/2,height:t.height}},[n("Tabs",{attrs:{animated:!1}},[n("TabPane",{attrs:{label:"回测指标"}},[n("backtest-info",{attrs:{width:t.width,height:t.height-27}})],1),n("TabPane",{attrs:{label:"成交记录"}},[n("trades-table",{attrs:{width:t.width,height:t.height-27}})],1)],1)],1),n("tq-layout-area",{attrs:{horizontalAlign:"right",width:t.width/2,height:t.height,otherStyle:{borderLeft:"2px solid #E0E0E0"}}},[n("backtest-chart")],1)]:"run"===t.$store.state.mode||"replay"===t.$store.state.mode?[n("tq-layout-area",{attrs:{height:26,width:t.width}},[n("account-info",{attrs:{height:26}})],1),n("tq-layout-area",{attrs:{height:t.height-26,top:26,width:t.width}},[n("Tabs",[n("TabPane",{attrs:{label:"持仓"}},[n("positions-table",{attrs:{width:t.width,height:t.height-53}})],1),n("TabPane",{attrs:{label:"成交记录"}},[n("trades-table",{attrs:{width:t.width,height:t.height-53}})],1),n("TabPane",{attrs:{label:"委托单记录"}},[n("orders-table",{attrs:{width:t.width,height:t.height-53}})],1)],1)],1)]:t._e()],2)},jt=[],St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"reports trades-table",style:{height:t.height+"px"}},[n("table",[n("thead",[n("tr",t._l(t.columns,(function(e){return n("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])})),0)]),n("tbody")])])},$t=[],zt=(n("4e82"),{data:function(){return{tbodyRoot:null,columns:[{name:"成交合约",key:"instrument_id",width:"100",cb:function(t){return t.exchange_id+"."+t.instrument_id}},{name:"方向",key:"direction",width:"60",cb:function(t){return V(t.direction)}},{name:"开平",key:"offset",width:"60",cb:function(t){return X(t.offset)}},{name:"成交价格",width:"60",key:"price"},{name:"手数",width:"60",key:"volume"},{name:"成交时间",key:"trade_date_time",width:"140",cb:function(t){return i()(t.trade_date_time/1e6).format("YYYY-MM-DD HH:mm:ss")}},{name:"报单编号",key:"trade_id"}]}},props:{height:Number},mounted:function(){this.tbodyNode=document.querySelector(".trades-table table tbody");var t=this,e=function(){var e=t.$store.state.account_id;if(e){var n=[],a=t.$tqsdk.get({name:"trades",user_id:e});if(a){for(var s in a)a[s]._epoch===t.$tqsdk.dm._epoch&&n.push(a[s]);n.sort((function(t,e){return t.trade_date_time-e.trade_date_time}));for(var i=function(e){var a=t.append_trade(n[e]);a.onclick=function(s){var i=t.tbodyNode.querySelectorAll("tr");i.forEach((function(t){return t.className=""})),a.className="selected",t.$eventHub.$emit("moveChartToDt",n[e].trade_date_time)}},r=0;r<n.length;r++)i(r)}}};e(),this.$tqsdk.on("rtn_data",e)},methods:{append_trade:function(t){var e=document.createElement("tr");for(var n in this.columns){var a=this.columns[n],s=this.get_td_text(a.cb?a.cb(t):t[a.key],a.key);e.appendChild(s)}return this.tbodyNode.insertBefore(e,this.tbodyNode.firstChild),e},get_td_text:function(t){var e=document.createElement("td");return e.textContent=t,e}}}),Ot=zt,Tt=Object(_["a"])(Ot,St,$t,!1,null,null,null),Et=Tt.exports,Nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"reports orders-table",style:{height:t.height+"px"}},[n("table",[n("thead",[n("tr",[t._l(t.columns,(function(e){return n("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])})),t._l(t.columnsAppend,(function(e){return n("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])}))],2)]),n("tbody")])])},At=[],Ft={data:function(){return{tbodyRoot:null,columns:[{name:"成交合约",width:"100",key:"instrument_id",cb:function(t){return t.exchange_id+"."+t.instrument_id}},{name:"方向",width:"60",key:"direction",cb:function(t){return V(t.direction)}},{name:"开平",width:"60",key:"offset",cb:function(t){return X(t.offset)}},{name:"报单价格",width:"60",key:"limit_price"},{name:"总手数",width:"60",key:"volume_orign"},{name:"报单时间",width:"140",key:"insert_date_time",cb:function(t){return i()(t.insert_date_time/1e6).format("YYYY-MM-DD HH:mm:ss")}}],columnsAppend:[{name:"未成交手数",key:"volume_left",width:"80",cb:function(t){return t.volume_left}},{name:"冻结保证金",width:"80",key:"frozen_margin"},{name:"状态",width:"60",key:"status",cb:function(t){return"FINISHED"===t.status?"已完成":"未完成"}},{name:"提示信息",key:"last_msg"}],ordersTr:{}}},props:{height:Number},mounted:function(){this.tbodyNode=document.querySelector(".orders-table table tbody");var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$store.state.account_id;if(e){var n=t.$tqsdk.get({name:"orders",user_id:e});if(n){var a=function(e){if(t.ordersTr[e])t.update_order(n[e],t.ordersTr[e]);else{var a=t.append_order(n[e]);a.onclick=function(s){var i=t.tbodyNode.querySelectorAll("tr");i.forEach((function(t){return t.className=""})),a.className="selected",t.$eventHub.$emit("moveChartToDt",n[e].insert_date_time)},t.ordersTr[e]=a}};for(var s in n)a(s)}}}))},methods:{append_order:function(t){var e=document.createElement("tr");for(var n in this.columns){var a=this.columns[n],s=this.get_td_text(a.cb?a.cb(t):t[a.key],a.key);e.appendChild(s)}for(var i in this.columnsAppend){var r=this.columnsAppend[i],o=this.get_td_text(r.cb?r.cb(t):t[r.key],r.key);e.appendChild(o)}return this.tbodyNode.insertBefore(e,this.tbodyNode.firstChild),e},update_order:function(t,e){for(var n in this.columnsAppend){var a=this.columns[n],s=e.querySelector("."+a.key),i=a.cb?a.cb(t):t[a.key];i!==s.textContent&&this.update_td_text(i,s)}},get_td_text:function(t,e){var n=document.createElement("td");return n.className=e,n.textContent=t,n},update_td_text:function(t,e){e.textContent=t}}},Mt=Ft,Dt=Object(_["a"])(Mt,Nt,At,!1,null,null,null),It=Dt.exports,Ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"reports positions-table",style:{height:t.height+"px"}},[n("table",[n("thead",[n("tr",[t._l(t.columns,(function(e){return n("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])})),t._l(t.columnsAppend,(function(e){return n("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])}))],2)]),n("tbody")])])},Pt=[],Yt={data:function(){return{tbodyRoot:null,columns:[{name:"持仓合约",width:"100",key:"instrument_id",cb:function(t){return t.exchange_id+"."+t.instrument_id}}],columnsAppend:[{name:"多仓",key:"volume_long",width:"60"},{name:"多头开仓均价",width:"80",key:"open_price_long"},{name:"多头浮动盈亏",width:"80",key:"position_profit_long"},{name:"多头占用保证金",width:"80",key:"margin_long",cb:function(t){return t.margin_long.toFixed?t.margin_long.toFixed(2):t.margin_long}},{name:"空仓",key:"volume_short",width:"60"},{name:"空头开仓均价",width:"80",key:"open_price_short"},{name:"空头浮动盈亏",width:"80",key:"position_profit_short"},{name:"空头占用保证金",width:"80",key:"margin_short",cb:function(t){return t.margin_short.toFixed?t.margin_short.toFixed(2):t.margin_short}}],ordersTr:{}}},props:{height:Number},mounted:function(){this.tbodyNode=document.querySelector(".positions-table table tbody");var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$store.state.account_id;if(e){var n=t.$tqsdk.get({name:"positions",user_id:e});if(n)for(var a in n)n[a]._epoch===t.$tqsdk.dm._epoch&&(t.ordersTr[a]?t.update_position(n[a],t.ordersTr[a]):t.ordersTr[a]=t.append_position(n[a]))}}))},methods:{append_position:function(t){var e=document.createElement("tr");for(var n in this.columns){var a=this.columns[n],s=this.get_td_text(a.cb?a.cb(t):t[a.key],a.key);e.appendChild(s)}for(var i in this.columnsAppend){var r=this.columnsAppend[i],o=this.get_td_text(r.cb?r.cb(t):t[r.key],r.key);e.appendChild(o)}return this.tbodyNode.insertBefore(e,this.tbodyNode.firstChild),e},update_position:function(t,e){for(var n in this.columnsAppend){var a=this.columnsAppend[n],s=e.querySelector("."+a.key),i=a.cb?a.cb(t):t[a.key];i!==s.textContent&&this.update_td_text(i,s)}},get_td_text:function(t,e){var n=document.createElement("td");return n.className=e,n.textContent=t,n},update_td_text:function(t,e){e.textContent=t}}},Lt=Yt,Wt=Object(_["a"])(Lt,Ht,Pt,!1,null,null,null),Rt=Wt.exports,Bt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"account-info",style:{height:t.height+"px"}},[n("div",[t._v(" 账户权益: "+t._s(t.balance)+" ")]),n("div",[t._v(" 浮动盈亏: "+t._s(t.float_profit)+" ")]),n("div",[t._v(" 保证金占用: "+t._s(t.margin)+" ")]),n("div",[t._v(" 日内手续费: "+t._s(t.commission)+" ")]),n("div",[t._v(" 可用资金: "+t._s(t.available)+" ")])])},Qt=[],Ut=(n("130f"),{data:function(){return{available:"-",balance:"-",commission:"-",float_profit:"-",margin:"-"}},props:{height:Number},computed:{account_id:function(){return this.$store.state.account_id}},mounted:function(){setImmediate(this.update.bind(this)),this.$tqsdk.on("rtn_data",this.update)},methods:{update:function(){if(this.account_id){var t=this.$tqsdk.get({name:"account",user_id:this.account_id,currency:"CNY"});t._epoch===this.$tqsdk.dm._epoch&&(this.available=t.available,this.balance=t.balance,this.commission=t.commission,this.float_profit=t.float_profit,this.margin=t.margin)}}}}),Gt=Ut,Kt=(n("a240"),Object(_["a"])(Gt,Bt,Qt,!1,null,null,null)),Vt=Kt.exports,Xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"backtest-info",style:{height:t.height+"px"}},[n("Row",["-"===t.init_balance?n("Col",{attrs:{span:24,"class-name":"spin-container"}},[n("Spin",{attrs:{fix:""}},[n("div",{staticClass:"loader"},[n("svg",{staticClass:"circular",attrs:{viewBox:"25 25 50 50"}},[n("circle",{staticClass:"path",attrs:{cx:"50",cy:"50",r:"20",fill:"none","stroke-width":"6","stroke-miterlimit":"10"}})])]),t._v(" 回测进行中 ")])],1):t._e()],1),n("Row",[n("Col",{attrs:{span:6}},[t._v("起始资金")]),n("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.init_balance,2)))]),n("Col",{attrs:{span:6}},[t._v("总收益")]),n("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.balance-t.init_balance,2)))]),n("Col",{attrs:{span:6}},[t._v("结束资金")]),n("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.balance,2)))]),n("Col",{attrs:{span:6}},[t._v("总收益率")]),n("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(100*t.ror,2))+"%")]),n("Col",{attrs:{span:6}},[t._v("最大回撤")]),n("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(100*t.max_drawdown,2))+"%")]),n("Col",{attrs:{span:6}},[t._v("年化收益率")]),n("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(100*t.annual_yield,2))+"%")]),n("Col",{attrs:{span:6}},[t._v("总手续费")]),n("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.commission,2)))]),n("Col",{attrs:{span:6}},[t._v("年化夏普率")]),n("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.sharpe_ratio,2)))]),n("Col",{attrs:{span:6}},[t._v("胜率")]),n("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.winning_rate,2)))]),n("Col",{attrs:{span:6}},[t._v("每手盈亏额比")]),n("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.profit_loss_ratio,2)))]),n("Col",{style:{color:"#bd0000"},attrs:{span:12}},[t._v("天勤量化："+t._s(t.getMsg(t.ror)))])],1)],1)},Jt=[],Zt={data:function(){return{init_balance:"-",balance:"-",ror:"-",annual_yield:"-",max_drawdown:"-",sharpe_ratio:"-",commission:"-",winning_rate:"-",profit_loss_ratio:"-"}},props:{height:Number,width:Number},methods:{getMsg:function(t){return t<=-100?"幸好是模拟账户，不然你就亏完啦":t<=-50?"触底反弹,与其执迷修改参数，不如改变策略思路去天勤官网策略库进修":t<=-20?"越挫越勇，不如去天勤量化官网策略库进修":t<=0?"不要灰心，少侠重新来过":t<=20?"策略看来小有所成":t<=50?"策略看来的得心应手":t<=100?"策略看来春风得意，堪比当代索罗斯":"策略看来独孤求败，小心过拟合噢"}},mounted:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$store.state.account_id;if(e){var n=t.$tqsdk.get({name:"account",user_id:e,currency:"CNY"});if(n&&n._tqsdk_stat){t.init_balance=n._tqsdk_stat.init_balance,t.balance=n._tqsdk_stat.balance,t.max_drawdown=n._tqsdk_stat.max_drawdown,t.annual_yield=n._tqsdk_stat.annual_yield,t.ror=n._tqsdk_stat.ror,t.sharpe_ratio=n._tqsdk_stat.sharpe_ratio,t.winning_rate=n._tqsdk_stat.winning_rate,t.profit_loss_ratio=n._tqsdk_stat.profit_loss_ratio;var a=t.$tqsdk.get({name:"trades",user_id:e}),s=0;for(var i in a)s+=a[i].commission;t.commission=s}}}))}},te=Zt,ee=(n("5ab6"),Object(_["a"])(te,Xt,Jt,!1,null,null,null)),ne=ee.exports,ae=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"backtest-report"},[n("e-chart",{ref:"echart",attrs:{height:"240px",width:t.width+"px","path-option":t.defaultOption}})],1)},se=[],ie=(n("25eb"),n("a6fb")),re=n.n(ie),oe=n("313e"),de=n.n(oe);(function(){var t=function(t,e,n){n=n||window;var a=!1,s=function(){a||(a=!0,requestAnimationFrame((function(){n.dispatchEvent(new CustomEvent(e)),a=!1})))};n.addEventListener(t,s)};t("resize","optimizedResize")})();var ce={name:"v-echart",render:function(t){var e={staticClass:"v-chart",style:this.canvasStyle,ref:"canvas",on:this.$listeners};return t("div",e)},props:{width:{type:String,default:"auto"},height:{type:String,default:"400px"},pathOption:[Object,Array],widthChangeDelay:{type:Number,default:450}},data:function(){return{chartInstance:null,_defaultOption:{animation:!1,tooltip:{show:!0},title:{show:!0,textStyle:{fontSize:"16px",color:"rgba(0, 0, 0 , .87)",fontFamily:"sans-serif"}},grid:{containLabel:!0},xAxis:{show:!0,type:"category",axisLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}},axisTick:{show:!0,alignWithLabel:!0,lineStyle:{show:!0,color:"rgba(0, 0, 0 , .24)"}},axisLabel:{show:!1},splitLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}}},yAxis:{show:!0,type:"value",max:"dataMax",min:"dataMin",axisLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}},axisLabel:{show:!1,color:"rgba(0, 0, 0 , .24)"},splitLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}},axisTick:{show:!0,lineStyle:{show:!0,color:"rgba(0, 0, 0 , .54)"}}},series:[{type:"line"}]}}},computed:{canvasStyle:function(){return{width:this.width,height:this.height}}},methods:{init:function(){var t=this;this.pathOption&&this.pathOption.forEach((function(e){re.a.set(t.$data._defaultOption,e[0],e[1])})),this.chartInstance=de.a.init(this.$refs.canvas),this.chartInstance.setOption(this.$data._defaultOption),window.addEventListener("optimizedResize",(function(e){setTimeout((function(e){t.chartInstance.resize()}),t.widthChangeDelay)}))},showLoadPercent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&t<100?(t=Math.max(t,0),this.chartInstance.showLoading("default",{text:"数据已加载 "+t+"%",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0})):this.chartInstance.hideLoading()},update:function(t){this.chartInstance.setOption(t)},resize:function(){this.chartInstance.resize()},clean:function(){window.removeEventListener("resize",this.chartInstance.resize),this.chartInstance.clear()}},mounted:function(){this.init()},beforeDestroy:function(){this.clean()}},ue={components:{EChart:ce},data:function(){return{daily_yield:[],defaultOption:[["grid.top","16px"],["grid.left","10px"],["grid.bottom","0px"],["grid.right","16px"],["series[0]",{type:"line",encode:{x:"datetime",y:["balance"]},smooth:!1,showAllSymbol:!0,areaStyle:{}}],["yAxis.show",!0],["yAxis.type","value"],["yAxis.axisLabel",{show:!0,formatter:function(t,e){return t.toFixed(2)},color:"#333333"}],["yAxis.splitLine",{show:!0}],["xAxis.show",!0],["xAxis.type","time"],["xAxis.axisLabel",{show:!0,color:"#333333"}],["xAxis.splitLine",{show:!0}],["xAxis.boundaryGap",!1],["tooltip",{trigger:"axis",triggerOn:"mousemove|click"}]]}},props:{height:Number,width:Number},methods:{},mounted:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$tqsdk.get_by_path(["snapshots"]),n=[];for(var a in e)a>t.$store.state.end_dt||n.push([Number.parseInt(a/1e6),e[a].accounts.CNY.balance]);t.$refs.echart.update({dataset:{source:n}})}))}},le=ue,he=(n("b7de"),Object(_["a"])(le,ae,se,!1,null,null,null)),fe=he.exports,pe={name:"tq-bottom-view",components:{TqLayoutArea:g,TradesTable:Et,OrdersTable:It,PositionsTable:Rt,AccountInfo:Vt,BacktestInfo:ne,BacktestChart:fe},props:{height:Number,width:Number},data:function(){return{}},methods:{},created:function(){}},me=pe,_e=(n("1a2d3"),Object(_["a"])(me,Ct,jt,!1,null,null,null)),be=_e.exports,ge=38,ve=4,ye=56,we={name:"tq-home",components:{TqHeaderView:T,TqTopView:xt,TqBottomView:be},data:function(){var t=400,e=ge+t+ve;return{isMoving:!1,headerHeight:ge,topHeight:t,topHeightMin:260,bottomYOffset:e,bottomYOffsetMin:2*ge,bottomYOffsetMax:this.$root.windowHeight-ye,bottomHeight:this.$root.windowHeight-e-ve,showBottomShadow:!1}},methods:{onResize:function(){this.bottomYOffsetMax=this.$root.windowHeight-ye,this.computeLayouts()},handleMousedown:function(t){this.isMoving=!0,vt(document,"mousemove",this.handleMove),vt(document,"mouseup",this.handleUp)},handleMove:function(t){var e=t.pageY;e>=this.bottomYOffsetMax||e<=this.bottomYOffsetMin||(this.bottomYOffset=e,this.computeLayouts())},handleUp:function(){this.isMoving=!1,yt(document,"mousemove",this.handleMove),yt(document,"mouseup",this.handleUp)},computeLayouts:function(){var t=this.$root.windowHeight-this.bottomYOffset;t<=ye&&(t=ye,this.bottomYOffset=this.$root.windowHeight-t),this.showBottomShadow=this.bottomYOffset<this.topHeightMin+ge,this.bottomHeight=t-ve;var e=this.$root.windowHeight-ge-t-ve;this.topHeight=Math.max(e,this.topHeightMin)}},created:function(){this.$eventHub.$on("window_resize",this.onResize),this.computeLayouts()}},ke=we,qe=(n("a124"),Object(_["a"])(ke,d,c,!1,null,null,null)),xe=qe.exports,Ce={name:"tq-app",components:{Tianqin:xe}},je=Ce,Se=(n("5c0b"),Object(_["a"])(je,r,o,!1,null,null,null)),$e=Se.exports,ze=n("0977"),Oe=n("8629"),Te=n("f843"),Ee=n("8144"),Ne=n("2d48"),Ae=n("6def"),Fe=n("e79d"),Me=n("90b2"),De=n("c5c1"),Ie=n("dcbf"),He=n("e3f5"),Pe=n("5250"),Ye=n("76ea"),Le=n("b3e6"),We=n("8679"),Re=n("fe66"),Be=n("6252"),Qe=n("9259"),Ue=n("aa30"),Ge=n("e0b9");a["a"].prototype.$Loading=Ge["a"],a["a"].prototype.$Message=Ue["a"],a["a"].prototype.$Modal=Qe["a"],a["a"].prototype.$Notice=Be["a"],a["a"].prototype.$Spin=Re["a"],a["a"].component("Layout",We["a"]),a["a"].component("Row",Le["a"]),a["a"].component("Col",Ye["a"]),a["a"].component("Icon",Pe["a"]),a["a"].component("Button",He["a"]),a["a"].component("ButtonGroup",Ie["a"]),a["a"].component("Dropdown",De["a"]),a["a"].component("DropdownMenu",Me["a"]),a["a"].component("DropdownItem",Fe["a"]),a["a"].component("Badge",Ae["a"]),a["a"].component("Radio",Ne["a"]),a["a"].component("RadioGroup",Ee["a"]),a["a"].component("Tabs",Te["a"]),a["a"].component("TabPane",Oe["a"]),a["a"].component("Spin",Re["a"]),a["a"].config.productionTip=!1,a["a"].$eventHub=new a["a"],a["a"].prototype.$eventHub=a["a"].$eventHub;var Ke={name:"tianqin-web",windowHeight:window.innerHeight,windowWidth:window.innerWidth},Ve=new a["a"]({data:Ke,store:q,render:function(t){return t($e)},methods:{handlerResize:function(){Ke.windowHeight=window.innerHeight,Ke.windowWidth=window.innerWidth,this.$eventHub.$emit("window_resize",{width:Ke.windowWidth,height:Ke.windowHeight})}},created:function(){var t;function e(){t||(t=setTimeout((function(){t=null,Ve.handlerResize()}),200))}window.addEventListener("resize",e,!1)},errorCaptured:function(t,e,n){return console.error("App.errorCaptured",t,e,n),!1},destroyed:function(){}});a["a"].filter("toFixed",(function(t,e){var n=Number(t);return e=Number.isInteger(e)?e:2,Number.isFinite(n)?n.toFixed(e):t})),GetTqsdkUrl().then((function(t){var e=t["ins_url"],n=t["md_url"],s=t["ws_url"];if("https://openmd.shinnytech.com/t/md/symbols/latest.json"===e){var r=i()().format("YYYY-MM-DD HH:mm:ss.SSSSSS");e="https://openmd.shinnytech.com/t/md/symbols/".concat(r,".json")}if(t["replay_dt"]){var o=e.indexOf("/symbol");q.state.ctrl_url=e.substring(0,o);var d=i()(t["replay_dt"]/1e6).format("YYYY-MM-DD HH:mm:ss");d+=(Math.random()+"").substring(2,8),e="https://openmd.shinnytech.com/t/md/symbols/".concat(d,".json")}a["a"].$tqsdk=new ze["a"]({symbolsServerUrl:e,wsQuoteUrl:n,wsTradeUrl:s}),a["a"].prototype.$tqsdk=a["a"].$tqsdk,a["a"].$tqsdk.on("rtn_data",(function(){var t=a["a"].$tqsdk.get_by_path(["_tqsdk_backtest"]);t&&t.current_dt&&(q.state.start_dt=t.start_dt,q.state.end_dt=t.end_dt);var e=a["a"].$tqsdk.get_by_path(["_tqsdk_replay"]);e&&e.replay_dt&&(q.state.replay_dt=e.replay_dt);var n=a["a"].$tqsdk.get_by_path(["action"]);""===q.state.mode&&n&&q.commit("set_action",n)})),a["a"].$tqsdk.defaultTradeWs.on("close",(function(){q.commit("set_py_file_status",!1)})),a["a"].$tqsdk.defaultTradeWs.on("open",(function(){q.commit("set_py_file_status",!0)})),Ve.$mount("#app")}))},"5a46":function(t,e,n){},"5ab6":function(t,e,n){"use strict";var a=n("d85d"),s=n.n(a);s.a},"5c0b":function(t,e,n){"use strict";var a=n("9c0c"),s=n.n(a);s.a},"5c44":function(t,e,n){},6491:function(t,e,n){},"657e":function(t,e,n){},"889f":function(t,e,n){},"8e24":function(t,e,n){"use strict";var a=n("889f"),s=n.n(a);s.a},"8fde":function(t,e,n){},"9c0c":function(t,e,n){},a124:function(t,e,n){"use strict";var a=n("657e"),s=n.n(a);s.a},a240:function(t,e,n){"use strict";var a=n("07f6"),s=n.n(a);s.a},a829:function(t,e,n){},b7de:function(t,e,n){"use strict";var a=n("5096"),s=n.n(a);s.a},b9e2:function(t,e,n){"use strict";var a=n("a829"),s=n.n(a);s.a},cf05:function(t,e,n){t.exports=n.p+"img/logo.165e0f64.png"},d85d:function(t,e,n){},dcf3:function(t,e,n){},f451:function(t,e,n){"use strict";var a=n("5c44"),s=n.n(a);s.a},f6c5:function(t,e,n){}});