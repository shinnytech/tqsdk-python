(function(t){function e(e){for(var s,o,a=e[0],_=e[1],c=e[2],d=0,l=[];d<a.length;d++)o=a[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&l.push(n[o][0]),n[o]=0;for(s in _)Object.prototype.hasOwnProperty.call(_,s)&&(t[s]=_[s]);u&&u(e);while(l.length)l.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],s=!0,a=1;a<r.length;a++){var _=r[a];0!==n[_]&&(s=!1)}s&&(i.splice(e--,1),t=o(o.s=r[0]))}return t}var s={},n={app:0},i=[];function o(e){if(s[e])return s[e].exports;var r=s[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=s,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(r,s,function(e){return t[e]}.bind(null,s));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],_=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var u=_;i.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"07f6":function(t,e,r){},"19da":function(t,e,r){"use strict";var s=r("dcf3"),n=r.n(s);n.a},"1a2d3":function(t,e,r){"use strict";var s=r("f6c5"),n=r.n(s);n.a},2975:function(t,e,r){"use strict";var s=r("8fde"),n=r.n(s);n.a},"326a":function(t,e,r){"use strict";var s=r("6491"),n=r.n(s);n.a},4678:function(t,e,r){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(t){var e=i(t);return r(e)}function i(t){if(!r.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}n.keys=function(){return Object.keys(s)},n.resolve=i,t.exports=n,n.id="4678"},5096:function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("4de4"),r("a9e3"),r("f00c"),r("8ba4"),r("b680"),r("e260"),r("e6cf"),r("cca6"),r("a79d");var s=r("2b0e"),n=r("c1df"),i=r.n(n),o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("tianqin")],1)},a=[],_=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tq-home"},[r("div",{staticClass:"layout-area header-container"},[r("tq-header-view",{attrs:{height:t.headerHeight,width:t.$root.windowWidth}})],1),r("div",{staticClass:"layout-area top-container",style:{height:t.topHeight+"px"}},[r("tq-top-view",{attrs:{height:t.topHeight,width:t.$root.windowWidth}})],1),r("div",{staticClass:"layout-area bottom-container",style:{height:t.bottomHeight+"px",top:t.bottomYOffset+4+"px",backgroundColor:"#FEFEFE",boxShadow:t.showBottomShadow?"0px -3px 4px -1px #AFAFAF":""}},[r("div",{staticClass:"bottom-area-handle",on:{mousedown:t.handleMousedown}}),r("tq-bottom-view",{attrs:{height:t.bottomHeight,width:t.$root.windowWidth}})],1)])},c=[],u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tq-header-view"},[s("tq-layout-area",{attrs:{height:t.height,otherStyle:{backgroundColor:"#FEFEFE"}}},[s("a",{attrs:{href:"https://www.shinnytech.com/tianqin/",target:"_blank"}},[s("img",{staticClass:"logo",style:{padding:"4px",width:t.height+"px",height:t.height+"px"},attrs:{alt:"Tianqin",src:r("cf05")}})])]),s("tq-layout-area",{attrs:{height:t.height,left:t.height,width:240,otherStyle:{paddingTop:"8px"}}},[t._v(" "+t._s(t.$store.state.file_name)+" ")]),s("tq-layout-area",{attrs:{height:t.height,left:t.height+240,width:380,otherStyle:{paddingTop:"8px",backgroundColor:"backtest"===t.$store.state.mode?"#FAF5EA":"#FFF"}}},["run"===t.$store.state.mode?s("div",[t._v("账户："+t._s(t.$store.state.broker_id)+","+t._s(t.$store.state.account_id)+" ")]):t._e(),"backtest"===t.$store.state.mode?s("div",[t._v("回测区间： "+t._s(t.formatDt(t.$store.state.start_dt))+" -- "+t._s(t.formatDt(t.$store.state.end_dt))+" ")]):t._e()]),s("tq-layout-area",{attrs:{height:t.height,width:160,horizontalAlign:"right",otherStyle:{paddingTop:"8px"}}},[s("Badge",{attrs:{color:t.$store.state.py_file_status?"green":"red",text:"py文件"}}),s("Badge",{attrs:{color:t.$store.state.md_url_status?"green":"red",text:"行情"}}),s("Badge",{attrs:{color:t.$store.state.td_url_status?"green":"red",text:"交易"}})],1)],1)},d=[],l=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tq-layout-absolute",style:t.computedStyle},[t._t("default")],2)},h=[],f={name:"tq-layout-absolute",data:function(){return{}},props:{horizontalAlign:{type:String,default:"left"},verticalAlign:{type:String,default:"top"},top:{type:Number,default:0},left:{type:Number,default:0},bottom:{type:Number,default:0},right:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0},otherStyle:{type:Object,default:function(){}}},computed:{computedStyle:function(){var t={width:this.width+"px",height:this.height+"px"};return t[this.horizontalAlign]=this[this.horizontalAlign]+"px",t[this.verticalAlign]=this[this.verticalAlign]+"px",Object.assign(t,this.otherStyle)}}},p=f,m=(r("b9e2"),r("2877")),b=Object(m["a"])(p,l,h,!1,null,null,null),g=b.exports,y={name:"tq-header-view",components:{TqLayoutArea:g},props:{height:Number},methods:{formatDt:function(t){return i()(t/1e6).format("YYYY-MM-DD HH:mm:ss")}}},v=y,w=(r("8e24"),Object(m["a"])(v,u,d,!1,null,null,null)),E=w.exports,k=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tq-top-view"},[r("tq-layout-area",{staticClass:"left-view",attrs:{height:t.height,width:t.chartWidth}},[r("tq-layout-area",{attrs:{height:26,width:300}},[r("button-group-durations",{attrs:{duration:t.duration},on:{onChangeDuration:t.onChangeDuration}})],1),r("tq-layout-area",{attrs:{top:26}},[r("tq-chart-components",{attrs:{instrumentId:t.instrumentId,duration:t.duration,height:t.height-26,width:t.chartWidth,theme:t.theme}})],1)],1),r("tq-layout-area",{staticClass:"right-view",attrs:{height:t.height,width:t.rightWidth,horizontalAlign:"right"}},["run"===t.$store.state.mode?r("tq-layout-area",{attrs:{height:t.rightClosed?t.height-35:160,width:t.rightWidth}},["run"===t.$store.state.mode?r("quote-info",{attrs:{symbol:t.instrumentId,height:t.rightClosed?t.height-35:160,width:t.rightWidth}}):t._e()],1):t._e(),r("tq-layout-area",{attrs:{top:"run"===t.$store.state.mode?160:0,height:t.rightClosed?0:18,width:t.rightWidth,otherStyle:{backgroundColor:"lightgrey",color:"#333333",fontSize:"12px",fontWeight:"700",overflow:"hidden"}}},[t._v(" 订阅合约列表 ")]),r("tq-layout-area",{attrs:{verticalAlign:"bottom",bottom:35,height:t.rightClosed?0:t.height-("run"===t.$store.state.mode?160:0)-18-35,width:t.rightWidth,otherStyle:{overflowY:"scroll"}}},[r("subscribed-list",{on:{onChange:t.onChangeSelectedSubscribed}})],1),r("tq-layout-area",{attrs:{verticalAlign:"bottom",height:35,width:t.rightWidth}},[r("about-us",{attrs:{width:t.rightWidth}})],1),"run"===t.$store.state.mode?r("div",{staticClass:"right-resize-tool",on:{click:t.toggleRightClosed}},[t.rightClosed?r("Icon",{attrs:{type:"ios-arrow-back"}}):r("Icon",{attrs:{type:"ios-arrow-forward"}})],1):t._e()],1)],1)},O=[],C=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tq-button-group-durations"},[r("RadioGroup",{attrs:{type:"button",size:"small"},model:{value:t.selectedPeriod,callback:function(e){t.selectedPeriod=e},expression:"selectedPeriod"}},t._l(t.periods,(function(t){return r("Radio",{key:t,attrs:{label:t}})})),1)],1)},j=[],D=(r("4160"),r("c975"),r("b64b"),r("07ac"),r("159b"),{"1m":6e10,"5m":3e11,"15m":9e11,"30m":18e11,"1h":36e11,"1d":864e11}),P={data:function(){return{periods:Object.keys(D),selectedPeriod:"",selectedDuration:null}},props:{duration:Number},watch:{duration:function(){if(this.duration!==this.selectedDuration){var t=Object.values(D).indexOf(this.duration);t>-1?(this.selectedPeriod=D[t],this.selectedDuration=this.duration):(this.selectedPeriod="",this.selectedDuration=null)}},selectedPeriod:function(){document.querySelectorAll(".tq-button-group-durations input[type=radio]").forEach((function(t){return t.blur()})),this.selectedDuration=D[this.selectedPeriod],this.selectedPeriod&&this.selectedDuration&&(console.log(this.selectedPeriod,this.selectedDuration),this.$emit("onChangeDuration",this.selectedDuration))}}},q=P,T=(r("326a"),Object(m["a"])(q,C,j,!1,null,null,null)),M=T.exports,x=(r("99af"),r("6029")),S="web_chart",I="web_chart_focus",A=null,L=null,W={name:"tq-chart-components",data:function(){return{id:"TQ-CHART",action:"run"}},props:{instrumentId:{type:String,default:"TQ.m@SHFE.au"},duration:{type:Number,default:6e10},width:Number,height:Number,theme:{type:String,default:"light"}},render:function(t){var e={class:{"theme-light":"light"===this.theme,"theme-dark":"dark"===this.theme},attrs:{id:this.id}};return t("div",e)},watch:{instrumentId:function(t,e){L.removeMarkAll(),this.$nextTick(this.updateTqChart)},duration:function(t,e){L.removeMarkAll(),this.$nextTick(this.updateTqChart)},width:function(t,e){L&&L.resize({width:t,height:this.height})},height:function(t,e){L&&L.resize({width:this.width,height:t})}},created:function(){A=this.$tqsdk.get({name:"klines",symbol:this.instrumentId,duration:this.duration}),L=new x["a"]({id:this.id,instrumentId:this.instrumentId,duration:this.duration,height:this.height,width:this.width,mainSeries:A});var t="free",e=3,r=this;L.on("showRangeChanged",(function(s){if(-1!==s.rightId&&-1!==s.leftId)if("fixed"===t){var n=864e11;r.$tqsdk.set_chart({chart_id:S,symbol:r.instrumentId,duration:r.duration,trading_day_start:n*(1-e),trading_day_count:n*e})}else if("free"===t){var i=s.rightId-s.leftId;r.$tqsdk.set_chart({chart_id:S,symbol:r.instrumentId,duration:r.duration,left_kline_id:Math.max(s.leftId-i,0),view_width:3*i})}}))},mounted:function(){L.init();var t=this;this.$tqsdk.on("rtn_data",(function(){if(t.updatePositionLine(),t.updateTrades(),t.updateTqSdkChartData(),t.updatePositionRect(),"run"===t.action&&"backtest"===t.$tqsdk.get_by_path(["action","mode"])){var e=t.$store.state.account_id;if(e){var r=t.$tqsdk.get({name:"trades",user_id:e});for(var s in r){var n=r[s];L&&L.symbol&&L.duration&&(t.$tqsdk.set_chart({chart_id:I,symbol:L.symbol,duration:L.duration,view_width:L.bar.barNumbers,focus_datetime:n.trade_date_time,focus_position:Math.floor(L.bar.barNumbers/2)}),t.action="backtest");break}}}var i=t.$tqsdk.get_by_path(["charts",I]);if(i&&!i.more_data&&i.left_id&&i.right_id){var o=[i.left_id,i.right_id],a=o[0],_=o[1];L.setRange(a,_),L.addHighlightBar("movetoid",a+Math.round(L.bar.barNumbers/2-2)),t.$tqsdk.set_chart({chart_id:I,symbol:"",duration:L.duration,view_width:0})}else{var c=t.$tqsdk.get_by_path(["charts",S,"more_data"]);!c&&t.$tqsdk.is_changed(A)&&L.draw()}})),this.$eventHub.$on("moveChartToDt",(function(t){this.$tqsdk.set_chart({chart_id:I,symbol:L.symbol,duration:L.duration,view_width:L.bar.barNumbers,focus_datetime:t,focus_position:Math.floor(L.bar.barNumbers/2)})}))},methods:{updateTqChart:function(){if(this.$tqsdk.set_chart({chart_id:S,symbol:this.instrumentId,duration:this.duration,view_width:1e3}),A=this.$tqsdk.get({name:"klines",symbol:this.instrumentId,duration:this.duration}),L){var t=this.$tqsdk.get_quote(this.instrumentId);L.setMainSeries(this.instrumentId,this.duration,A),L.price_decs=t.price_decs,this.$nextTick((function(){this.updateTqSdkChartData(),this.updateTrades(!0),this.updatePositionRect(!0)}))}},updateTqSdkChartData:function(){var t=this.$tqsdk.get_by_path(["draw_chart_datas",L.symbol,L.duration]);if(t)for(var e in t)L.addSeries(e,t[e])},updatePositionLine:function(t){var e=this.$store.state.account_id;if(e){var r=this.$tqsdk.get({name:"position",user_id:e,symbol:L.symbol});r&&r.volume_long>0?L.addMark({id:"pos_long",type:"line",boardId:"main",yAlign:"right",xPos1:0,xPos2:L.innerWidth,y1:r.open_price_long,y2:r.open_price_long,stroke:"red",text:"多仓".concat(r.volume_long,"手@").concat(r.open_price_long)}):L.removeMark("pos_long"),r&&r.volume_short>0?L.addMark({id:"pos_short",type:"line",boardId:"main",yAlign:"right",xPos1:0,xPos2:L.innerWidth,y1:r.open_price_short,y2:r.open_price_short,stroke:"green",text:"空仓".concat(r.volume_short,"手@").concat(r.open_price_short)}):L.removeMark("pos_short")}},updateTrades:function(t){var e=this.$store.state.account_id;if(e){var r=this.$tqsdk.get({name:"trades",user_id:e});for(var s in r){var n=r[s];t?n.volume>0&&n.symbol===L.symbol&&L.addTradeArrow(s,n):n._epoch===this.$tqsdk.dm._epoch&&n.volume>0&&n.symbol===L.symbol&&L.addTradeArrow(s,n)}}},updatePositionRect:function(t){var e=this.$tqsdk.get_by_path(["snapshots"]);for(var r in e){var s=e[r];t?s.positions&&s.positions.hasOwnProperty(L.symbol)&&L.addPositionRecord(r,s.positions[L.symbol]):s._epoch===this.$tqsdk.dm._epoch&&s.positions&&s.positions.hasOwnProperty(L.symbol)&&L.addPositionRecord(r,s.positions[L.symbol])}}}},R=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"subscribed-list"},[t._l(t.subscribedSymbols,(function(e){return[t._l(t.subscribed[e],(function(s){return[r("Button",{attrs:{size:"small",long:""},on:{click:function(r){return t.onClick(e,s)}}},[t._v(" "+t._s(e)+" "+t._s(t.ParseDuartionToString(s))+" ")])]}))]}))],2)},K=[];r("caad"),r("2532"),r("a434"),r("ac1f"),r("1276"),r("bf2d");function B(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"number"===typeof t?t.toFixed(e):t}function $(t){switch(t){case"BUY":return"买";case"SELL":return"卖";default:return t}}function U(t){switch(t){case"OPEN":return"开";case"CLOSE":return"平";case"CLOSETODAY":return"平今";default:return t}}function z(t){var e="";if(t&&t>=1e9){var r=i.a.duration(t/1e9,"seconds");r.years()>0&&(e+=r.years()+"Y"),r.months()>0&&(e+=r.months()+"M"),r.days()>0&&(e+=r.days()+"D"),r.hours()>0&&(e+=r.hours()+"h"),r.minutes()>0&&(e+=r.minutes()+"m"),r.seconds()>0&&(e+=r.seconds()+"s")}return e}var N=[],Q={},H={data:function(){return{subscribedSymbols:N,subscribed:Q}},props:{},watch:{subscribedSymbols:function(t,e){console.log(t,e)}},mounted:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$tqsdk.getByPath(["subscribed"]);if(console.log("subscribed",e),e&&e._epoch===t.$tqsdk.dm._epoch){for(var r in e){var s=e[r];if(console.log(r,s),Array.isArray(s.symbol))for(var n in s.symbol)console.log(s.symbol[n]),t.addSubscribed(s.symbol[n],s.dur_nano);else console.log(s.symbol),t.addSubscribed(s.symbol,s.dur_nano)}t.updateSubscribedSymbols()}}))},methods:{addSubscribed:function(t,e){Q[t]||(Q[t]=[]),e||(e=""),Q[t].includes(e)||Q[t].push(e)},updateSubscribedSymbols:function(){for(var t in Q)-1===N.indexOf(t)&&N.push(t)},onClick:function(t,e){this.$emit("onChange",t,e)},ParseDuartionToString:z}},F=H,Y=Object(m["a"])(F,R,K,!1,null,null,null),G=Y.exports,J=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"quote-info-container"},[r("Row",{attrs:{"class-name":"quote-items-title"}},[r("Col",{attrs:{span:t.largeSize?12:24}},[r("div",[t._v(t._s(t.quote.ins_name))])]),r("Col",{attrs:{span:t.largeSize?12:24}},[r("div",[t._v(t._s(t.quote.ins_id))])])],1),r("Row",[r("Col",{attrs:{span:t.largeSize?6:12}},[r("div",[t._v("卖一")])]),r("Col",{attrs:{span:t.largeSize?9:12}},[r("div",[t._v(t._s(t.formatter(t.quote.ask_price1)))])]),r("Col",{attrs:{span:t.largeSize?9:"0"}},[t._v(" "+t._s(t.quote.ask_volume1)+" ")])],1),r("div",{staticClass:"outer"},[r("div",{staticClass:"inner",style:{width:100*t.innerWidth+"%"}})]),r("Row",[r("Col",{attrs:{span:t.largeSize?6:12}},[t._v(" 买一 ")]),r("Col",{attrs:{span:t.largeSize?9:12}},[t._v(" "+t._s(t.formatter(t.quote.bid_price1)))]),r("Col",{attrs:{span:t.largeSize?9:"0"}},[t._v(" "+t._s(t.quote.bid_volume1)+" ")])],1),r("Row",{attrs:{"class-name":"quote-items "+(t.largeSize?"large-size":"")}},[r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 最新价 ")]),r("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.last_price))+" ")]),r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 昨结算 ")]),r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.pre_settlement))+" ")]),r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 涨跌 ")]),r("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.change))+" ")]),r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 今开 ")]),r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.quote.open)+" ")]),r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 涨跌幅 ")]),r("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t._f("toFixed")(t.quote.change_percent))+"% ")]),r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 最高 ")]),r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.highest))+" ")]),r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 总手 ")]),r("Col",{class:t.classOfColor,attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.quote.volume)+" ")]),r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" 最低 ")]),r("Col",{attrs:{span:t.largeSize?6:24}},[t._v(" "+t._s(t.formatter(t.quote.lowest))+" ")]),r("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 涨停 ")]),r("Col",{staticClass:"R",attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.upper_limit))+" ")]),r("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 收盘 ")]),r("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.close))+" ")]),r("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 跌停 ")]),r("Col",{staticClass:"G",attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.lower_limit))+" ")]),r("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 结算 ")]),r("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.formatter(t.quote.settlement))+" ")]),r("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 持仓量 ")]),r("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.quote.open_interest))]),r("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" 日增")]),r("Col",{attrs:{span:t.largeSize?6:"0"}},[t._v(" "+t._s(t.quote.open_interest-t.quote.pre_open_interest))])],1)],1)},V=[],Z={ins_name:"-",ins_id:"-",price_decs:2,last_price:"-",ask_price1:"-",ask_volume1:"-",bid_price1:"-",bid_volume1:"-",pre_settlement:"-",change:"-",change_percent:"-",open:"-",close:"-",highest:"-",volume:"-",lowest:"-",upper_limit:"-",lower_limit:"-",settlement:"-",open_interest:"-",pre_open_interest:"-"},X={data:function(){return{quote:Object.assign({},Z)}},props:{symbol:String,height:Number,width:Number},watch:{symbol:function(t,e){console.log("subscribe_quote",t,e),this.$tqsdk.subscribeQuote(this.symbol);var r=this.$tqsdk.getQuote(this.symbol);tt(this.quote,r)}},computed:{classOfColor:function(){return this.quote["change"]>0?"R":this.quote["change"]<0?"G":""},innerWidth:function(){return this.quote.bid_volume1/(this.quote.bid_volume1+this.quote.ask_volume1)},largeSize:function(){return this.width>100}},created:function(){var t=this;this.$tqsdk.subscribe_quote(this.symbol),this.$tqsdk.on("rtn_data",(function(){var e=t.$tqsdk.getQuote(t.symbol);console.log(e),tt(t.quote,e)}))},methods:{formatter:function(t){return B(t,this.quote.price_decs)}}};function tt(t,e){Object.keys(Z).forEach((function(r,s,n){t[r]!==e[r]&&(t[r]=e[r])}))}var et=X,rt=(r("19da"),Object(m["a"])(et,J,V,!1,null,null,null)),st=rt.exports,nt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"about-us"},[s("a",{attrs:{href:"https://doc.shinnytech.com/tqsdk/latest/",target:"_blank"}},[s("img",{staticClass:"logo",attrs:{alt:"Tianqin",src:r("cf05")}}),t._v(" 天勤量化"),t.width>100?s("span",[t._v("开发文档")]):t._e()]),s("a",{attrs:{href:"https://www.shinnytech.com/qa/",target:"_blank"}},[s("Icon",{attrs:{type:"ios-chatbubbles"}}),t._v(" 天勤"),t.width>100?s("span",[t._v("量化")]):t._e(),t._v("论坛 ")],1)])},it=[],ot={props:{width:Number}},at=ot,_t=(r("2975"),Object(m["a"])(at,nt,it,!1,null,null,null)),ct=_t.exports,ut=function(){return document.addEventListener?function(t,e,r){t&&e&&r&&t.addEventListener(e,r,!1)}:function(t,e,r){t&&e&&r&&t.attachEvent("on"+e,r)}}(),dt=function(){return document.removeEventListener?function(t,e,r){t&&e&&t.removeEventListener(e,r,!1)}:function(t,e,r){t&&e&&t.detachEvent("on"+e,r)}}(),lt={name:"tq-top-view",components:{TqLayoutArea:g,TqChartComponents:W,ButtonGroupDurations:M,QuoteInfo:st,SubscribedList:G,AboutUs:ct},props:{width:Number,height:Number},data:function(){var t=200,e=80;return{rightClosed:!1,rightOpenedWidth:t,rightClosedWidth:e,instrumentId:"",duration:6e10,theme:"light"}},computed:{chartWidth:function(){var t=this.$root.windowWidth-(this.rightClosed?this.rightClosedWidth:this.rightOpenedWidth);return Math.max(t,400)},rightWidth:function(){return(this.rightClosed?this.rightClosedWidth:this.rightOpenedWidth)-4}},methods:{toggleRightClosed:function(){this.rightClosed=!this.rightClosed},onChangeDuration:function(t){console.log("onChangeDuration",t),this.duration=t},onChangeSelectedSubscribed:function(t,e){console.log(t,e),this.instrumentId=t,this.duration=e||6e10}},created:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){t.subscribed=t.$tqsdk.get_by_path(["subscribed"]),t.subscribed&&t.subscribed[0]&&""===t.instrumentId&&(t.subscribedIndex=0,t.instrumentId=Array.isArray(t.subscribed[0].symbol)?t.subscribed[0].symbol[0]:t.subscribed[0].symbol,t.duration=t.subscribed[0].dur_nano||6e10)}))}},ht=lt,ft=(r("f451"),Object(m["a"])(ht,k,O,!1,null,null,null)),pt=ft.exports,mt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tq-bottom-view"},["backtest"===t.$store.state.mode?[r("tq-layout-area",{attrs:{width:t.width/2,height:t.height}},[r("Tabs",{attrs:{animated:!1}},[r("TabPane",{attrs:{label:"回测指标"}},[r("backtest-info",{attrs:{width:t.width,height:t.height-27}})],1),r("TabPane",{attrs:{label:"成交记录"}},[r("trades-table",{attrs:{width:t.width,height:t.height-27}})],1)],1)],1),r("tq-layout-area",{attrs:{horizontalAlign:"right",width:t.width/2,height:t.height,otherStyle:{borderLeft:"2px solid #E0E0E0"}}},[r("backtest-chart")],1)]:"run"===t.$store.state.mode?[r("tq-layout-area",{attrs:{height:26,width:t.width}},[r("account-info",{attrs:{height:26}})],1),r("tq-layout-area",{attrs:{height:t.height-26,top:26,width:t.width}},[r("Tabs",[r("TabPane",{attrs:{label:"持仓"}},[r("positions-table",{attrs:{width:t.width,height:t.height-53}})],1),r("TabPane",{attrs:{label:"成交记录"}},[r("trades-table",{attrs:{width:t.width,height:t.height-53}})],1),r("TabPane",{attrs:{label:"委托单记录"}},[r("orders-table",{attrs:{width:t.width,height:t.height-53}})],1)],1)],1)]:t._e()],2)},bt=[],gt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"reports trades-table",style:{height:t.height+"px"}},[r("table",[r("thead",[r("tr",t._l(t.columns,(function(e){return r("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])})),0)]),r("tbody")])])},yt=[],vt=(r("4e82"),{data:function(){return{tbodyRoot:null,columns:[{name:"成交合约",key:"instrument_id",width:"100",cb:function(t){return t.exchange_id+"."+t.instrument_id}},{name:"方向",key:"direction",width:"60",cb:function(t){return $(t.direction)}},{name:"开平",key:"offset",width:"60",cb:function(t){return U(t.offset)}},{name:"成交价格",width:"60",key:"price"},{name:"手数",width:"60",key:"volume"},{name:"成交时间",key:"trade_date_time",width:"140",cb:function(t){return i()(t.trade_date_time/1e6).format("YYYY-MM-DD HH:mm:ss")}},{name:"报单编号",key:"trade_id"}]}},props:{height:Number},mounted:function(){this.tbodyNode=document.querySelector(".trades-table table tbody");var t=this,e=function(){var e=t.$store.state.account_id;if(e){var r=[],s=t.$tqsdk.get({name:"trades",user_id:e});if(s){for(var n in s)s[n]._epoch===t.$tqsdk.dm._epoch&&r.push(s[n]);r.sort((function(t,e){return t.trade_date_time-e.trade_date_time}));for(var i=function(e){var s=t.append_trade(r[e]);s.onclick=function(n){var i=t.tbodyNode.querySelectorAll("tr");i.forEach((function(t){return t.className=""})),s.className="selected",t.$eventHub.$emit("moveChartToDt",r[e].trade_date_time)}},o=0;o<r.length;o++)i(o)}}};e(),this.$tqsdk.on("rtn_data",e)},methods:{append_trade:function(t){var e=document.createElement("tr");for(var r in this.columns){var s=this.columns[r],n=this.get_td_text(s.cb?s.cb(t):t[s.key],s.key);e.appendChild(n)}return this.tbodyNode.insertBefore(e,this.tbodyNode.firstChild),e},get_td_text:function(t){var e=document.createElement("td");return e.textContent=t,e}}}),wt=vt,Et=Object(m["a"])(wt,gt,yt,!1,null,null,null),kt=Et.exports,Ot=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"reports orders-table",style:{height:t.height+"px"}},[r("table",[r("thead",[r("tr",[t._l(t.columns,(function(e){return r("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])})),t._l(t.columnsAppend,(function(e){return r("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])}))],2)]),r("tbody")])])},Ct=[],jt={data:function(){return{tbodyRoot:null,columns:[{name:"成交合约",width:"100",key:"instrument_id",cb:function(t){return t.exchange_id+"."+t.instrument_id}},{name:"方向",width:"60",key:"direction",cb:function(t){return $(t.direction)}},{name:"开平",width:"60",key:"offset",cb:function(t){return U(t.offset)}},{name:"报单价格",width:"60",key:"limit_price"},{name:"总手数",width:"60",key:"volume_orign"},{name:"报单时间",width:"140",key:"insert_date_time",cb:function(t){return i()(t.insert_date_time/1e6).format("YYYY-MM-DD HH:mm:ss")}}],columnsAppend:[{name:"未成交手数",key:"volume_left",width:"80",cb:function(t){return t.volume_left}},{name:"冻结保证金",width:"80",key:"frozen_margin"},{name:"状态",width:"60",key:"status",cb:function(t){return"FINISHED"===t.status?"已完成":"未完成"}},{name:"提示信息",key:"last_msg"}],ordersTr:{}}},props:{height:Number},mounted:function(){this.tbodyNode=document.querySelector(".orders-table table tbody");var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$store.state.account_id;if(e){var r=t.$tqsdk.get({name:"orders",user_id:e});if(r){var s=function(e){if(t.ordersTr[e])t.update_order(r[e],t.ordersTr[e]);else{var s=t.append_order(r[e]);s.onclick=function(n){var i=t.tbodyNode.querySelectorAll("tr");i.forEach((function(t){return t.className=""})),s.className="selected",t.$eventHub.$emit("moveChartToDt",r[e].insert_date_time)},t.ordersTr[e]=s}};for(var n in r)s(n)}}}))},methods:{append_order:function(t){var e=document.createElement("tr");for(var r in this.columns){var s=this.columns[r],n=this.get_td_text(s.cb?s.cb(t):t[s.key],s.key);e.appendChild(n)}for(var i in this.columnsAppend){var o=this.columnsAppend[i],a=this.get_td_text(o.cb?o.cb(t):t[o.key],o.key);e.appendChild(a)}return this.tbodyNode.insertBefore(e,this.tbodyNode.firstChild),e},update_order:function(t,e){for(var r in this.columnsAppend){var s=this.columns[r],n=e.querySelector("."+s.key),i=s.cb?s.cb(t):t[s.key];i!==n.textContent&&this.update_td_text(i,n)}},get_td_text:function(t,e){var r=document.createElement("td");return r.className=e,r.textContent=t,r},update_td_text:function(t,e){e.textContent=t}}},Dt=jt,Pt=Object(m["a"])(Dt,Ot,Ct,!1,null,null,null),qt=Pt.exports,Tt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"reports positions-table",style:{height:t.height+"px"}},[r("table",[r("thead",[r("tr",[t._l(t.columns,(function(e){return r("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])})),t._l(t.columnsAppend,(function(e){return r("th",{attrs:{width:e.width?e.width+"px":""}},[t._v(t._s(e.name))])}))],2)]),r("tbody")])])},Mt=[],xt={data:function(){return{tbodyRoot:null,columns:[{name:"持仓合约",width:"100",key:"instrument_id",cb:function(t){return t.exchange_id+"."+t.instrument_id}}],columnsAppend:[{name:"多仓",key:"volume_long",width:"60"},{name:"多头开仓均价",width:"80",key:"open_price_long"},{name:"多头浮动盈亏",width:"80",key:"position_profit_long"},{name:"多头占用保证金",width:"80",key:"margin_long",cb:function(t){return t.margin_long.toFixed?t.margin_long.toFixed(2):t.margin_long}},{name:"空仓",key:"volume_short",width:"60"},{name:"空头开仓均价",width:"80",key:"open_price_short"},{name:"空头浮动盈亏",width:"80",key:"position_profit_short"},{name:"空头占用保证金",width:"80",key:"margin_short",cb:function(t){return t.margin_short.toFixed?t.margin_short.toFixed(2):t.margin_short}}],ordersTr:{}}},props:{height:Number},mounted:function(){this.tbodyNode=document.querySelector(".positions-table table tbody");var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$store.state.account_id;if(e){var r=t.$tqsdk.get({name:"positions",user_id:e});if(r)for(var s in r)r[s]._epoch===t.$tqsdk.dm._epoch&&(t.ordersTr[s]?t.update_position(r[s],t.ordersTr[s]):t.ordersTr[s]=t.append_position(r[s]))}}))},methods:{append_position:function(t){var e=document.createElement("tr");for(var r in this.columns){var s=this.columns[r],n=this.get_td_text(s.cb?s.cb(t):t[s.key],s.key);e.appendChild(n)}for(var i in this.columnsAppend){var o=this.columnsAppend[i],a=this.get_td_text(o.cb?o.cb(t):t[o.key],o.key);e.appendChild(a)}return this.tbodyNode.insertBefore(e,this.tbodyNode.firstChild),e},update_position:function(t,e){for(var r in this.columnsAppend){var s=this.columnsAppend[r],n=e.querySelector("."+s.key),i=s.cb?s.cb(t):t[s.key];i!==n.textContent&&this.update_td_text(i,n)}},get_td_text:function(t,e){var r=document.createElement("td");return r.className=e,r.textContent=t,r},update_td_text:function(t,e){e.textContent=t}}},St=xt,It=Object(m["a"])(St,Tt,Mt,!1,null,null,null),At=It.exports,Lt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"account-info",style:{height:t.height+"px"}},[r("div",[t._v(" 账户权益: "+t._s(t.balance)+" ")]),r("div",[t._v(" 浮动盈亏: "+t._s(t.float_profit)+" ")]),r("div",[t._v(" 保证金占用: "+t._s(t.margin)+" ")]),r("div",[t._v(" 日内手续费: "+t._s(t.commission)+" ")]),r("div",[t._v(" 可用资金: "+t._s(t.available)+" ")])])},Wt=[],Rt={data:function(){return{available:"-",balance:"-",commission:"-",float_profit:"-",margin:"-"}},props:{height:Number},mounted:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$store.state.account_id;if(e){var r=t.$tqsdk.get({name:"account",user_id:e,currency:"CNY"});r._epoch===t.$tqsdk.dm._epoch&&(t.available=r.available,t.balance=r.balance,t.commission=r.commission,t.float_profit=r.float_profit,t.margin=r.margin)}}))}},Kt=Rt,Bt=(r("a240"),Object(m["a"])(Kt,Lt,Wt,!1,null,null,null)),$t=Bt.exports,Ut=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"backtest-info",style:{height:t.height+"px"}},[r("Row",["-"===t.init_balance?r("Col",{attrs:{span:24,"class-name":"spin-container"}},[r("Spin",{attrs:{fix:""}},[r("div",{staticClass:"loader"},[r("svg",{staticClass:"circular",attrs:{viewBox:"25 25 50 50"}},[r("circle",{staticClass:"path",attrs:{cx:"50",cy:"50",r:"20",fill:"none","stroke-width":"6","stroke-miterlimit":"10"}})])]),t._v(" 回测进行中 ")])],1):t._e()],1),r("Row",[r("Col",{attrs:{span:6}},[t._v("起始资金")]),r("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.init_balance,2)))]),r("Col",{attrs:{span:6}},[t._v("总收益")]),r("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.balance-t.init_balance,2)))]),r("Col",{attrs:{span:6}},[t._v("结束资金")]),r("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.balance,2)))]),r("Col",{attrs:{span:6}},[t._v("总收益率")]),r("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.ror,2))+"%")]),r("Col",{attrs:{span:6}},[t._v("最大回撤")]),r("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.max_drawdown,2)))]),r("Col",{attrs:{span:6}},[t._v("年化收益率")]),r("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.annual_yield,2))+"%")]),r("Col",{attrs:{span:6}},[t._v("总手续费")]),r("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.commission,2)))]),r("Col",{attrs:{span:6}},[t._v("年化夏普率")]),r("Col",{attrs:{span:6}},[t._v(t._s(t._f("toFixed")(t.sharpe_ratio,2))+"%")]),r("Col",{attrs:{span:12}},[t._v(t._s(t.getMsg(t.ror)))])],1)],1)},zt=[],Nt={data:function(){return{init_balance:"-",balance:"-",ror:"-",annual_yield:"-",max_drawdown:"-",sharpe_ratio:"-",commission:"-"}},props:{height:Number,width:Number},methods:{getMsg:function(t){return t<=-100?"幸好是模拟账户，不然你就亏完啦":t<=-50?"触底反弹,与其执迷修改参数，不如改变策略思路去天勤官网策略库进修":t<=-20?"越挫越勇，不如去天勤量化官网策略库进修":t<=0?"不要灰心，少侠重新来过":t<=20?"策略看来小有所成":t<=50?"策略看来的得心应手":t<=100?"策略看来春风得意，堪比当代索罗斯":"策略看来独孤求败，小心过拟合噢"}},mounted:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$store.state.account_id;if(console.log(e,"d account_id"),e){var r=t.$tqsdk.get({name:"account",user_id:e,currency:"CNY"});if(r&&r._tqsdk_stat){t.init_balance=r._tqsdk_stat.init_balance,t.balance=r._tqsdk_stat.balance,t.max_drawdown=r._tqsdk_stat.max_drawdown,t.annual_yield=r._tqsdk_stat.annual_yield,t.ror=r._tqsdk_stat.ror,t.sharpe_ratio=r._tqsdk_stat.sharpe_ratio;var s=t.$tqsdk.get({name:"trades",user_id:e}),n=0;for(var i in s)n+=s[i].commission;t.commission=n}}}))}},Qt=Nt,Ht=(r("5ab6"),Object(m["a"])(Qt,Ut,zt,!1,null,null,null)),Ft=Ht.exports,Yt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"backtest-report"},[r("e-chart",{ref:"echart",attrs:{height:"240px",width:t.width+"px","path-option":t.defaultOption}})],1)},Gt=[],Jt=(r("25eb"),r("a6fb")),Vt=r.n(Jt),Zt=r("313e"),Xt=r.n(Zt);(function(){var t=function(t,e,r){r=r||window;var s=!1,n=function(){s||(s=!0,requestAnimationFrame((function(){r.dispatchEvent(new CustomEvent(e)),s=!1})))};r.addEventListener(t,n)};t("resize","optimizedResize")})();var te={name:"v-echart",render:function(t){var e={staticClass:"v-chart",style:this.canvasStyle,ref:"canvas",on:this.$listeners};return t("div",e)},props:{width:{type:String,default:"auto"},height:{type:String,default:"400px"},pathOption:[Object,Array],widthChangeDelay:{type:Number,default:450}},data:function(){return{chartInstance:null,_defaultOption:{animation:!1,tooltip:{show:!0},title:{show:!0,textStyle:{fontSize:"16px",color:"rgba(0, 0, 0 , .87)",fontFamily:"sans-serif"}},grid:{containLabel:!0},xAxis:{show:!0,type:"category",axisLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}},axisTick:{show:!0,alignWithLabel:!0,lineStyle:{show:!0,color:"rgba(0, 0, 0 , .24)"}},axisLabel:{show:!1},splitLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}}},yAxis:{show:!0,type:"value",max:"dataMax",min:"dataMin",axisLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}},axisLabel:{show:!1,color:"rgba(0, 0, 0 , .24)"},splitLine:{lineStyle:{color:"rgba(0, 0, 0 , .24)"}},axisTick:{show:!0,lineStyle:{show:!0,color:"rgba(0, 0, 0 , .54)"}}},series:[{type:"line"}]}}},computed:{canvasStyle:function(){return{width:this.width,height:this.height}}},methods:{init:function(){var t=this;this.pathOption&&this.pathOption.forEach((function(e){Vt.a.set(t.$data._defaultOption,e[0],e[1])})),this.chartInstance=Xt.a.init(this.$refs.canvas),this.chartInstance.setOption(this.$data._defaultOption),window.addEventListener("optimizedResize",(function(e){setTimeout((function(e){t.chartInstance.resize()}),t.widthChangeDelay)}))},showLoadPercent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&t<100?(t=Math.max(t,0),this.chartInstance.showLoading("default",{text:"数据已加载 "+t+"%",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0})):this.chartInstance.hideLoading()},update:function(t){this.chartInstance.setOption(t)},resize:function(){this.chartInstance.resize()},clean:function(){window.removeEventListener("resize",this.chartInstance.resize),this.chartInstance.clear()}},mounted:function(){this.init()},beforeDestroy:function(){this.clean()}},ee={components:{EChart:te},data:function(){return{daily_yield:[],defaultOption:[["grid.top","16px"],["grid.left","10px"],["grid.bottom","0px"],["grid.right","16px"],["series[0]",{type:"line",encode:{x:"datetime",y:["balance"]},smooth:!1,showAllSymbol:!0,areaStyle:{}}],["yAxis.show",!0],["yAxis.type","value"],["yAxis.axisLabel",{show:!0,formatter:function(t,e){return t.toFixed(2)},color:"#333333"}],["yAxis.splitLine",{show:!0}],["xAxis.show",!0],["xAxis.type","time"],["xAxis.axisLabel",{show:!0,color:"#333333"}],["xAxis.splitLine",{show:!0}],["xAxis.boundaryGap",!1],["tooltip",{trigger:"axis",triggerOn:"mousemove|click"}]]}},props:{height:Number,width:Number},methods:{},mounted:function(){var t=this;this.$tqsdk.on("rtn_data",(function(){var e=t.$tqsdk.get_by_path(["snapshots"]),r=[];for(var s in e)s>t.$store.state.end_dt||r.push([Number.parseInt(s/1e6),e[s].accounts.CNY.balance]);t.$refs.echart.update({dataset:{source:r}})}))}},re=ee,se=(r("b7de"),Object(m["a"])(re,Yt,Gt,!1,null,null,null)),ne=se.exports,ie={name:"tq-bottom-view",components:{TqLayoutArea:g,TradesTable:kt,OrdersTable:qt,PositionsTable:At,AccountInfo:$t,BacktestInfo:Ft,BacktestChart:ne},props:{height:Number,width:Number},data:function(){return{}},methods:{},created:function(){}},oe=ie,ae=(r("1a2d3"),Object(m["a"])(oe,mt,bt,!1,null,null,null)),_e=ae.exports,ce=38,ue=4,de=56,le={name:"tq-home",components:{TqHeaderView:E,TqTopView:pt,TqBottomView:_e},data:function(){var t=400,e=ce+t+ue;return{isMoving:!1,headerHeight:ce,topHeight:t,topHeightMin:260,bottomYOffset:e,bottomYOffsetMin:2*ce,bottomYOffsetMax:this.$root.windowHeight-de,bottomHeight:this.$root.windowHeight-e-ue,showBottomShadow:!1}},methods:{onResize:function(){this.bottomYOffsetMax=this.$root.windowHeight-de,this.computeLayouts()},handleMousedown:function(t){this.isMoving=!0,ut(document,"mousemove",this.handleMove),ut(document,"mouseup",this.handleUp)},handleMove:function(t){var e=t.pageY;e>=this.bottomYOffsetMax||e<=this.bottomYOffsetMin||(this.bottomYOffset=e,this.computeLayouts())},handleUp:function(){this.isMoving=!1,dt(document,"mousemove",this.handleMove),dt(document,"mouseup",this.handleUp)},computeLayouts:function(){var t=this.$root.windowHeight-this.bottomYOffset;t<=de&&(t=de,this.bottomYOffset=this.$root.windowHeight-t),this.showBottomShadow=this.bottomYOffset<this.topHeightMin+ce,this.bottomHeight=t-ue;var e=this.$root.windowHeight-ce-t-ue;this.topHeight=Math.max(e,this.topHeightMin)}},created:function(){this.$eventHub.$on("window_resize",this.onResize),this.computeLayouts()}},he=le,fe=(r("a124"),Object(m["a"])(he,_,c,!1,null,null,null)),pe=fe.exports,me={name:"tq-app",components:{Tianqin:pe}},be=me,ge=(r("5c0b"),Object(m["a"])(be,o,a,!1,null,null,null)),ye=ge.exports,ve=r("b090"),we=r("8629"),Ee=r("f843"),ke=r("8144"),Oe=r("2d48"),Ce=r("6def"),je=r("e79d"),De=r("90b2"),Pe=r("c5c1"),qe=r("dcbf"),Te=r("e3f5"),Me=r("5250"),xe=r("76ea"),Se=r("b3e6"),Ie=r("8679"),Ae=r("fe66"),Le=r("6252"),We=r("9259"),Re=r("aa30"),Ke=r("e0b9");s["a"].prototype.$Loading=Ke["a"],s["a"].prototype.$Message=Re["a"],s["a"].prototype.$Modal=We["a"],s["a"].prototype.$Notice=Le["a"],s["a"].prototype.$Spin=Ae["a"],s["a"].component("Layout",Ie["a"]),s["a"].component("Row",Se["a"]),s["a"].component("Col",xe["a"]),s["a"].component("Icon",Me["a"]),s["a"].component("Button",Te["a"]),s["a"].component("ButtonGroup",qe["a"]),s["a"].component("Dropdown",Pe["a"]),s["a"].component("DropdownMenu",De["a"]),s["a"].component("DropdownItem",je["a"]),s["a"].component("Badge",Ce["a"]),s["a"].component("Radio",Oe["a"]),s["a"].component("RadioGroup",ke["a"]),s["a"].component("Tabs",Ee["a"]),s["a"].component("TabPane",we["a"]),s["a"].component("Spin",Ae["a"]);var Be=r("2f62");s["a"].use(Be["a"]);var $e=new Be["a"].Store({state:{mode:"",broker_id:"",account_id:"",py_file_status:"",md_url_status:"",td_url_status:"",file_path:"",file_name:""},mutations:{set_action:function(t,e){Object.assign(t,e)},set_py_file_status:function(t,e){t.py_file_status=e}},actions:{}}),Ue=$e;s["a"].config.productionTip=!1,s["a"].$eventHub=new s["a"],s["a"].prototype.$eventHub=s["a"].$eventHub;var ze={name:"tianqin-web",windowHeight:window.innerHeight,windowWidth:window.innerWidth},Ne=new s["a"]({data:ze,store:Ue,render:function(t){return t(ye)},methods:{handlerResize:function(){ze.windowHeight=window.innerHeight,ze.windowWidth=window.innerWidth,this.$eventHub.$emit("window_resize",{width:ze.windowWidth,height:ze.windowHeight})}},created:function(){var t;function e(){t||(t=setTimeout((function(){t=null,Ne.handlerResize()}),200))}window.addEventListener("resize",e,!1)},errorCaptured:function(t,e,r){return console.error("App.errorCaptured",t,e,r),!1},destroyed:function(){}});s["a"].filter("toFixed",(function(t,e){var r=Number(t);return e=Number.isInteger(e)?e:2,Number.isFinite(r)?r.toFixed(e):t})),GetTqsdkUrl().then((function(t){var e=t["ins_url"],r=t["md_url"],n=t["ws_url"];if("https://openmd.shinnytech.com/t/md/symbols/latest.json"===e){var o=i()().format("YYYY-MM-DD HH:mm:ss.SSSSSS");e="https://openmd.shinnytech.com/t/md/symbols/".concat(o,".json")}s["a"].$tqsdk=new ve["a"]({symbolsServerUrl:e,wsQuoteUrl:r,wsTradeUrl:n}),s["a"].prototype.$tqsdk=s["a"].$tqsdk,s["a"].$tqsdk.on("rtn_data",(function(){var t=s["a"].$tqsdk.get_by_path(["_tqsdk_backtest"]);t&&t.current_dt&&(Ue.state.start_dt=t.start_dt,Ue.state.end_dt=t.end_dt);var e=s["a"].$tqsdk.get_by_path(["action"]);""===Ue.state.mode&&e&&Ue.commit("set_action",e)})),s["a"].$tqsdk.defaultTradeWs.on("close",(function(){Ue.commit("set_py_file_status",!1)})),s["a"].$tqsdk.defaultTradeWs.on("open",(function(){Ue.commit("set_py_file_status",!0)})),Ne.$mount("#app")}))},"5ab6":function(t,e,r){"use strict";var s=r("d85d"),n=r.n(s);n.a},"5c0b":function(t,e,r){"use strict";var s=r("9c0c"),n=r.n(s);n.a},"5c44":function(t,e,r){},6491:function(t,e,r){},"657e":function(t,e,r){},"889f":function(t,e,r){},"8e24":function(t,e,r){"use strict";var s=r("889f"),n=r.n(s);n.a},"8fde":function(t,e,r){},"9c0c":function(t,e,r){},a124:function(t,e,r){"use strict";var s=r("657e"),n=r.n(s);n.a},a240:function(t,e,r){"use strict";var s=r("07f6"),n=r.n(s);n.a},a829:function(t,e,r){},b090:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("cace"),core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("ff42"),core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_symbol_iterator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("6654"),core_js_modules_es_symbol_iterator__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_symbol_iterator__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("8415"),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("9843"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("791d"),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("68d8"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("56bf"),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("e7a5"),core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("aa27"),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("bafe"),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("0835"),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_number_is_finite__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("f468"),core_js_modules_es_number_is_finite__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_number_is_finite__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es_object_entries__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("1f3f"),core_js_modules_es_object_entries__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es_object_entries__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_es_object_get_own_property_descriptor__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("33f5"),core_js_modules_es_object_get_own_property_descriptor__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_es_object_get_own_property_descriptor__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_es_object_get_prototype_of__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("974c"),core_js_modules_es_object_get_prototype_of__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_es_object_get_prototype_of__WEBPACK_IMPORTED_MODULE_15__),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("3f13"),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_16__),core_js_modules_es_object_set_prototype_of__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("4008"),core_js_modules_es_object_set_prototype_of__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(core_js_modules_es_object_set_prototype_of__WEBPACK_IMPORTED_MODULE_17__),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("3f38"),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_18__),core_js_modules_es_reflect_get__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("7583"),core_js_modules_es_reflect_get__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(core_js_modules_es_reflect_get__WEBPACK_IMPORTED_MODULE_19__),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("3ffb"),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_20__),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("5720"),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_21__),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("7e4c"),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_22___default=__webpack_require__.n(core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_22__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("6af8"),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_23___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_23__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("f12a"),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_24__),core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("b3b0"),core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_25___default=__webpack_require__.n(core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_25__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("f455"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_26___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_26__),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("b520"),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_27___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_27__),core_js_modules_web_immediate__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("faf8"),core_js_modules_web_immediate__WEBPACK_IMPORTED_MODULE_28___default=__webpack_require__.n(core_js_modules_web_immediate__WEBPACK_IMPORTED_MODULE_28__),_Users_yanqiong_Documents_Github_shinny_futures_web_node_modules_babel_runtime_corejs3_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__("bf2d"),axios__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__("4b02"),axios__WEBPACK_IMPORTED_MODULE_30___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_30__),version="1.1.0";function _typeof(t){return _typeof="function"===typeof Symbol&&"symbol"===Object(_Users_yanqiong_Documents_Github_shinny_futures_web_node_modules_babel_runtime_corejs3_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_29__["a"])(Symbol.iterator)?function(t){return Object(_Users_yanqiong_Documents_Github_shinny_futures_web_node_modules_babel_runtime_corejs3_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_29__["a"])(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":Object(_Users_yanqiong_Documents_Github_shinny_futures_web_node_modules_babel_runtime_corejs3_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_29__["a"])(t)},_typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _inherits(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _possibleConstructorReturn(t,e){return!e||"object"!==Object(_Users_yanqiong_Documents_Github_shinny_futures_web_node_modules_babel_runtime_corejs3_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_29__["a"])(e)&&"function"!==typeof e?_assertThisInitialized(t):e}function _superPropBase(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=_getPrototypeOf(t),null===t)break;return t}function _get(t,e,r){return _get="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var s=_superPropBase(t,e);if(s){var n=Object.getOwnPropertyDescriptor(s,e);return n.get?n.get.call(r):n.value}},_get(t,e,r||t)}function createCommonjsModule(t,e){return e={exports:{}},t(e,e.exports),e.exports}var eventemitter3=createCommonjsModule((function(t){var e=Object.prototype.hasOwnProperty,r="~";function s(){}function n(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,s,i,o){if("function"!==typeof s)throw new TypeError("The listener must be a function");var a=new n(s,i||t,o),_=r?r+e:e;return t._events[_]?t._events[_].fn?t._events[_]=[t._events[_],a]:t._events[_].push(a):(t._events[_]=a,t._eventsCount++),t}function o(t,e){0===--t._eventsCount?t._events=new s:delete t._events[e]}function a(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(r=!1)),a.prototype.eventNames=function(){var t,s,n=[];if(0===this._eventsCount)return n;for(s in t=this._events)e.call(t,s)&&n.push(r?s.slice(1):s);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},a.prototype.listeners=function(t){var e=r?r+t:t,s=this._events[e];if(!s)return[];if(s.fn)return[s.fn];for(var n=0,i=s.length,o=new Array(i);n<i;n++)o[n]=s[n].fn;return o},a.prototype.listenerCount=function(t){var e=r?r+t:t,s=this._events[e];return s?s.fn?1:s.length:0},a.prototype.emit=function(t,e,s,n,i,o){var a=r?r+t:t;if(!this._events[a])return!1;var _,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,s),!0;case 4:return u.fn.call(u.context,e,s,n),!0;case 5:return u.fn.call(u.context,e,s,n,i),!0;case 6:return u.fn.call(u.context,e,s,n,i,o),!0}for(c=1,_=new Array(d-1);c<d;c++)_[c-1]=arguments[c];u.fn.apply(u.context,_)}else{var l,h=u.length;for(c=0;c<h;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,s);break;case 4:u[c].fn.call(u[c].context,e,s,n);break;default:if(!_)for(l=1,_=new Array(d-1);l<d;l++)_[l-1]=arguments[l];u[c].fn.apply(u[c].context,_)}}return!0},a.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},a.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},a.prototype.removeListener=function(t,e,s,n){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return o(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||n&&!a.once||s&&a.context!==s||o(this,i);else{for(var _=0,c=[],u=a.length;_<u;_++)(a[_].fn!==e||n&&!a[_].once||s&&a[_].context!==s)&&c.push(a[_]);c.length?this._events[i]=1===c.length?c[0]:c:o(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&o(this,e)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})),IsEmptyObject=function(t){return t&&t.constructor===Object&&0===Object.keys(t).length},RandomStr=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),r="",s=0;s<t;s++)r+=e[62*Math.random()|0];return r};function _genList(t){for(var e=[],r=t.split("|"),s=0;s<r.length;s++)e.push(r[s].trim());return e}function _genItem(t,e){for(var r={},s=0;s<t.length;s++)r[t[s]]=e[s];return r}function _genTableRow(t,e,r,s){var n={state:t,state_detail:e,isRow:!1,row:null};switch(e){case"T":""===s.replace(/-/g,"")?n.state_detail="C":r[t]=_genList(s);break;case"C":""===s.replace(/-/g,"")?n.state_detail="S":(n.isRow=!0,n.row=_genItem(r[t],_genList(s)));break;case"S":""===s.replace(/-/g,"")&&(n.state="",n.state_detail="");break}return n}var ParseSettlementContent=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(""===t)return t;var e=t.split("\n"),r="",s="",n={},i={positionClosed:"平仓明细 Position Closed",transactionRecords:"成交记录 Transaction Record",positions:"持仓汇总 Positions",positionsDetail:"持仓明细 Positions Detail",delivery:"交割明细  Delivery"},o=[],a=[],_={account:{}};Object.entries(i).forEach((function(t){o.push(t[0]),a.push(t[1]),_[t[0]]=[]}));for(var c=0;c<e.length;c++){var u=e[c].trim();if("资金状况  币种：人民币  Account Summary  Currency：CNY"!==u){if(a.includes(u))r=o[a.indexOf(u)],s="T",c++;else if("A-S"===r){if(0===u.length||""===u.replace("-","")){r="";continue}u.match(/([\u4e00-\u9fa5][\u4e00-\u9fa5\s]+[\u4e00-\u9fa5])+/g);for(var d=u.match(/([A-Z][a-zA-Z\.\/\(\)\s]+)[:：]+/g),l=u.match(/(-?[\d]+\.\d\d)/g),h=0;h<d.length;h++)_.account[d[h].split(/[:：]/)[0]]=l[h]}else if(o.includes(r)){if(0===u.length){r="";continue}var f=_genTableRow(r,s,n,u);r=f.state,s=f.state_detail,f.isRow&&_[r].push(f.row)}}else r="A-S",c++}return _},TqWebsocket=function(_EventEmitter){function TqWebsocket(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,TqWebsocket),e=_possibleConstructorReturn(this,_getPrototypeOf(TqWebsocket).call(this)),e.urlList=t instanceof Array?t:[t],e.ws=null,e.queue=[],e.reconnect=!0,e.reconnectTask=null,e.reconnectInterval=r.reconnectInterval?r.reconnectInterval:3e3,e.reconnectMaxTimes=r.reconnectMaxTimes?r.reconnectMaxTimes:5,e.reconnectTimes=0,e.reconnectUrlIndex=0,e.STATUS={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},e.__init(),e}return _inherits(TqWebsocket,_EventEmitter),_createClass(TqWebsocket,[{key:"send",value:function(t){var e=JSON.stringify(t);this.isReady()?this.ws.send(e):this.queue.push(e)}},{key:"isReady",value:function(){return this.ws.readyState===WebSocket.OPEN}},{key:"__init",value:function __init(){this.ws=new WebSocket(this.urlList[this.reconnectUrlIndex]),this.reconnectUrlIndex===this.urlList.length-1&&(this.reconnectTimes+=1);var _this=this;this.ws.onmessage=function(message){var data=eval("("+message.data+")");_this.emit("message",data),setImmediate((function(){_this.ws.send('{"aid":"peek_message"}')}))},this.ws.onclose=function(t){console.log("close",t),_this.emit("close"),_this.queue=[],_this.reconnect&&(_this.reconnectMaxTimes<=_this.reconnectTimes?(clearTimeout(_this.reconnectTask),_this.emit("death",{msg:"超过重连次数"+_this.reconnectMaxTimes})):_this.reconnectTask=setTimeout((function(){3===_this.ws.readyState&&(_this.reconnectUrlIndex=_this.reconnectUrlIndex+1<_this.urlList.length?_this.reconnectUrlIndex+1:0,_this.__init(),_this.emit("reconnect",{msg:"发起重连第 "+_this.reconnectTimes+" 次"}))}),_this.reconnectInterval))},this.ws.onerror=function(t){_this.emit("error",t),_this.ws.close()},this.ws.onopen=function(){_this.emit("open",{msg:"发起重连第 "+_this.reconnectTimes+" 次, 成功"}),_this.reconnectTimes=0,_this.reconnectUrlIndex=0,this.reconnectTask&&clearTimeout(_this.reconnectTask);while(_this.queue.length>0){if(1!==_this.ws.readyState)break;_this.ws.send(_this.queue.shift())}}}},{key:"close",value:function(){this.ws.onclose=function(){},this.ws.close()}}]),TqWebsocket}(eventemitter3),TqTradeWebsocket=function(t){function e(t,r){var s,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _classCallCheck(this,e),s=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t,n)),s.dm=r,s.req_login=null,s.init(),s}return _inherits(e,t),_createClass(e,[{key:"init",value:function(){var t=this;this.on("message",(function(e){if("rtn_data"===e.aid){for(var r=t._separateNotifies(e.data),s=0;s<r.length;s++)t.emit("notify",r[s]);t.dm.mergeData(e.data)}else if("rtn_brokers"===e.aid)t.emit("rtn_brokers",e.brokers);else if("qry_settlement_info"===e.aid){var n=ParseSettlementContent(e.settlement_info);t.dm.mergeData({trade:_defineProperty({},e.user_name,{his_settlements:_defineProperty({},e.trading_day,n)})}),TQSDK.store&&TQSDK.store.setContent(e.user_name,e.trading_day,e.settlement_info)}})),this.on("reconnect",(function(){t.req_login&&t.send(t.req_login)}))}},{key:"_separateNotifies",value:function(t){for(var e=[],r=0;r<t.length;r++)if(t[r].notify){var s=t.splice(r--,1)[0].notify;for(var n in s)e.push(s[n])}return e}},{key:"send",value:function(t){"req_login"===t.aid&&(this.req_login=t),_get(_getPrototypeOf(e.prototype),"send",this).call(this,t)}}]),e}(TqWebsocket),TqQuoteWebsocket=function(t){function e(t,r){var s,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _classCallCheck(this,e),s=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t,n)),s.dm=r,s.subscribe_quote=null,s.charts={},s.init(),s}return _inherits(e,t),_createClass(e,[{key:"init",value:function(){var t=this;this.on("message",(function(e){"rtn_data"===e.aid&&t.dm.mergeData(e.data)})),this.on("reconnect",(function(e){for(var r in console.log(e),t.subscribe_quote&&t.send(t.subscribe_quote),t.charts)t.charts[r].view_width>0&&t.send(t.charts[r])}))}},{key:"send",value:function(t){"subscribe_quote"===t.aid?null!==this.subscribe_quote&&JSON.stringify(t.ins_list)===JSON.stringify(this.subscribe_quote.ins_list)||(this.subscribe_quote=t,_get(_getPrototypeOf(e.prototype),"send",this).call(this,t)):"set_chart"===t.aid&&(0===t.view_width?this.charts[t.chart_id]&&delete this.charts[t.chart_id]:this.charts[t.chart_id]=t,_get(_getPrototypeOf(e.prototype),"send",this).call(this,t))}}]),e}(TqWebsocket),QUOTE=function(){function t(){_classCallCheck(this,t),this.instrument_id="",this.datetime="",this._last_price="-",this.ask_price1="-",this.ask_volume1="-",this.bid_price1="-",this.bid_volume1="-",this.highest="-",this.lowest="-",this.open="-",this.close="-",this.average="-",this.volume="-",this.amount="-",this.open_interest="-",this.lower_limit="-",this.upper_limit="-",this.settlement="-",this.change="-",this.change_percent="-",this.strike_price=NaN,this.pre_open_interest="-",this.pre_close="-",this.pre_volume="-",this._pre_settlement="-",this.margin="-",this.commission="-"}return _createClass(t,[{key:"setChange",value:function(){Number.isFinite(this._last_price)&&Number.isFinite(this._pre_settlement)&&0!==this._pre_settlement&&(this.change=this._last_price-this._pre_settlement,this.change_percent=this.change/this._pre_settlement*100)}},{key:"last_price",set:function(t){this._last_price=t,this.setChange()},get:function(){return this._last_price}},{key:"pre_settlement",set:function(t){this._pre_settlement=t,this.setChange()},get:function(){return this._pre_settlement}}]),t}(),DataManager=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,e),t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)),t._epoch=0,t._data=r,t._diffs=[],t}return _inherits(e,t),_createClass(e,[{key:"mergeData",value:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Array.isArray(t)?t:[t];r&&(this._epoch+=1,this._diffs=n);var i=!0,o=!1,a=void 0;try{for(var _,c=n[Symbol.iterator]();!(i=(_=c.next()).done);i=!0){var u=_.value;null===u||IsEmptyObject(u)||e.MergeObject(this._data,u,this._epoch,s)}}catch(d){o=!0,a=d}finally{try{i||null==c["return"]||c["return"]()}finally{if(o)throw a}}r&&this._data._epoch===this._epoch&&this.emit("data",null)}},{key:"isChanging",value:function(t){if(Array.isArray(t)){for(var e=this._data,r=0;r<t.length;r++){if(e=e[t[r]],e._epoch&&e._epoch===this._epoch)return!0;if(void 0===e)return!1}return!1}return!(!t||!t._epoch)&&t._epoch===this._epoch}},{key:"setDefault",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._data;return e.SetDefault(s,t,r)}},{key:"getByPath",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._data;return e.GetByPath(r,t)}}]),e}(eventemitter3);DataManager.SetDefault=function(t,e,r){for(var s=t,n=0;n<e.length;n++){if("string"!==typeof e[n]&&"number"!==typeof e[n]){console.error("SetDefault, pathArray 中的元素必須是 string or number, but pathArray = ",e);break}var i=e[n];if(i in s||(s[i]=n===e.length-1?r:{}),n===e.length-1)return s[i];s=s[i]}return s},DataManager.GetByPath=function(t,e){for(var r=t,s=0;s<e.length;s++)if(r=r[e[s]],void 0===r||null===r)return r;return r},DataManager.MergeObject=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];for(var n in e){var i=e[n],o=_typeof(i);if(["string","boolean","number"].includes(o))t[n]="NaN"===i?NaN:i;else if(null===i&&s)delete t[n];else if(Array.isArray(i))t[n]=i,i._epoch||Object.defineProperty(i,"_epoch",{configurable:!1,enumerable:!1,writable:!0}),i._epoch=r;else if("object"===o)if(t[n]=t[n]||("data"===n?[]:{}),"quotes"===n)for(var a in i){var _=i[a];null!==_?(t[n][a]||(t[n][a]=new QUOTE),DataManager.MergeObject(t[n][a],_,r,s)):s&&a&&delete t[n][a]}else DataManager.MergeObject(t[n],i,r,s)}t._epoch||Object.defineProperty(t,"_epoch",{configurable:!1,enumerable:!1,writable:!0}),t._epoch=r};var TQSDK=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=r.symbolsServerUrl,n=void 0===s?"https://openmd.shinnytech.com/t/md/symbols/latest.json":s,i=r.wsQuoteUrl,o=void 0===i?"wss://openmd.shinnytech.com/t/md/front/mobile":i,a=r.wsTradeUrl,_=void 0===a?"wss://openmd.shinnytech.com/trade/shinny":a,c=r.clientSystemInfo,u=void 0===c?"":c,d=r.clientAppId,l=void 0===d?"":d;_classCallCheck(this,e),t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)),t._symbol_services_url=n,t._ws_quote_url=o,t._ws_trade_url=_,t.clientSystemInfo=u,t.clientAppIds=l,t._prefix="TQJS_";var h=_assertThisInitialized(t);return t.dm=new DataManager({klines:{},quotes:{},charts:{},ticks:{}}),t.dm.on("data",(function(){h.emit("rtn_data",null)})),t.brokers=null,t.trade_accounts={},t.isReady=!1,t.quotesWs=new TqQuoteWebsocket(o,t.dm),t.quotesInfo={},t.defaultTradeWs=new TqTradeWebsocket(_,t.dm),t.defaultTradeWs.on("rtn_brokers",(function(t){h.brokers=t,h.emit("rtn_brokers",t)})),axios__WEBPACK_IMPORTED_MODULE_30___default.a.get(t._symbol_services_url,{headers:{Accept:"application/json; charset=utf-8"}}).then((function(t){h.quotesInfo=t.data,h.isReady=!0,h.emit("ready"),h.emit("rtn_data",null)}))["catch"]((function(t){return h.emit("error",t),console.error("Error: "+t.message),t})),t}return _inherits(e,t),_createClass(e,[{key:"addAccount",value:function(t,e,r){if(t&&e&&r){if(!this.trade_accounts[e]){var s=null===this.defaultTradeWs.req_login?this.defaultTradeWs:new TqTradeWebsocket(this._ws_trade_url,this.dm),n=this;s.on("notify",(function(r){n.emit("notify",Object.assign(r,{bid:t,user_id:e}))})),this.trade_accounts[e]={bid:t,userId:e,password:r,ws:s}}return this.trade_accounts[e]}return null}},{key:"removeAccount",value:function(t,e){t&&e&&this.trade_accounts[e]&&(this.trade_accounts[e].ws.close(),delete this.trade_accounts[e],delete this.dm._data.trade[e])}},{key:"updateData",value:function(t){this.dm.mergeData(t,!0,!1)}},{key:"getByPath",value:function(t){return this.dm.getByPath(t)}},{key:"getQuotesByInput",value:function(t){if("string"!==typeof t&&!t.input)return[];var e={input:"string"===typeof t?t.toLowerCase():t.input.toLowerCase(),instrument_id:!t.instrument_id||t.instrument_id,pinyin:!t.pinyin||t.pinyin,include_expired:!!t.include_expired&&t.include_expired,FUTURE:!t.future||!!t.future,FUTURE_INDEX:!!t.future_index&&!!t.future_index,FUTURE_CONT:!!t.future_cont&&!!t.future_cont,OPTION:!!t.option&&!!t.option,COMBINE:!!t.combine&&!!t.combine},r=function(t,e,r){return!(!t[e["class"]]||!t.include_expired&&(t.include_expired||e.expired))&&("instrument_id"===r?e.product_id.toLowerCase()===t.input||t.input.length>2&&e.instrument_id.toLowerCase().indexOf(t.input)>-1:"pinyin"===r&&e.py.split(",").indexOf(t.input)>-1)},s=[];if(e.instrument_id)for(var n in this.quotesInfo)r(e,this.quotesInfo[n],"instrument_id")&&s.push(n);if(e.pinyin)for(var i in this.quotesInfo)r(e,this.quotesInfo[i],"pinyin")&&s.push(i);return s}},{key:"getQuote",value:function(t){if(""===t)return{};var e=this.dm.setDefault(["quotes",t],new QUOTE);if(!e["class"]&&this.quotesInfo[t]){var r=e.last_price?e.last_price:this.quotesInfo[t].last_price;Object.assign(e,this.quotesInfo[t],{last_price:r})}return e}},{key:"setChart",value:function(t){var e={};t.trading_day_start||t.trading_day_count?(e.trading_day_start=t.trading_day_start?t.trading_day_start:0,e.trading_day_count=t.trading_day_count?t.trading_day_count:864e11):(e.view_width=t.view_width?t.view_width:500,t.left_kline_id?e.left_kline_id=t.left_kline_id:t.focus_datetime&&(e.focus_datetime=t.focus_datetime,e.focus_position=t.focus_position?t.focus_position:0)),this.quotesWs.send(Object.assign({aid:"set_chart",chart_id:t.chart_id?t.chart_id:this._prefix+"kline_chart",ins_list:t.ins_list?t.ins_list.join(","):t.symbol,duration:t.duration},e))}},{key:"getUser",value:function(t){var e="string"===typeof t?t:t.user_id;return e?this.dm._data.trade[e]:null}},{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.name,r=void 0===e?"users":e,s=t.user_id,n=void 0===s?"":s,i=t.currency,o=void 0===i?"CNY":i,a=t.symbol,_=void 0===a?"":a,c=t.order_id,u=void 0===c?"":c,d=t.trade_id,l=void 0===d?"":d,h=t.trading_day,f=void 0===h?"":h,p=t.chart_id,m=void 0===p?"":p,b=t.input,g=void 0===b?"":b,y=t.duration,v=void 0===y?0:y;if("users"===r)return Object.keys(this.trade_accounts);if(n){var w=this.get_user(n);if("user"===r)return w;if(["session","accounts","positions","orders","trades","his_settlements"].indexOf(r)>-1)return w&&w[r]?w[r]:null;if(w&&w[r+"s"]){var E="account"===r?o:"position"===r?_:"order"===r?u:"trade"===r?l:"his_settlement"===r?f:"";return w[r+"s"][E]}return null}return"quotes"===r?g?this.get_quotes_by_input(g):[]:"quote"===r?this.getQuote(_):"klines"===r?this.getKlines(_,v):"ticks"===r?this.getTicks(_):"charts"===r?this.dm.getByPath(["charts"]):"chart"===r?this.dm.getByPath(["charts",m]):void 0}},{key:"getKlines",value:function(t,e){if(""===t)return null;var r=this.dm.getByPath(["klines",t,e]);return r&&r.data&&-1!==r.last_id||(this.dm.mergeData({klines:_defineProperty({},t,_defineProperty({},e,{last_id:-1,data:{}}))},!1,!1),r=this.dm.getByPath(["klines",t,e])),r}},{key:"getTicks",value:function(t){if(""===t)return null;var e=this.dm.getByPath(["ticks",t]);return e&&e.data||this.dm.mergeData({ticks:_defineProperty({},t,{last_id:-1,data:{}})},!1,!1),this.dm.getByPath(["ticks",t])}},{key:"isLogined",value:function(t){var e=this.get({name:"session",user_id:t.user_id});return!(!e||!e.trading_day)}},{key:"isChanging",value:function(t,e){return t&&t._epoch?t._epoch===this.dm._epoch:"string"===typeof t&&this.dm.isChanging(t,e)}},{key:"insertOrder",value:function(t){if(!this.is_logined(t))return null;var e=this._prefix+RandomStr(8),r={user_id:t.user_id,orderId:e,exchange_id:t.exchange_id,instrument_id:t.ins_id,direction:t.direction,offset:t.offset,price_type:t.price_type?t.price_type:"LIMIT",limit_price:Number(t.limit_price),volume_condition:"ANY",time_condition:"ANY"===t.price_type?"IOC":"GFD"},s=Object.assign({aid:"insert_order",volume:t.volume},r);this.trade_accounts[t.user_id].ws.send(s);var n=Object.assign({volume_orign:t.volume,status:"ALIVE",volume_left:t.volume},r);return this.dm.mergeData({trade:_defineProperty({},t.user_id,{orders:_defineProperty({},e,n)})},!1,!1),this.get({name:"order",user_id:t.user_id,orderId:e})}},{key:"autoInsertOrder",value:function(t){if(!this.is_logined(t))return null;var e={user_id:t.user_id,price_type:t.price_type?t.price_type:"LIMIT",volume_condition:"ANY",time_condition:"ANY"===t.price_type?"IOC":"GFD",exchange_id:t.exchange_id,instrument_id:t.ins_id,direction:t.direction,limit_price:Number(t.limit_price)};if("SHFE"===t.exchange_id&&"CLOSE"===t.offset){var r=this.dm.getPosition(t.symbol,t.user_id),s=0;"BUY"===t.direction&&r.volume_short_today>0?s=Math.min(r.volume_short_today,t.volume):"SELL"===t.direction&&r.volume_long_today>0&&(s=Math.min(r.volume_long_today,t.volume)),s>0&&this.insert_order(Object.assign({offset:"CLOSETODAY",volume:s},e)),t.volume-s>0&&this.insert_order(Object.assign({offset:"CLOSE",volume:t.volume-s},e))}else this.insert_order(Object.assign({offset:t.offset,volume:t.volume},e))}},{key:"cancelOrder",value:function(t){this.trade_accounts[t.user_id].ws.send({aid:"cancel_order",user_id:t.user_id,order_id:t.order_id?t.order_id:t})}},{key:"login",value:function(t){this.trade_accounts[t.user_id].ws.send({aid:"req_login",bid:t.bid,user_name:t.user_id,password:t.password,client_system_info:this.clientSystemInfo,client_app_id:this.clientAppId})}},{key:"confirmSettlement",value:function(t){this.trade_accounts[t.user_id].ws.send({aid:"confirm_settlement"})}},{key:"transfer",value:function(t){this.trade_accounts[t.user_id].ws.send({aid:"req_transfer",bank_id:t.bank_id,bank_password:t.bank_password,future_account:t.future_account,future_password:t.future_password,currency:"CNY",amount:t.amount})}},{key:"hisSettlement",value:function(t){if(!e.store)return null;var r=this.dm.getByPath(["trade",t.user_id,"his_settlements",t.trading_day]);if(void 0===r){var s=this;r=e.store.getContent(t.user_id,t.trading_day).then((function(e){if(null===e)s.trade_accounts[t.user_id].ws.send({aid:"qry_settlement_info",trading_day:Number(t.trading_day)});else{var r=ParseSettlementContent(e);s.dm.mergeData({trade:_defineProperty({},t.user_id,{his_settlements:_defineProperty({},t.trading_day,r)})},!0,!1)}}))["catch"]((function(t){console.error(t)}))}}},{key:"subscribeQuote",value:function(t){this.quotesWs.send({aid:"subscribe_quote",ins_list:Array.isArray(t)?t.join(","):t})}}]),e}(eventemitter3);TQSDK.prototype.subscribe_quote=TQSDK.prototype.subscribeQuote,TQSDK.prototype.his_settlement=TQSDK.prototype.hisSettlement,TQSDK.prototype.confirm_settlement=TQSDK.prototype.confirmSettlement,TQSDK.prototype.add_account=TQSDK.prototype.addAccount,TQSDK.prototype.remove_account=TQSDK.prototype.removeAccount,TQSDK.prototype.update_data=TQSDK.prototype.updateData,TQSDK.prototype.get_by_path=TQSDK.prototype.getByPath,TQSDK.prototype.get_quotes_by_input=TQSDK.prototype.getQuotesByInput,TQSDK.prototype.get_quote=TQSDK.prototype.getQuote,TQSDK.prototype.set_chart=TQSDK.prototype.setChart,TQSDK.prototype.get_user=TQSDK.prototype.getUser,TQSDK.prototype.is_logined=TQSDK.prototype.isLogined,TQSDK.prototype.is_changed=TQSDK.prototype.isChanging,TQSDK.prototype.insert_order=TQSDK.prototype.insertOrder,TQSDK.prototype.auto_insert_order=TQSDK.prototype.autoInsertOrder,TQSDK.prototype.cancel_order=TQSDK.prototype.cancelOrder,TQSDK.TqWebsocket=TqWebsocket,TQSDK.DataManager=DataManager,TQSDK.version=version,__webpack_exports__["a"]=TQSDK},b7de:function(t,e,r){"use strict";var s=r("5096"),n=r.n(s);n.a},b9e2:function(t,e,r){"use strict";var s=r("a829"),n=r.n(s);n.a},cf05:function(t,e,r){t.exports=r.p+"img/logo.165e0f64.png"},d85d:function(t,e,r){},dcf3:function(t,e,r){},f451:function(t,e,r){"use strict";var s=r("5c44"),n=r.n(s);n.a},f6c5:function(t,e,r){}});